<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>探索kubectl - 巧用jsonpath提取有用数据 | Cylon's Collection</title><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NP3JNCPR" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><meta name=keywords content="jsonpath,kubectl"><meta name=description content="kubernetes集群工具 kubect 提供了一种强大的数据提取的模式，jsonpath，相对于 yaml 来说，jsonpath 拥有高度的自制提取功能，以及一些更便于提取字段的模式，使得过去 kubernetes 资源信息时更便捷，在本文中将解开 jsonpath 的神秘面纱。
什么是jsonpath JSONPath 是一种用于查询 JSON 数据结构中特定元素的查询语言。它类似于 XPath 用于 XML 数据的查询。JSONPath 允许您以一种简单而灵活的方式从 JSON 对象中提取数据，而不需要编写复杂的代码来解析 JSON 结构。
JSONPath 使用路径表达式来指定您要检索的 JSON 数据的位置。这些路径表达式类似于文件系统中的路径，但用于导航 JSON 结构。以下是一些常见的 JSONPath 表达式示例：
$：表示 JSON 根对象。 $.store：表示从根对象中获取名为 &ldquo;store&rdquo; 的属性。 $.store.book：表示从根对象中获取 &ldquo;store&rdquo; 属性中的 &ldquo;book&rdquo; 属性。 $.store.book[0]：表示获取 &ldquo;store&rdquo; 属性中的 &ldquo;book&rdquo; 属性的第一个元素。 $.store.book[?(@.price < 10)]：表示选择 &ldquo;store&rdquo; 属性中的 &ldquo;book&rdquo; 属性中价格小于 10 的所有元素。 Function Description Example Result text the plain text kind is {.kind} kind is List @ the current object {@} the same as input ."><meta name=author content="cylon"><link rel=canonical href=https://www.oomkill.com/2023/09/kubectl-jsonpath/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://www.oomkill.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.oomkill.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.oomkill.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.oomkill.com/favicon.ico><link rel=mask-icon href=https://www.oomkill.com/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://www.oomkill.com/2023/09/kubectl-jsonpath/><noscript><style>#theme-toggle,#top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link crossorigin=anonymous href=/assets/css/pe.min.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/pe.min.js></script><link rel=stylesheet href=https://cdn.staticfile.net/font-awesome/6.5.1/css/all.min.css><link rel=stylesheet href=https://cdn.staticfile.net/font-awesome/6.5.1/css/v4-shims.min.css><script id=MathJax-script async src=https://cdn.staticfile.net/mathjax/3.2.2/es5/tex-chtml.js></script><script>MathJax={tex:{displayMath:[["$$","$$"]],inlineMath:[["\\$","\\$"]]}}</script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><meta name=referrer content="no-referrer-when-downgrade"><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-NP3JNCPR")</script><meta property="og:title" content="探索kubectl - 巧用jsonpath提取有用数据"><meta property="og:description" content="kubernetes集群工具 kubect 提供了一种强大的数据提取的模式，jsonpath，相对于 yaml 来说，jsonpath 拥有高度的自制提取功能，以及一些更便于提取字段的模式，使得过去 kubernetes 资源信息时更便捷，在本文中将解开 jsonpath 的神秘面纱。
什么是jsonpath JSONPath 是一种用于查询 JSON 数据结构中特定元素的查询语言。它类似于 XPath 用于 XML 数据的查询。JSONPath 允许您以一种简单而灵活的方式从 JSON 对象中提取数据，而不需要编写复杂的代码来解析 JSON 结构。
JSONPath 使用路径表达式来指定您要检索的 JSON 数据的位置。这些路径表达式类似于文件系统中的路径，但用于导航 JSON 结构。以下是一些常见的 JSONPath 表达式示例：
$：表示 JSON 根对象。 $.store：表示从根对象中获取名为 &ldquo;store&rdquo; 的属性。 $.store.book：表示从根对象中获取 &ldquo;store&rdquo; 属性中的 &ldquo;book&rdquo; 属性。 $.store.book[0]：表示获取 &ldquo;store&rdquo; 属性中的 &ldquo;book&rdquo; 属性的第一个元素。 $.store.book[?(@.price < 10)]：表示选择 &ldquo;store&rdquo; 属性中的 &ldquo;book&rdquo; 属性中价格小于 10 的所有元素。 Function Description Example Result text the plain text kind is {.kind} kind is List @ the current object {@} the same as input ."><meta property="og:type" content="article"><meta property="og:url" content="https://www.oomkill.com/2023/09/kubectl-jsonpath/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-25T00:00:00+00:00"><meta property="article:modified_time" content="2023-09-25T23:10:36+08:00"><meta property="og:site_name" content="Cylon's Collection"><meta name=twitter:card content="summary"><meta name=twitter:title content="探索kubectl - 巧用jsonpath提取有用数据"><meta name=twitter:description content="kubernetes集群工具 kubect 提供了一种强大的数据提取的模式，jsonpath，相对于 yaml 来说，jsonpath 拥有高度的自制提取功能，以及一些更便于提取字段的模式，使得过去 kubernetes 资源信息时更便捷，在本文中将解开 jsonpath 的神秘面纱。
什么是jsonpath JSONPath 是一种用于查询 JSON 数据结构中特定元素的查询语言。它类似于 XPath 用于 XML 数据的查询。JSONPath 允许您以一种简单而灵活的方式从 JSON 对象中提取数据，而不需要编写复杂的代码来解析 JSON 结构。
JSONPath 使用路径表达式来指定您要检索的 JSON 数据的位置。这些路径表达式类似于文件系统中的路径，但用于导航 JSON 结构。以下是一些常见的 JSONPath 表达式示例：
$：表示 JSON 根对象。 $.store：表示从根对象中获取名为 &ldquo;store&rdquo; 的属性。 $.store.book：表示从根对象中获取 &ldquo;store&rdquo; 属性中的 &ldquo;book&rdquo; 属性。 $.store.book[0]：表示获取 &ldquo;store&rdquo; 属性中的 &ldquo;book&rdquo; 属性的第一个元素。 $.store.book[?(@.price < 10)]：表示选择 &ldquo;store&rdquo; 属性中的 &ldquo;book&rdquo; 属性中价格小于 10 的所有元素。 Function Description Example Result text the plain text kind is {.kind} kind is List @ the current object {@} the same as input ."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.oomkill.com/posts/"},{"@type":"ListItem","position":2,"name":"探索kubectl - 巧用jsonpath提取有用数据","item":"https://www.oomkill.com/2023/09/kubectl-jsonpath/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"探索kubectl - 巧用jsonpath提取有用数据","name":"探索kubectl - 巧用jsonpath提取有用数据","description":"kubernetes集群工具 kubect 提供了一种强大的数据提取的模式，jsonpath，相对于 yaml 来说，jsonpath 拥有高度的自制提取功能，以及一些更便于提取字段的模式，使得过去 kubernetes 资源信息时更便捷，在本文中将解开 jsonpath 的神秘面纱。\n什么是jsonpath JSONPath 是一种用于查询 JSON 数据结构中特定元素的查询语言。它类似于 XPath 用于 XML 数据的查询。JSONPath 允许您以一种简单而灵活的方式从 JSON 对象中提取数据，而不需要编写复杂的代码来解析 JSON 结构。\nJSONPath 使用路径表达式来指定您要检索的 JSON 数据的位置。这些路径表达式类似于文件系统中的路径，但用于导航 JSON 结构。以下是一些常见的 JSONPath 表达式示例：\n$：表示 JSON 根对象。 $.store：表示从根对象中获取名为 \u0026ldquo;store\u0026rdquo; 的属性。 $.store.book：表示从根对象中获取 \u0026ldquo;store\u0026rdquo; 属性中的 \u0026ldquo;book\u0026rdquo; 属性。 $.store.book[0]：表示获取 \u0026ldquo;store\u0026rdquo; 属性中的 \u0026ldquo;book\u0026rdquo; 属性的第一个元素。 $.store.book[?(@.price \u0026lt; 10)]：表示选择 \u0026ldquo;store\u0026rdquo; 属性中的 \u0026ldquo;book\u0026rdquo; 属性中价格小于 10 的所有元素。 Function Description Example Result text the plain text kind is {.kind} kind is List @ the current object {@} the same as input .","keywords":["jsonpath","kubectl"],"articleBody":"kubernetes集群工具 kubect 提供了一种强大的数据提取的模式，jsonpath，相对于 yaml 来说，jsonpath 拥有高度的自制提取功能，以及一些更便于提取字段的模式，使得过去 kubernetes 资源信息时更便捷，在本文中将解开 jsonpath 的神秘面纱。\n什么是jsonpath JSONPath 是一种用于查询 JSON 数据结构中特定元素的查询语言。它类似于 XPath 用于 XML 数据的查询。JSONPath 允许您以一种简单而灵活的方式从 JSON 对象中提取数据，而不需要编写复杂的代码来解析 JSON 结构。\nJSONPath 使用路径表达式来指定您要检索的 JSON 数据的位置。这些路径表达式类似于文件系统中的路径，但用于导航 JSON 结构。以下是一些常见的 JSONPath 表达式示例：\n$：表示 JSON 根对象。 $.store：表示从根对象中获取名为 “store” 的属性。 $.store.book：表示从根对象中获取 “store” 属性中的 “book” 属性。 $.store.book[0]：表示获取 “store” 属性中的 “book” 属性的第一个元素。 $.store.book[?(@.price \u003c 10)]：表示选择 “store” 属性中的 “book” 属性中价格小于 10 的所有元素。 Function Description Example Result text the plain text kind is {.kind} kind is List @ the current object {@} the same as input . or [] child operator {.kind} or {[‘kind’]} List .. recursive descent {..name} 127.0.0.1 127.0.0.2 myself e2e * wildcard. Get all objects {.items[*].metadata.name} [127.0.0.1 127.0.0.2] [start:end :step] subscript operator {.users[0].name} myself [,] union operator {.items[*][‘metadata.name’, ‘status.capacity’]} 127.0.0.1 127.0.0.2 map[cpu:4] map[cpu:8] ?() filter {.users[?(@.name==“e2e”)].user.password} secret range, end iterate list {range .items[*]}[{.metadata.name}, {.status.capacity}] {end} [127.0.0.1, map[cpu:4]] [127.0.0.2, map[cpu:8]] “ quote interpreted string {range .items[*]}{.metadata.name}{’\\t’}{end} 127.0.0.1 127.0.0.2 JSONPath 支持各种操作符和函数，以便更复杂地筛选和操作 JSON 数据。它在 JSON 数据的导航和过滤方面非常强大，通常用于从 JSON 数据中提取所需的信息。\nJSONPath 在各种编程语言和工具中都有实现，包括 JavaScript、Python、Java 等，因此您可以根据需要选择适合您项目的工具来使用 JSONPath 查询 JSON 数据。\nkubectl中对jsonpath的支持 例如，通常在生产环境中处理 Kubernetes 问题时，您将需要查看数百个节点和数千个 Pod 的信息，例如 Deployment, Pod, Replicat, Service, Secret 等资源信息，但要获取这些类型的资源，通常会使用 kubectl 命令，然而在50%以上的高级场景下，是过滤信息并进行整理。在这种场景下，使用 kubectl + shell 命令进行整理的却没有 jsonpath 来的实在。假设在一个大规模集群中，例如 10 万个 Node 节点，这时如果你想获得一些节点信息，或者 Pod 信息，再或者某些需要循环的条件，这时候多次的请求对你在统计数据上造成的时间成本及频繁请求API都会造成压力，这个时候 jsonpath 的功能就很好的解决了这个问题，通过一次请求，快速循环可以在很短时间内得出结果，并减少了大量请求 kube-apiserver 的压力。\nkubectl jsonpath 示例 仅获取某个资源的名称 bash 1 2 # 语法 kubectl -n get deploy/ -o jsonpath='{.metadata.name}' 获取一个 deployment的 信息\nbash 1 2 $ kubectl get deploy/traefik -o jsonpath='{.metadata.name}' traefik 通常使用 json path 不会获取一个资源的信息，而是获取所有资源的信息，例如获取所有 Pod 的 name\nbash 1 2 $ kubectl get pod -A -o jsonpath=\"{.items[*]['metadata.name']}\" echo-hello-world-task-run-1-pod-ksdtm echo-hello-world-task-run-pod-4sx9n traefik-679bf6459c-sz9jv calico-kube-controllers-577f77cb5c-kwhph calico-node-59d5x calico-node-82zgm coredns-6b9bb479b9-wnc8n minio spin-clouddriver-88df48858-dfzkg spin-deck-5dc8f847b8-m4tbk spin-echo-69868fd866-nxn8g spin-front50-54fb4b6d67-jfkds spin-gate-7b6f4d4566-gdjkd spin-orca-7765fb5c96-9gmvr spin-redis-8485df6b88-bgrgm spin-rosco-6d77f8cb-bf2nj tekton-pipelines-controller-5cdb46974f-8rjbx tekton-pipelines-webhook-6479d769ff-756gq Tips：jsonpath 的输出是以字符串方式输出，不会携带换行之类的\n@ 的用法 @ 表示当前对象，例如 kubectl get pods 这获取的是一个 list 列表，那么 @ 就代表这个 list，例如\nbash 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 $ kubectl get pods -o=jsonpath='{@}'|jq { \"apiVersion\": \"v1\", \"items\": [ { \"apiVersion\": \"v1\", \"kind\": \"Pod\", \"metadata\": { \"annotations\": { \"cni.projectcalico.org/containerID\": \"aedb0d3f11b2572d82a7ccb456cec393f88de2c8befa4d19e69a577bb8c0e20f\", \"cni.projectcalico.org/podIP\": \"\", \"cni.projectcalico.org/podIPs\": \"\", \"kubectl.kubernetes.io/last-applied-configuration\": \"{\\\"apiVersion\\\":\\\"tekton.dev/v1beta1\\\",\\\"kind\\\":\\\"Task\\\",\\\"metadata\\\":{\\\"annotations\\\":{},\\\"name\\\":\\\"echo-hello-world\\\",\\\"namespace\\\":\\\"default\\\"},\\\"spec\\\":{\\\"steps\\\":[{\\\"args\\\":[\\\"Hello World\\\"],\\\"command\\\":[\\\"echo\\\"],\\\"image\\\":\\\"busybox\\\",\\\"name\\\":\\\"echo\\\"}]}}\\n\", \"pipeline.tekton.dev/release\": \"v0.19.0\", \"tekton.dev/ready\": \"READY\" }, \"creationTimestamp\": \"2023-06-26T15:05:54Z\", \"labels\": { \"app.kubernetes.io/managed-by\": \"tekton-pipelines\", \"tekton.dev/task\": \"echo-hello-world\", \"tekton.dev/taskRun\": \"echo-hello-world-task-run-1\" }, \"managedFields\": [ { \"apiVersion\": \"v1\", \"fieldsType\": \"FieldsV1\", \"fieldsV1\": { \"f:metadata\": { \"f:annotations\": { \"f:cni.projectcalico.org/containerID\": {}, \"f:cni.projectcalico.org/podIP\": {}, \"f:cni.projectcalico.org/podIPs\": {} } } }, \"manager\": \"calico\", \"operation\": \"Update\", \"time\": \"2023-06-26T15:05:55Z\" }, { \"apiVersion\": \"v1\", \"fieldsType\": \"FieldsV1\", \"fieldsV1\": { \"f:metadata\": { \"f:annotations\": { \".\": {}, \"f:kubectl.kubernetes.io/last-applied-configuration\": {}, \"f:pipeline.tekton.dev/release\": {}, \"f:tekton.dev/ready\": {} ... \"nodeName\": \"node01\", \"preemptionPolicy\": \"PreemptLowerPriority\", \"priority\": 0, \"restartPolicy\": \"Never\", \"schedulerName\": \"default-scheduler\", \"securityContext\": {}, \"serviceAccount\": \"default\", \"serviceAccountName\": \"default\", \"terminationGracePeriodSeconds\": 30, \"tolerations\": [ { \"effect\": \"NoExecute\", \"key\": \"node.kubernetes.io/not-ready\", \"operator\": \"Exists\", \"tolerationSeconds\": 300 }, { \"effect\": \"NoExecute\", \"key\": \"node.kubernetes.io/unreachable\", \"operator\": \"Exists\", \"tolerationSeconds\": 300 } . 和 [] 的用法 . 和 [] 是子操作符，用于获取到列表的元素，返回值也是 list，例如获取 Pod 列表中第一个 Pod，下面是一个 [] 的使用示例，可以获取某个元素\nbash 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 kubectl get pods -o=jsonpath='{.items[0]}' | jq { \"apiVersion\": \"v1\", \"kind\": \"Pod\", \"metadata\": { \"annotations\": { \"cni.projectcalico.org/containerID\": \"aedb0d3f11b2572d82a7ccb456cec393f88de2c8befa4d19e69a577bb8c0e20f\", ... }, \"status\": { \"conditions\": [ { \"lastProbeTime\": null, ... \"hostIP\": \"10.0.0.5\", \"initContainerStatuses\": [ { \"containerID\": \"docker://8129d155a9e9f204a22947ae3268513a1bf4d1ce98012120ab30cfd0eca04564\", \"image\": \"sha256:5d54c55f19bc6fdda7629a4f2015255ec1bed2750a81909817bede45a4d360b5\", \"imageID\": \"docker-pullable://gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/entrypoint@sha256:67fceb87f3f76baefcfdb35fd04d0ebfc8d91117dccb7f3194056d6727bac636\", \"lastState\": {}, \"name\": \"place-tools\", \"ready\": true, \"restartCount\": 0, \"state\": { \"terminated\": { \"containerID\": \"docker://8129d155a9e9f204a22947ae3268513a1bf4d1ce98012120ab30cfd0eca04564\", \"exitCode\": 0, \"finishedAt\": \"2023-06-26T15:05:55Z\", \"reason\": \"Completed\", \"startedAt\": \"2023-06-26T15:05:55Z\" } } } ], \"phase\": \"Succeeded\", \"podIP\": \"10.244.196.131\", \"podIPs\": [ { \"ip\": \"10.244.196.131\" } ], \"qosClass\": \"BestEffort\", \"startTime\": \"2023-06-26T15:05:54Z\" } } . 是 [] 的子操作符，可以获取某一个元素下的某个值，与 json 中语法相同，例如获取 Pod 列表中==第一个 Pod 的名称==\nbash 1 2 $ kubectl get pods -o=jsonpath='{.items[0].metadata.name}' echo-hello-world-task-run-1-pod-ksdtm 下标操作符 : 下标操作符 “:” 可以视为一个切片，获取列表中某一些元素，语法为 [start:end :step]\n例如获取前三个元素的名称\nbash 1 kubectl get pods -o=jsonpath='{.items[0:2].metadata.name}' 获取最后两个元素\nbash' $ kubectl get pods -n spinnaker -o jsonpath='{range .items[*]}{.metadata.name}{\"\\n\"}{end}'\rspin-clouddriver-88df48858-dfzkg\rspin-deck-5dc8f847b8-m4tbk\rspin-echo-69868fd866-nxn8g\rspin-front50-54fb4b6d67-jfkds\rspin-gate-7b6f4d4566-gdjkd\rspin-orca-7765fb5c96-9gmvr\rspin-redis-8485df6b88-bgrgm\rspin-rosco-6d77f8cb-bf2nj\r$ kubectl get pods -n spinnaker -o jsonpath='{range .items[-2:]}{.metadata.name}{\"\\n\"}{end}'\rspin-redis-8485df6b88-bgrgm\rspin-rosco-6d77f8cb-bf2nj 过滤表达式 如果设置了 limit 参数则打印其名称\nbash 1 kubectl get pods -n spinnaker -o jsonpath='{.items[?(@.spec.containers[*].resources.limits.memory != \"\")].metadata.name}' 价格大于 10 的 元素的 name\nbash 1 \"$.store.book[?(@.price \u003e 10)].name\" json path 支持下列过滤操作符参考 [2]\nOperator Description == 等于。字符串值必须用单引号（而不是双引号）括起来：[?(@.color=='red')]。注意：数字与字符串比较的工作方式因播放引擎而异。在 TestEngine 中，1 不等于 “1”。在 ReadyAPI 1.9 及更早版本中，1 等于 “1”。 != 不等于，字符串值必须用单引号括起来：[?(@.color!='red')]。 \u003e 大于 \u003e= 大于或等于 \u003c 小于 \u003c= 小于或等于 =~ 匹配 JavaScript 正则表达式。例如，[?(@.description =~ /cat.*/i)] 匹配描述以 cat 开头的项目（不区分大小写）。注意：如果使用 ReadyAPI 1.1 作为播放引擎，则不支持。 ! 用于否定过滤器：[?(!@.isbn)] 匹配不具有 isbn 属性的项目。注意：如果使用 ReadyAPI 1.1 作为播放引擎，则不支持。 \u0026\u0026 逻辑与 AND，用于组合多个过滤表达式: [?(@.category=='fiction' \u0026\u0026 @.price \u003c 10)] || 逻辑或 OR Logical OR, 用于组合多个过滤表达式： `[?(@.category==‘fiction’ in 检查左侧值是否存在于右侧列表中。类似于 SQL IN 运算符。字符串比较区分大小写。 [?(@.size in ['M', 'L'])] [?('S' in @.sizes)] 注意：仅由 TestEngine 播放引擎支持。 nin 与 in 相反。检查左侧值是否不存在于右侧列表中。字符串比较区分大小写。 [?(@.size nin ['M', 'L'])] [?('S' nin @.sizes)] 注意：仅由 TestEngine 播放引擎支持。 contains 检查字符串是否包含指定的子字符串（区分大小写），或者数组是否包含指定的元素。\n[?(@.name contains 'Alex')] [?(@.numbers contains 7)] [?('ABCDEF' contains @.character)] 注意：仅由 TestEngine 播放引擎支持。 size 检查数组或字符串是否具有指定的长度。 [?(@.name size 4)] 注意：仅由 TestEngine 播放引擎支持。 empty true 匹配空数组或字符串。 [?(@.name empty true)] 注意：仅由 TestEngine 播放引擎支持。 empty false 匹配非空数组或字符串。 [?(@.name empty false)] 注意：仅由 TestEngine 播放引擎支持。 正则表达式 kubectl jsonpath 不支持正则表达式，如果需要使用正则表达式可以使用 jq 替换\n例如获取 spin 开头的 Pod 是否配置了 resources\nbash 1 kubectl get pods -n spinnaker -o json | jq -r '.items[] | select(.metadata.name | test(\"spin-\")).spec.resources' example\nbash 1 2 3 4 5 6 7 8 9 $ kubectl get pods -n spinnaker -o json | jq -r '.items[] | select(.metadata.name | test(\"spin-\")).spec.resources' null null null null null null null null kubectl example 示例 获取 Pod 为 web 的 Pod name bash 1 kubectl get pods -o jsonpath = '{.items[?(@.metadata.labels.name==\"web\")].metadata.name}' 过滤一个元素 过滤 Node 地址模式\nbash 1 kubectl get nodes -o jsonpath='{.items[*].status.addresses[?(@.type==\"InternalIP\")]}' 过滤元素并只打印想要的属性\nbash 1 kubectl get nodes -o jsonpath='{.items[*].status.addresses[?(@.type==\"InternalIP\")].address}' 从数组中获取每个元素的单个字段 bash 1 kubectl get pods -o jsonpath={$.items[*].status.hostIP} 换行 jsonpath 在获取元素后，是一个单行字符串，如果需要换行操作可以使用下面示例\nbash 1 2 3 4 $ kubectl get pods -o jsonpath='{range .items[*]}{.status.hostIP}{\"\\n\"}{end}' 10.0.0.5 10.0.0.5 10.0.0.5 循环并获得多个元素 如果想获取两个元素，可以使用下面示例\nbash 1 2 3 4 $ kubectl get pods -o jsonpath={range .items[*]}{.status.hostIP}{\"\\t\"}{.status.phase}{\"\\n\"}{end} 10.154.196.228\tRunning 10.154.202.136\tRunning 10.154.201.54\tRunning 递归 如果想获取一个元素下所有相同名称的字段，可以使用下面示例\n递归获取所有 name 字段\nbash 1 2 3 $ kubectl get pod -A -o jsonpath='{..name}' step-echo place-tools echo-hello-world-task-run-1-pod-ksdtm echo-hello-world-task-run-1 tekton-internal-workspace tekton-internal-home tekton-internal-results tekton-internal-tools tekton-internal-downward tekton-creds-init-home-tlvg8 default-token-6762j step-echo HOME tekton-internal-tools tekton-internal-downward tekton-creds-init-home-tlvg8 tekton-internal-workspace tekton-i.. ... 巧用递归简化语句，如果一个元素 (元素名称) 是独有的，那么可以使用递归直接获取到这个元素的值，例如，过去所有 containers\nbash 1 2 3 4 5 6 $ kubectl get pods -A -o=jsonpath='{range .items[*]}{\"pod: \"}{.metadata.name} {\"\\n\"}{range ..containers[*]}{\"\\tcontainer: \"}{.name}{\"\\n\\timage: \"}{.image}{\"\\n\"}{end}{end}' pod: echo-hello-world-task-run-1-pod-ksdtm container: step-echo image: busybox pod: echo-hello-world-task-run-pod-4sx9n container: step-echo 获取每个 Pod limit 值 bash 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 kubectl get pod -A -o jsonpath='{range $.items[*]}{\"Pod: \"}{.metadata.name}{\"\\n\"} {\" limit_mem: \"}{.spec.containers[*].resources.limits.memory}{\"\\n\"}{end}' Pod: echo-hello-world-task-run-1-pod-ksdtm limit_mem: Pod: echo-hello-world-task-run-pod-4sx9n limit_mem: Pod: traefik-679bf6459c-sz9jv limit_mem: Pod: calico-kube-controllers-577f77cb5c-kwhph limit_mem: Pod: calico-node-59d5x limit_mem: Pod: calico-node-82zgm limit_mem: Pod: coredns-6b9bb479b9-wnc8n limit_mem: 170Mi Pod: minio limit_mem: Pod: spin-clouddriver-88df48858-dfzkg limit_mem: Pod: spin-deck-7fbf94d8bc-k7zrk limit_mem: 200Mi Pod: spin-echo-69868fd866-nxn8g limit_mem: Pod: spin-front50-54fb4b6d67-jfkds limit_mem: Pod: spin-gate-6d7dbf74b9-4l89r limit_mem: 600Mi Pod: spin-orca-7765fb5c96-9gmvr limit_mem: Pod: spin-redis-8485df6b88-bgrgm limit_mem: Pod: spin-rosco-6d77f8cb-bf2nj limit_mem: Pod: tekton-pipelines-controller-5cdb46974f-8rjbx limit_mem: Pod: tekton-pipelines-webhook-6479d769ff-756gq limit_mem: 500Mi 获取容器的 IP 获取单独一个 Pod\nbash 1 kubectl get pod nginx-67d5fc57d8-jkfjp -n quota-example -o jsonpath='{.status.podIPs[].ip}{\"\\n\"}' 循环获取\nbash 1 2 3 4 kubectl get pod -o jsonpath='{range $.items[*]}{.status.podIPs[].ip}{\"\\n\"}{end}' 10.244.196.131 10.244.196.129 10.244.196.186 获取所有的 Container ID 和 Pod IP bash 1 kubectl get pods --all-namespaces -o=jsonpath='{range .items[*]}[{.status.containerStatuses[0].containerID}, {.status.podIP}]{\"\\n\"}{end}' 获取所有的容器名称和镜像名称 bash 1 kubectl get pods -n kube-system -o=jsonpath='{range .items[*]}[{.metadata.name},{.status.containerStatuses[0].image}]{\"\\n\"}{end}' 获取所有状态条件中的类型 bash 1 kubectl get pod cm-test-pod -o jsonpath='{.status.conditions[*].type}' 获取 Pod 的 apiversion bash 1 kubectl get pod cm-test-pod -o jsonpath='{.apiVersion}' 从第一个状态条件开始到最后一个结束，每隔2个获取一次 bash 1 kubectl get pod cm-test-pod -o jsonpath='{.status.conditions[0:3:2].type}' Reference [1] jsonpath\n[2] JSONPath Syntax\n[3] k8s学习-kubectl命令行 jsonpath的使用\n","wordCount":"1260","inLanguage":"zh","datePublished":"2023-09-25T00:00:00Z","dateModified":"2023-09-25T23:10:36+08:00","author":{"@type":"Person","name":"cylon"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.oomkill.com/2023/09/kubectl-jsonpath/"},"publisher":{"@type":"Organization","name":"Cylon's Collection","logo":{"@type":"ImageObject","url":"https://www.oomkill.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.oomkill.com/><img src=https://www.oomkill.com/favicon.ico alt aria-label=logo height=20>Cylon's Collection</a><div class=logo-switches><button id=theme-toggle><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.oomkill.com/archives><span>归档</span></a></li><li><a href=https://www.oomkill.com/tags><span>标签</span></a></li><li><a href=https://www.oomkill.com/search><span>搜索</span></a></li><li><a href=https://www.oomkill.com/about accesskey=/><span>关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">探索kubectl - 巧用jsonpath提取有用数据</h1><div class=post-meta><span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg><span>2023-09-25</span></span>&nbsp;·&nbsp;<span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select:text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z" style="user-select:text"/><polyline points="14 2 14 8 20 8" style="user-select:text"/><line x1="16" y1="13" x2="8" y2="13" style="user-select:text"/><line x1="16" y1="17" x2="8" y2="17" style="user-select:text"/><polyline points="10 9 9 9 8 9" style="user-select:text"/></svg><span>1260 字</span></span>&nbsp;·&nbsp;<span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><span>6 分钟</span></span>
<span class=pe-post-meta-item>&nbsp;·&nbsp;<svg t="1714036239378" fill="currentcolor" class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="6659" width="256" height="256"><path d="M690 78.2c-18.6-18.8-49-19-67.8-.4s-19 49-.4 67.8l255.4 258.6c67.8 68.6 67.8 178.8.0 247.4L653.4 878.2c-18.6 18.8-18.4 49.2.4 67.8s49.2 18.4 67.8-.4l224-226.4c104.8-106 104.8-276.4.0-382.4L690 78.2zM485.4 101.4c-24-24-56.6-37.4-90.6-37.4H96C43 64 0 107 0 160v299c0 34 13.4 66.6 37.4 90.6l336 336c50 50 131 50 181 0l267-267c50-50 50-131 0-181l-336-336zM96 160h299c8.4.0 16.6 3.4 22.6 9.4l336 336c12.4 12.4 12.4 32.8.0 45.2l-267 267c-12.4 12.4-32.8 12.4-45.2.0l-336-336c-6-6-9.4-14.2-9.4-22.6V160zm192 128a64 64 0 10-128 0 64 64 0 10128 0z" p-id="6660"/></svg></span><ul class=pe-post-meta-item><a href=https://www.oomkill.com/tags/kubernetes/>#Kubernetes</a></ul></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details><summary><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e4%bb%80%e4%b9%88%e6%98%afjsonpath aria-label=什么是jsonpath>什么是jsonpath</a><ul><li><a href=#kubectl%e4%b8%ad%e5%af%b9jsonpath%e7%9a%84%e6%94%af%e6%8c%81 aria-label=kubectl中对jsonpath的支持>kubectl中对jsonpath的支持</a><li><a href=#kubectl-jsonpath-%e7%a4%ba%e4%be%8b aria-label="kubectl jsonpath 示例">kubectl jsonpath 示例</a><li><a href=#%e4%bb%85%e8%8e%b7%e5%8f%96%e6%9f%90%e4%b8%aa%e8%b5%84%e6%ba%90%e7%9a%84%e5%90%8d%e7%a7%b0 aria-label=仅获取某个资源的名称>仅获取某个资源的名称</a><li><a href=#-%e7%9a%84%e7%94%a8%e6%b3%95 aria-label="@ 的用法">@ 的用法</a><li><a href=#-%e5%92%8c--%e7%9a%84%e7%94%a8%e6%b3%95 aria-label=". 和 [] 的用法">. 和 [] 的用法</a><li><a href=#%e4%b8%8b%e6%a0%87%e6%93%8d%e4%bd%9c%e7%ac%a6- aria-label="下标操作符 :">下标操作符 :</a><li><a href=#%e8%bf%87%e6%bb%a4%e8%a1%a8%e8%be%be%e5%bc%8f aria-label=过滤表达式>过滤表达式</a><li><a href=#%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f aria-label=正则表达式>正则表达式</a></ul><li><a href=#kubectl-example-%e7%a4%ba%e4%be%8b aria-label="kubectl example 示例">kubectl example 示例</a><ul><li><a href=#%e8%8e%b7%e5%8f%96-pod-%e4%b8%ba-web-%e7%9a%84-pod-name aria-label="获取 Pod 为 web 的 Pod name">获取 Pod 为 web 的 Pod name</a><li><a href=#%e8%bf%87%e6%bb%a4%e4%b8%80%e4%b8%aa%e5%85%83%e7%b4%a0 aria-label=过滤一个元素>过滤一个元素</a><li><a href=#%e4%bb%8e%e6%95%b0%e7%bb%84%e4%b8%ad%e8%8e%b7%e5%8f%96%e6%af%8f%e4%b8%aa%e5%85%83%e7%b4%a0%e7%9a%84%e5%8d%95%e4%b8%aa%e5%ad%97%e6%ae%b5 aria-label=从数组中获取每个元素的单个字段>从数组中获取每个元素的单个字段</a><li><a href=#%e6%8d%a2%e8%a1%8c aria-label=换行>换行</a><li><a href=#%e5%be%aa%e7%8e%af%e5%b9%b6%e8%8e%b7%e5%be%97%e5%a4%9a%e4%b8%aa%e5%85%83%e7%b4%a0 aria-label=循环并获得多个元素>循环并获得多个元素</a><li><a href=#%e9%80%92%e5%bd%92 aria-label=递归>递归</a><li><a href=#%e8%8e%b7%e5%8f%96%e6%af%8f%e4%b8%aa-pod-limit-%e5%80%bc aria-label="获取每个 Pod limit 值">获取每个 Pod limit 值</a><li><a href=#%e8%8e%b7%e5%8f%96%e5%ae%b9%e5%99%a8%e7%9a%84-ip aria-label="获取容器的 IP">获取容器的 IP</a><li><a href=#%e8%8e%b7%e5%8f%96%e6%89%80%e6%9c%89%e7%9a%84-container-id-%e5%92%8c-pod-ip aria-label="获取所有的 Container ID 和 Pod IP">获取所有的 Container ID 和 Pod IP</a><li><a href=#%e8%8e%b7%e5%8f%96%e6%89%80%e6%9c%89%e7%9a%84%e5%ae%b9%e5%99%a8%e5%90%8d%e7%a7%b0%e5%92%8c%e9%95%9c%e5%83%8f%e5%90%8d%e7%a7%b0 aria-label=获取所有的容器名称和镜像名称>获取所有的容器名称和镜像名称</a><li><a href=#%e8%8e%b7%e5%8f%96%e6%89%80%e6%9c%89%e7%8a%b6%e6%80%81%e6%9d%a1%e4%bb%b6%e4%b8%ad%e7%9a%84%e7%b1%bb%e5%9e%8b aria-label=获取所有状态条件中的类型>获取所有状态条件中的类型</a><li><a href=#%e8%8e%b7%e5%8f%96-pod-%e7%9a%84-apiversion aria-label="获取 Pod 的 apiversion">获取 Pod 的 apiversion</a><li><a href=#%e4%bb%8e%e7%ac%ac%e4%b8%80%e4%b8%aa%e7%8a%b6%e6%80%81%e6%9d%a1%e4%bb%b6%e5%bc%80%e5%a7%8b%e5%88%b0%e6%9c%80%e5%90%8e%e4%b8%80%e4%b8%aa%e7%bb%93%e6%9d%9f%e6%af%8f%e9%9a%942%e4%b8%aa%e8%8e%b7%e5%8f%96%e4%b8%80%e6%ac%a1 aria-label=从第一个状态条件开始到最后一个结束，每隔2个获取一次>从第一个状态条件开始到最后一个结束，每隔2个获取一次</a></ul><li><a href=#reference aria-label=Reference>Reference</a></li></div></details></div></aside><script src=/js/pe-toc.min.445eb1bfc5e85dd13b9519fcc2a806522e9629b6224a2974052789ba00ab78af.js integrity="sha256-RF6xv8XoXdE7lRn8wqgGUi6WKbYiSil0BSeJugCreK8="></script><div class=post-content><p>kubernetes集群工具 kubect 提供了一种强大的数据提取的模式，<strong>jsonpath</strong>，相对于 yaml 来说，jsonpath 拥有高度的自制提取功能，以及一些更便于提取字段的模式，使得过去 kubernetes 资源信息时更便捷，在本文中将解开 <strong>jsonpath</strong> 的神秘面纱。</p><h2 id=什么是jsonpath>什么是jsonpath<a hidden class=anchor aria-hidden=true href=#什么是jsonpath>#</a></h2><p>JSONPath 是一种用于查询 JSON 数据结构中特定元素的查询语言。它类似于 XPath 用于 XML 数据的查询。JSONPath 允许您以一种简单而灵活的方式从 JSON 对象中提取数据，而不需要编写复杂的代码来解析 JSON 结构。</p><p>JSONPath 使用路径表达式来指定您要检索的 JSON 数据的位置。这些路径表达式类似于文件系统中的路径，但用于导航 JSON 结构。以下是一些常见的 JSONPath 表达式示例：</p><ol><li><code>$</code>：表示 JSON 根对象。</li><li><code>$.store</code>：表示从根对象中获取名为 &ldquo;store&rdquo; 的属性。</li><li><code>$.store.book</code>：表示从根对象中获取 &ldquo;store&rdquo; 属性中的 &ldquo;book&rdquo; 属性。</li><li><code>$.store.book[0]</code>：表示获取 &ldquo;store&rdquo; 属性中的 &ldquo;book&rdquo; 属性的第一个元素。</li><li><code>$.store.book[?(@.price &lt; 10)]</code>：表示选择 &ldquo;store&rdquo; 属性中的 &ldquo;book&rdquo; 属性中价格小于 10 的所有元素。</li></ol><table><thead><tr><th>Function</th><th>Description</th><th>Example</th><th>Result</th></tr></thead><tbody><tr><td>text</td><td>the plain text</td><td>kind is {.kind}</td><td>kind is List</td></tr><tr><td>@</td><td>the current object</td><td>{@}</td><td>the same as input</td></tr><tr><td>. or []</td><td>child operator</td><td>{.kind} or {[‘kind’]}</td><td>List</td></tr><tr><td>..</td><td>recursive descent</td><td>{..name}</td><td>127.0.0.1 127.0.0.2 myself e2e</td></tr><tr><td>*</td><td>wildcard. Get all objects</td><td>{.items[*].metadata.name}</td><td>[127.0.0.1 127.0.0.2]</td></tr><tr><td>[start:end :step]</td><td>subscript operator</td><td>{.users[0].name}</td><td>myself</td></tr><tr><td>[,]</td><td>union operator</td><td>{.items[*][‘metadata.name’, ‘status.capacity’]}</td><td>127.0.0.1 127.0.0.2 map[cpu:4] map[cpu:8]</td></tr><tr><td>?()</td><td>filter</td><td>{.users[?(@.name==“e2e”)].user.password}</td><td>secret</td></tr><tr><td>range, end</td><td>iterate list</td><td>{range .items[*]}[{.metadata.name}, {.status.capacity}] {end}</td><td>[127.0.0.1, map[cpu:4]] [127.0.0.2, map[cpu:8]]</td></tr><tr><td>“</td><td>quote interpreted string</td><td>{range .items[*]}{.metadata.name}{’\t’}{end}</td><td>127.0.0.1 127.0.0.2</td></tr></tbody></table><p>JSONPath 支持各种操作符和函数，以便更复杂地筛选和操作 JSON 数据。它在 JSON 数据的导航和过滤方面非常强大，通常用于从 JSON 数据中提取所需的信息。</p><p>JSONPath 在各种编程语言和工具中都有实现，包括 JavaScript、Python、Java 等，因此您可以根据需要选择适合您项目的工具来使用 JSONPath 查询 JSON 数据。</p><h3 id=kubectl中对jsonpath的支持>kubectl中对jsonpath的支持<a hidden class=anchor aria-hidden=true href=#kubectl中对jsonpath的支持>#</a></h3><p>例如，通常在生产环境中处理 Kubernetes 问题时，您将需要查看数百个节点和数千个 Pod 的信息，例如 Deployment, Pod, Replicat, Service, Secret 等资源信息，但要获取这些类型的资源，通常会使用 kubectl 命令，然而在50%以上的高级场景下，是过滤信息并进行整理。在这种场景下，使用 kubectl + shell 命令进行整理的却没有 jsonpath 来的实在。假设在一个大规模集群中，例如 10 万个 Node 节点，这时如果你想获得一些节点信息，或者 Pod 信息，再或者某些需要循环的条件，这时候多次的请求对你在统计数据上造成的时间成本及频繁请求API都会造成压力，这个时候 <em>jsonpath</em> 的功能就很好的解决了这个问题，通过一次请求，快速循环可以在很短时间内得出结果，并减少了大量请求 <em>kube-apiserver</em> 的压力。</p><h3 id=kubectl-jsonpath-示例>kubectl jsonpath 示例<a hidden class=anchor aria-hidden=true href=#kubectl-jsonpath-示例>#</a></h3><h3 id=仅获取某个资源的名称>仅获取某个资源的名称<a hidden class=anchor aria-hidden=true href=#仅获取某个资源的名称>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 语法</span>
</span></span><span class=line><span class=cl>kubectl -n &lt;my_namespace&gt; get deploy/&lt;my_deployment&gt; -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.metadata.name}&#39;</span></span></span></code></pre></td></tr></table></div></div></div></div><p>获取一个 deployment的 信息</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get deploy/traefik -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.metadata.name}&#39;</span>
</span></span><span class=line><span class=cl>traefik</span></span></code></pre></td></tr></table></div></div></div></div><p>通常使用 json path 不会获取一个资源的信息，而是获取所有资源的信息，例如获取所有 Pod 的 name</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get pod -A -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s2>&#34;{.items[*][&#39;metadata.name&#39;]}&#34;</span>
</span></span><span class=line><span class=cl>echo-hello-world-task-run-1-pod-ksdtm echo-hello-world-task-run-pod-4sx9n traefik-679bf6459c-sz9jv calico-kube-controllers-577f77cb5c-kwhph calico-node-59d5x calico-node-82zgm coredns-6b9bb479b9-wnc8n minio spin-clouddriver-88df48858-dfzkg spin-deck-5dc8f847b8-m4tbk spin-echo-69868fd866-nxn8g spin-front50-54fb4b6d67-jfkds spin-gate-7b6f4d4566-gdjkd spin-orca-7765fb5c96-9gmvr spin-redis-8485df6b88-bgrgm spin-rosco-6d77f8cb-bf2nj tekton-pipelines-controller-5cdb46974f-8rjbx tekton-pipelines-webhook-6479d769ff-756gq</span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p>Tips：jsonpath 的输出是以字符串方式输出，不会携带换行之类的</p></blockquote><h3 id=-的用法>@ 的用法<a hidden class=anchor aria-hidden=true href=#-的用法>#</a></h3><p><em>@</em> 表示当前对象，例如 <em>kubectl get pods</em> 这获取的是一个 list 列表，那么 <em>@</em> 就代表这个 list，例如</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get pods -o<span class=o>=</span><span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{@}&#39;</span><span class=p>|</span>jq
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;apiVersion&#34;</span>: <span class=s2>&#34;v1&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;items&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>    <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;apiVersion&#34;</span>: <span class=s2>&#34;v1&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;kind&#34;</span>: <span class=s2>&#34;Pod&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;metadata&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;annotations&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;cni.projectcalico.org/containerID&#34;</span>: <span class=s2>&#34;aedb0d3f11b2572d82a7ccb456cec393f88de2c8befa4d19e69a577bb8c0e20f&#34;</span>,
</span></span><span class=line><span class=cl>          <span class=s2>&#34;cni.projectcalico.org/podIP&#34;</span>: <span class=s2>&#34;&#34;</span>,
</span></span><span class=line><span class=cl>          <span class=s2>&#34;cni.projectcalico.org/podIPs&#34;</span>: <span class=s2>&#34;&#34;</span>,
</span></span><span class=line><span class=cl>          <span class=s2>&#34;kubectl.kubernetes.io/last-applied-configuration&#34;</span>: <span class=s2>&#34;{\&#34;apiVersion\&#34;:\&#34;tekton.dev/v1beta1\&#34;,\&#34;kind\&#34;:\&#34;Task\&#34;,\&#34;metadata\&#34;:{\&#34;annotations\&#34;:{},\&#34;name\&#34;:\&#34;echo-hello-world\&#34;,\&#34;namespace\&#34;:\&#34;default\&#34;},\&#34;spec\&#34;:{\&#34;steps\&#34;:[{\&#34;args\&#34;:[\&#34;Hello World\&#34;],\&#34;command\&#34;:[\&#34;echo\&#34;],\&#34;image\&#34;:\&#34;busybox\&#34;,\&#34;name\&#34;:\&#34;echo\&#34;}]}}\n&#34;</span>,
</span></span><span class=line><span class=cl>          <span class=s2>&#34;pipeline.tekton.dev/release&#34;</span>: <span class=s2>&#34;v0.19.0&#34;</span>,
</span></span><span class=line><span class=cl>          <span class=s2>&#34;tekton.dev/ready&#34;</span>: <span class=s2>&#34;READY&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;creationTimestamp&#34;</span>: <span class=s2>&#34;2023-06-26T15:05:54Z&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;labels&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;app.kubernetes.io/managed-by&#34;</span>: <span class=s2>&#34;tekton-pipelines&#34;</span>,
</span></span><span class=line><span class=cl>          <span class=s2>&#34;tekton.dev/task&#34;</span>: <span class=s2>&#34;echo-hello-world&#34;</span>,
</span></span><span class=line><span class=cl>          <span class=s2>&#34;tekton.dev/taskRun&#34;</span>: <span class=s2>&#34;echo-hello-world-task-run-1&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;managedFields&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>          <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;apiVersion&#34;</span>: <span class=s2>&#34;v1&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;fieldsType&#34;</span>: <span class=s2>&#34;FieldsV1&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;fieldsV1&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>              <span class=s2>&#34;f:metadata&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;f:annotations&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                  <span class=s2>&#34;f:cni.projectcalico.org/containerID&#34;</span>: <span class=o>{}</span>,
</span></span><span class=line><span class=cl>                  <span class=s2>&#34;f:cni.projectcalico.org/podIP&#34;</span>: <span class=o>{}</span>,
</span></span><span class=line><span class=cl>                  <span class=s2>&#34;f:cni.projectcalico.org/podIPs&#34;</span>: <span class=o>{}</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>              <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;manager&#34;</span>: <span class=s2>&#34;calico&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;operation&#34;</span>: <span class=s2>&#34;Update&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;time&#34;</span>: <span class=s2>&#34;2023-06-26T15:05:55Z&#34;</span>
</span></span><span class=line><span class=cl>          <span class=o>}</span>,
</span></span><span class=line><span class=cl>          <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;apiVersion&#34;</span>: <span class=s2>&#34;v1&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;fieldsType&#34;</span>: <span class=s2>&#34;FieldsV1&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;fieldsV1&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>              <span class=s2>&#34;f:metadata&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;f:annotations&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                  <span class=s2>&#34;.&#34;</span>: <span class=o>{}</span>,
</span></span><span class=line><span class=cl>                  <span class=s2>&#34;f:kubectl.kubernetes.io/last-applied-configuration&#34;</span>: <span class=o>{}</span>,
</span></span><span class=line><span class=cl>                  <span class=s2>&#34;f:pipeline.tekton.dev/release&#34;</span>: <span class=o>{}</span>,
</span></span><span class=line><span class=cl>                  <span class=s2>&#34;f:tekton.dev/ready&#34;</span>: <span class=o>{}</span>
</span></span><span class=line><span class=cl> ...
</span></span><span class=line><span class=cl>        <span class=s2>&#34;nodeName&#34;</span>: <span class=s2>&#34;node01&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;preemptionPolicy&#34;</span>: <span class=s2>&#34;PreemptLowerPriority&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;priority&#34;</span>: 0,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;restartPolicy&#34;</span>: <span class=s2>&#34;Never&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;schedulerName&#34;</span>: <span class=s2>&#34;default-scheduler&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;securityContext&#34;</span>: <span class=o>{}</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;serviceAccount&#34;</span>: <span class=s2>&#34;default&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;serviceAccountName&#34;</span>: <span class=s2>&#34;default&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;terminationGracePeriodSeconds&#34;</span>: 30,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;tolerations&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>          <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;effect&#34;</span>: <span class=s2>&#34;NoExecute&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;key&#34;</span>: <span class=s2>&#34;node.kubernetes.io/not-ready&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;operator&#34;</span>: <span class=s2>&#34;Exists&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;tolerationSeconds&#34;</span>: <span class=m>300</span>
</span></span><span class=line><span class=cl>          <span class=o>}</span>,
</span></span><span class=line><span class=cl>          <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;effect&#34;</span>: <span class=s2>&#34;NoExecute&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;key&#34;</span>: <span class=s2>&#34;node.kubernetes.io/unreachable&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;operator&#34;</span>: <span class=s2>&#34;Exists&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;tolerationSeconds&#34;</span>: <span class=m>300</span>
</span></span><span class=line><span class=cl>          <span class=o>}</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=-和--的用法>. 和 [] 的用法<a hidden class=anchor aria-hidden=true href=#-和--的用法>#</a></h3><p><em>.</em> 和 <em>[]</em> 是子操作符，用于获取到列表的元素，返回值也是 list，例如获取 Pod 列表中第一个 Pod，下面是一个 [] 的使用示例，可以获取某个元素</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods -o<span class=o>=</span><span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.items[0]}&#39;</span> <span class=p>|</span> jq
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;apiVersion&#34;</span>: <span class=s2>&#34;v1&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;kind&#34;</span>: <span class=s2>&#34;Pod&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;metadata&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;annotations&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;cni.projectcalico.org/containerID&#34;</span>: <span class=s2>&#34;aedb0d3f11b2572d82a7ccb456cec393f88de2c8befa4d19e69a577bb8c0e20f&#34;</span>,
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>}</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;status&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;conditions&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>      <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;lastProbeTime&#34;</span>: null,
</span></span><span class=line><span class=cl>     
</span></span><span class=line><span class=cl>     ...
</span></span><span class=line><span class=cl>     
</span></span><span class=line><span class=cl>    <span class=s2>&#34;hostIP&#34;</span>: <span class=s2>&#34;10.0.0.5&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;initContainerStatuses&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>      <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;containerID&#34;</span>: <span class=s2>&#34;docker://8129d155a9e9f204a22947ae3268513a1bf4d1ce98012120ab30cfd0eca04564&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;image&#34;</span>: <span class=s2>&#34;sha256:5d54c55f19bc6fdda7629a4f2015255ec1bed2750a81909817bede45a4d360b5&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;imageID&#34;</span>: <span class=s2>&#34;docker-pullable://gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/entrypoint@sha256:67fceb87f3f76baefcfdb35fd04d0ebfc8d91117dccb7f3194056d6727bac636&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;lastState&#34;</span>: <span class=o>{}</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;name&#34;</span>: <span class=s2>&#34;place-tools&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;ready&#34;</span>: true,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;restartCount&#34;</span>: 0,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;state&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;terminated&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;containerID&#34;</span>: <span class=s2>&#34;docker://8129d155a9e9f204a22947ae3268513a1bf4d1ce98012120ab30cfd0eca04564&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;exitCode&#34;</span>: 0,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;finishedAt&#34;</span>: <span class=s2>&#34;2023-06-26T15:05:55Z&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;reason&#34;</span>: <span class=s2>&#34;Completed&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;startedAt&#34;</span>: <span class=s2>&#34;2023-06-26T15:05:55Z&#34;</span>
</span></span><span class=line><span class=cl>          <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;phase&#34;</span>: <span class=s2>&#34;Succeeded&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;podIP&#34;</span>: <span class=s2>&#34;10.244.196.131&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;podIPs&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>      <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;ip&#34;</span>: <span class=s2>&#34;10.244.196.131&#34;</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;qosClass&#34;</span>: <span class=s2>&#34;BestEffort&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;startTime&#34;</span>: <span class=s2>&#34;2023-06-26T15:05:54Z&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></td></tr></table></div></div></div></div><p>. 是 [] 的子操作符，可以获取某一个元素下的某个值，与 json 中语法相同，例如获取 Pod 列表中==第一个 Pod 的名称==</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get pods -o<span class=o>=</span><span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.items[0].metadata.name}&#39;</span>
</span></span><span class=line><span class=cl>echo-hello-world-task-run-1-pod-ksdtm</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=下标操作符->下标操作符 :<a hidden class=anchor aria-hidden=true href=#下标操作符->#</a></h3><p>下标操作符 “:” 可以视为一个切片，获取列表中某一些元素，语法为 <code>[start:end :step]</code></p><p>例如获取前三个元素的名称</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods -o<span class=o>=</span><span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.items[0:2].metadata.name}&#39;</span></span></span></code></pre></td></tr></table></div></div></div></div><p>获取最后两个元素</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash'</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><pre tabindex=0><code class="language-bash'" data-lang="bash'">$ kubectl get pods -n spinnaker -o jsonpath=&#39;{range .items[*]}{.metadata.name}{&#34;\n&#34;}{end}&#39;
spin-clouddriver-88df48858-dfzkg
spin-deck-5dc8f847b8-m4tbk
spin-echo-69868fd866-nxn8g
spin-front50-54fb4b6d67-jfkds
spin-gate-7b6f4d4566-gdjkd
spin-orca-7765fb5c96-9gmvr
spin-redis-8485df6b88-bgrgm
spin-rosco-6d77f8cb-bf2nj

$ kubectl get pods -n spinnaker -o jsonpath=&#39;{range .items[-2:]}{.metadata.name}{&#34;\n&#34;}{end}&#39;
spin-redis-8485df6b88-bgrgm
spin-rosco-6d77f8cb-bf2nj</code></pre></div></div><h3 id=过滤表达式>过滤表达式<a hidden class=anchor aria-hidden=true href=#过滤表达式>#</a></h3><p>如果设置了 <em>limit</em> 参数则打印其名称</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods -n spinnaker -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.items[?(@.spec.containers[*].resources.limits.memory != &#34;&#34;)].metadata.name}&#39;</span></span></span></code></pre></td></tr></table></div></div></div></div><p>价格大于 10 的 元素的 name</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=s2>&#34;</span>$<span class=s2>.store.book[?(@.price &gt; 10)].name&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><p>json path 支持下列过滤操作符参考 <sup><a href=#2>[2]</a></sup></p><table><thead><tr><th>Operator</th><th>Description</th></tr></thead><tbody><tr><td>==</td><td>等于。字符串值必须用单引号（而不是双引号）括起来：<code>[?(@.color=='red')]</code>。注意：数字与字符串比较的工作方式因播放引擎而异。在 TestEngine 中，1 不等于 “1”。在 ReadyAPI 1.9 及更早版本中，1 等于 “1”。</td></tr><tr><td>!=</td><td>不等于，字符串值必须用单引号括起来：<code>[?(@.color!='red')]</code>。</td></tr><tr><td>></td><td>大于</td></tr><tr><td>>=</td><td>大于或等于</td></tr><tr><td>&lt;</td><td>小于</td></tr><tr><td>&lt;=</td><td>小于或等于</td></tr><tr><td>=~</td><td>匹配 JavaScript 正则表达式。例如，<code>[?(@.description =~ /cat.*/i)]</code> 匹配描述以 cat 开头的项目（不区分大小写）。注意：如果使用 ReadyAPI 1.1 作为播放引擎，则不支持。</td></tr><tr><td>!</td><td>用于否定过滤器：<code>[?(!@.isbn)]</code> 匹配不具有 isbn 属性的项目。注意：如果使用 ReadyAPI 1.1 作为播放引擎，则不支持。</td></tr><tr><td>&&</td><td>逻辑与 AND，用于组合多个过滤表达式: <code>[?(@.category=='fiction' && @.price &lt; 10)]</code></td></tr><tr><td>||</td><td>逻辑或 OR Logical OR, 用于组合多个过滤表达式： `[?(@.category==&lsquo;fiction&rsquo;</td></tr><tr><td>in</td><td>检查左侧值是否存在于右侧列表中。类似于 SQL IN 运算符。字符串比较区分大小写。 <code>[?(@.size in ['M', 'L'])] [?('S' in @.sizes)]</code> 注意：仅由 TestEngine 播放引擎支持。</td></tr><tr><td>nin</td><td>与 in 相反。检查左侧值是否不存在于右侧列表中。字符串比较区分大小写。 <code>[?(@.size nin ['M', 'L'])] [?('S' nin @.sizes)]</code> 注意：仅由 TestEngine 播放引擎支持。</td></tr><tr><td>contains</td><td>检查字符串是否包含指定的子字符串（区分大小写），或者数组是否包含指定的元素。<br><code>[?(@.name contains 'Alex')]</code> <code>[?(@.numbers contains 7)]</code> <code>[?('ABCDEF' contains @.character)]</code><br>注意：仅由 TestEngine 播放引擎支持。</td></tr><tr><td>size</td><td>检查数组或字符串是否具有指定的长度。 <code>[?(@.name size 4)]</code> 注意：仅由 TestEngine 播放引擎支持。</td></tr><tr><td>empty true</td><td>匹配空数组或字符串。 <code>[?(@.name empty true)]</code> 注意：仅由 TestEngine 播放引擎支持。</td></tr><tr><td>empty false</td><td>匹配非空数组或字符串。 <code>[?(@.name empty false)]</code> 注意：仅由 TestEngine 播放引擎支持。</td></tr></tbody></table><h3 id=正则表达式>正则表达式<a hidden class=anchor aria-hidden=true href=#正则表达式>#</a></h3><p>kubectl jsonpath 不支持正则表达式，如果需要使用正则表达式可以使用 <em><strong>jq</strong></em> 替换</p><p>例如获取 <em>spin</em> 开头的 Pod 是否配置了 <em>resources</em></p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods -n spinnaker -o json <span class=p>|</span> jq -r <span class=s1>&#39;.items[] | select(.metadata.name | test(&#34;spin-&#34;)).spec.resources&#39;</span></span></span></code></pre></td></tr></table></div></div></div></div><p>example</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get pods -n spinnaker -o json <span class=p>|</span> jq -r <span class=s1>&#39;.items[] | select(.metadata.name | test(&#34;spin-&#34;)).spec.resources&#39;</span>
</span></span><span class=line><span class=cl>null
</span></span><span class=line><span class=cl>null
</span></span><span class=line><span class=cl>null
</span></span><span class=line><span class=cl>null
</span></span><span class=line><span class=cl>null
</span></span><span class=line><span class=cl>null
</span></span><span class=line><span class=cl>null
</span></span><span class=line><span class=cl>null</span></span></code></pre></td></tr></table></div></div></div></div><h2 id=kubectl-example-示例>kubectl example 示例<a hidden class=anchor aria-hidden=true href=#kubectl-example-示例>#</a></h2><h3 id=获取-pod-为-web-的-pod-name>获取 Pod 为 web 的 Pod name<a hidden class=anchor aria-hidden=true href=#获取-pod-为-web-的-pod-name>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods -o  <span class=nv>jsonpath</span>  <span class=o>=</span>  <span class=s1>&#39;{.items[?(@.metadata.labels.name==&#34;web&#34;)].metadata.name}&#39;</span> </span></span></code></pre></td></tr></table></div></div></div></div><h3 id=过滤一个元素>过滤一个元素<a hidden class=anchor aria-hidden=true href=#过滤一个元素>#</a></h3><p>过滤 Node 地址模式</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get nodes -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.items[*].status.addresses[?(@.type==&#34;InternalIP&#34;)]}&#39;</span></span></span></code></pre></td></tr></table></div></div></div></div><p>过滤元素并只打印想要的属性</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get nodes -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.items[*].status.addresses[?(@.type==&#34;InternalIP&#34;)].address}&#39;</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=从数组中获取每个元素的单个字段>从数组中获取每个元素的单个字段<a hidden class=anchor aria-hidden=true href=#从数组中获取每个元素的单个字段>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods -o <span class=nv>jsonpath</span><span class=o>={</span>$.items<span class=o>[</span>*<span class=o>]</span>.status.hostIP<span class=o>}</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=换行>换行<a hidden class=anchor aria-hidden=true href=#换行>#</a></h3><p>jsonpath 在获取元素后，是一个单行字符串，如果需要换行操作可以使用下面示例</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get pods -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{range .items[*]}{.status.hostIP}{&#34;\n&#34;}{end}&#39;</span>
</span></span><span class=line><span class=cl>10.0.0.5
</span></span><span class=line><span class=cl>10.0.0.5
</span></span><span class=line><span class=cl>10.0.0.5</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=循环并获得多个元素>循环并获得多个元素<a hidden class=anchor aria-hidden=true href=#循环并获得多个元素>#</a></h3><p>如果想获取两个元素，可以使用下面示例</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get pods -o <span class=nv>jsonpath</span><span class=o>={</span>range .items<span class=o>[</span>*<span class=o>]}{</span>.status.hostIP<span class=o>}{</span><span class=s2>&#34;\t&#34;</span><span class=o>}{</span>.status.phase<span class=o>}{</span><span class=s2>&#34;\n&#34;</span><span class=o>}{</span>end<span class=o>}</span>
</span></span><span class=line><span class=cl>10.154.196.228	Running
</span></span><span class=line><span class=cl>10.154.202.136	Running
</span></span><span class=line><span class=cl>10.154.201.54	Running</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=递归>递归<a hidden class=anchor aria-hidden=true href=#递归>#</a></h3><p>如果想获取一个元素下所有相同名称的字段，可以使用下面示例</p><p>递归获取所有 name 字段</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get pod -A -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{..name}&#39;</span>
</span></span><span class=line><span class=cl>step-echo place-tools echo-hello-world-task-run-1-pod-ksdtm echo-hello-world-task-run-1 tekton-internal-workspace tekton-internal-home tekton-internal-results tekton-internal-tools tekton-internal-downward tekton-creds-init-home-tlvg8 default-token-6762j step-echo HOME tekton-internal-tools tekton-internal-downward tekton-creds-init-home-tlvg8 tekton-internal-workspace tekton-i..
</span></span><span class=line><span class=cl>...</span></span></code></pre></td></tr></table></div></div></div></div><p>巧用递归简化语句，如果一个元素 (元素名称) 是独有的，那么可以使用递归直接获取到这个元素的值，例如，过去所有 containers</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get pods -A -o<span class=o>=</span><span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{range .items[*]}{&#34;pod: &#34;}{.metadata.name} {&#34;\n&#34;}{range ..containers[*]}{&#34;\tcontainer: &#34;}{.name}{&#34;\n\timage: &#34;}{.image}{&#34;\n&#34;}{end}{end}&#39;</span>
</span></span><span class=line><span class=cl>pod: echo-hello-world-task-run-1-pod-ksdtm 
</span></span><span class=line><span class=cl>	container: step-echo
</span></span><span class=line><span class=cl>	image: busybox
</span></span><span class=line><span class=cl>pod: echo-hello-world-task-run-pod-4sx9n 
</span></span><span class=line><span class=cl>	container: step-echo</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=获取每个-pod-limit-值>获取每个 Pod limit 值<a hidden class=anchor aria-hidden=true href=#获取每个-pod-limit-值>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl  get pod -A -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{range $.items[*]}{&#34;Pod: &#34;}{.metadata.name}{&#34;\n&#34;} {&#34;  limit_mem: &#34;}{.spec.containers[*].resources.limits.memory}{&#34;\n&#34;}{end}&#39;</span>
</span></span><span class=line><span class=cl>Pod: echo-hello-world-task-run-1-pod-ksdtm
</span></span><span class=line><span class=cl>   limit_mem: 
</span></span><span class=line><span class=cl>Pod: echo-hello-world-task-run-pod-4sx9n
</span></span><span class=line><span class=cl>   limit_mem: 
</span></span><span class=line><span class=cl>Pod: traefik-679bf6459c-sz9jv
</span></span><span class=line><span class=cl>   limit_mem: 
</span></span><span class=line><span class=cl>Pod: calico-kube-controllers-577f77cb5c-kwhph
</span></span><span class=line><span class=cl>   limit_mem: 
</span></span><span class=line><span class=cl>Pod: calico-node-59d5x
</span></span><span class=line><span class=cl>   limit_mem: 
</span></span><span class=line><span class=cl>Pod: calico-node-82zgm
</span></span><span class=line><span class=cl>   limit_mem: 
</span></span><span class=line><span class=cl>Pod: coredns-6b9bb479b9-wnc8n
</span></span><span class=line><span class=cl>   limit_mem: 170Mi
</span></span><span class=line><span class=cl>Pod: minio
</span></span><span class=line><span class=cl>   limit_mem: 
</span></span><span class=line><span class=cl>Pod: spin-clouddriver-88df48858-dfzkg
</span></span><span class=line><span class=cl>   limit_mem: 
</span></span><span class=line><span class=cl>Pod: spin-deck-7fbf94d8bc-k7zrk
</span></span><span class=line><span class=cl>   limit_mem: 200Mi
</span></span><span class=line><span class=cl>Pod: spin-echo-69868fd866-nxn8g
</span></span><span class=line><span class=cl>   limit_mem: 
</span></span><span class=line><span class=cl>Pod: spin-front50-54fb4b6d67-jfkds
</span></span><span class=line><span class=cl>   limit_mem: 
</span></span><span class=line><span class=cl>Pod: spin-gate-6d7dbf74b9-4l89r
</span></span><span class=line><span class=cl>   limit_mem: 600Mi
</span></span><span class=line><span class=cl>Pod: spin-orca-7765fb5c96-9gmvr
</span></span><span class=line><span class=cl>   limit_mem: 
</span></span><span class=line><span class=cl>Pod: spin-redis-8485df6b88-bgrgm
</span></span><span class=line><span class=cl>   limit_mem: 
</span></span><span class=line><span class=cl>Pod: spin-rosco-6d77f8cb-bf2nj
</span></span><span class=line><span class=cl>   limit_mem: 
</span></span><span class=line><span class=cl>Pod: tekton-pipelines-controller-5cdb46974f-8rjbx
</span></span><span class=line><span class=cl>   limit_mem: 
</span></span><span class=line><span class=cl>Pod: tekton-pipelines-webhook-6479d769ff-756gq
</span></span><span class=line><span class=cl>   limit_mem: 500Mi</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=获取容器的-ip>获取容器的 IP<a hidden class=anchor aria-hidden=true href=#获取容器的-ip>#</a></h3><p>获取单独一个 Pod</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl  get pod nginx-67d5fc57d8-jkfjp -n quota-example  -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.status.podIPs[].ip}{&#34;\n&#34;}&#39;</span></span></span></code></pre></td></tr></table></div></div></div></div><p>循环获取</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl  get pod  -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{range $.items[*]}{.status.podIPs[].ip}{&#34;\n&#34;}{end}&#39;</span>
</span></span><span class=line><span class=cl>10.244.196.131
</span></span><span class=line><span class=cl>10.244.196.129
</span></span><span class=line><span class=cl>10.244.196.186</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=获取所有的-container-id-和-pod-ip>获取所有的 Container ID 和 Pod IP<a hidden class=anchor aria-hidden=true href=#获取所有的-container-id-和-pod-ip>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods --all-namespaces    -o<span class=o>=</span><span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{range .items[*]}[{.status.containerStatuses[0].containerID}, {.status.podIP}]{&#34;\n&#34;}{end}&#39;</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=获取所有的容器名称和镜像名称>获取所有的容器名称和镜像名称<a hidden class=anchor aria-hidden=true href=#获取所有的容器名称和镜像名称>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods -n kube-system -o<span class=o>=</span><span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{range .items[*]}[{.metadata.name},{.status.containerStatuses[0].image}]{&#34;\n&#34;}{end}&#39;</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=获取所有状态条件中的类型>获取所有状态条件中的类型<a hidden class=anchor aria-hidden=true href=#获取所有状态条件中的类型>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pod cm-test-pod -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.status.conditions[*].type}&#39;</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=获取-pod-的-apiversion>获取 Pod 的 apiversion<a hidden class=anchor aria-hidden=true href=#获取-pod-的-apiversion>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pod cm-test-pod -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.apiVersion}&#39;</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=从第一个状态条件开始到最后一个结束每隔2个获取一次>从第一个状态条件开始到最后一个结束，每隔2个获取一次<a hidden class=anchor aria-hidden=true href=#从第一个状态条件开始到最后一个结束每隔2个获取一次>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pod cm-test-pod -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.status.conditions[0:3:2].type}&#39;</span></span></span></code></pre></td></tr></table></div></div></div></div><h2 id=reference>Reference<a hidden class=anchor aria-hidden=true href=#reference>#</a></h2><p><sup id=1>[1]</sup> <a href=https://kubernetes.io/docs/reference/kubectl/jsonpath/ target=_blank rel="noopener nofollow noreferrer"><em>jsonpath</em></a></p><p><sup id=2>[2]</sup> <a href=https://support.smartbear.com/alertsite/docs/monitors/api/endpoint/jsonpath.html target=_blank rel="noopener nofollow noreferrer"><em>JSONPath Syntax</em></a></p><p><sup id=2>[3]</sup> <a href=https://www.ctyun.cn/zhishi/p-168130 target=_blank rel="noopener nofollow noreferrer"><em>k8s学习-kubectl命令行 jsonpath的使用</em></a></p></div><div class=pe-copyright><hr><blockquote><p>本文为原创内容，版权归作者所有。如需转载，请在文章中声明本文标题及链接。</p><p>文章标题：探索kubectl - 巧用jsonpath提取有用数据</p><p>文章链接：<a href=https://www.oomkill.com/2023/09/kubectl-jsonpath/ target=_blank>https://www.oomkill.com/2023/09/kubectl-jsonpath/</a></p><p>许可协议：<a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></p></blockquote></div><div class=comments-separator></div><h3 class=relatedContentTitle>相关阅读</h3><ul class=relatedContent><li><a href=/2023/09/ingress-nginx-default-backend-status-code/><span>修改ingress-nginx中default backend默认状态码</span></a></li><li><a href=/2023/09/ch26-kube-proxy-clustercidr/><span>kube-proxy参数ClusterCIDR做什么</span></a></li><li><a href=/2023/08/ch29-volumemanager/><span>深入理解kubelet - VolumeManager源码解析</span></a></li><li><a href=/2023/06/calico-cni-deplyment/><span>在Kubernetes集群上安装 Calico cni 的注意事项</span></a></li><li><a href=/2023/06/kubernetes-limit-request/><span>Kubernetes中的资源限制 - Request&amp;Limit</span></a></li></ul><div class=comments-separator></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.oomkill.com/tags/kubernetes/>Kubernetes</a></li></ul><nav class=paginav><a class=prev href=https://www.oomkill.com/2023/10/update-curl-8-4/><span class=title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left" style="user-select:text"><line x1="19" y1="12" x2="5" y2="12" style="user-select:text"/><polyline points="12 19 5 12 12 5" style="user-select:text"/></polyline></svg>&nbsp;</span>
<span>CentOS6/7 curl SOCKS5堆溢出漏洞修复 CVE-2023-38545 CVE-2023-38546</span>
</a><a class=next href=https://www.oomkill.com/2023/09/05-4-s3cmd-in-windows/><span class=title></span>
<span>Ceph对象存储 - windows上安装s3cmd&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select:text"><line x1="5" y1="12" x2="19" y2="12" style="user-select:text"/><polyline points="12 5 19 12 12 19" style="user-select:text"/></svg></span></a></nav></footer><div class=pe-comments-decoration><p class=pe-comments-title></p><p class=pe-comments-subtitle></p></div><div id=pe-comments></div><script src=/js/pe-go-comment.min.86a214102576ba5f9b7bdc29eed8d58dd56e34aef80b3c65c73ea9cc88443696.js integrity="sha256-hqIUECV2ul+be9wp7tjVjdVuNK74Czxlxz6pzIhENpY="></script><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const s={src:"https://giscus.app/client.js","data-repo":"cylonchau/cylonchau.github.io","data-repo-id":"R_kgDOIRlNSQ","data-category":"Announcements","data-category-id":"DIC_kwDOIRlNSc4CXy1U","data-mapping":"pathname","data-term":"posts/kubectl jsonpath","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":getStoredTheme(),"data-lang":"zh-TW","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(s).forEach(([t,n])=>e.setAttribute(t,n)),document.querySelector("#pe-comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme);const n=document.querySelector("#theme-toggle-float");n&&n.addEventListener("click",setGiscusTheme)})</script></article></main><footer class=footer><span>&copy; 2024 <a href=https://www.oomkill.com/>Cylon's Collection</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> on
<a href=https://pages.github.com/ rel=noopener target=_blank>GitHub Pages</a> & Theme
        <a href=https://github.com/tofuwine/PaperMod-PE rel=noopener target=_blank>PaperMod-PE</a></span></footer><div class=pe-right-sidebar><a href=javascript:void(0); id=theme-toggle-float class=pe-float-btn><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</a><a href=#top class=pe-float-btn id=top-link><span id=pe-read-progress></span></a></div><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>