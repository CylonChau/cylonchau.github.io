<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>kubernetes概念 - serviceaccount | Cylon's Collection</title>
<meta name=keywords content="kubernetes"><meta name=description content="在整个Kubernetes集群来讲 apiserver是访问控制的唯一入口。如通过service或ingress暴露之后，是可以不通过apiserver接入的，只需要通过节点的nodePort或者ingress controller daemonset共享宿主机节点网络名称空间监听的宿主机网络地址（节点地址），直接接入。
当请求到达APIServer时，会经历几个阶段，如图所示
图：Kubernetes API 请求的请求处理步骤图Source：https://kubevious.io/blog/post/securing-kubernetes-using-pod-security-policy-admission-controller任何用户（sa与人类用户）在通过任何方式试图操作API资源时，必须要经历下列的操作：
Authentication，这个步骤在建立TLS连接后，验证包含，证书、密码，Token；可以指定多种认证，依次尝试每一个，直到其中一个认证成功。如果认证失败，此时客户端收到的是401。 Authorization，此步骤是在完成 Authentication 后确定了来源用户，此时用户的请求动作必须被授权。如bob用户对pod资源有 get , list 权限操作。如果 Admission Control：此步骤为图3，与 Authorization 不同的时，这里只要有任意准入控制器拒绝，则拒绝；多个准入控制器会按顺序执行 Refer to controlling access
认证 Kubernetes是高度模块化设计的，因此其认证授权与准入控制是各自都通过插件的方式，可由用户自定义选择经由什么样的插件来完成何种控制逻辑。如对称秘钥认证方式、令牌认证。由于Kubernetes提供的是resetful方式的接口，其服务都是通过HTTP协议提供的，因此认证信息只能经由HTTP协议的认证首部进行传递，此认证首部通常被称作认证令牌(token)。
ssl认证，对于Kubernetes访问来讲，ssl证书能让客户端去确认服务器的身份，（要求服务端发送服务端证书，确认证书是否为认可的CA签署的。）在Kubernetes通信过程当中，重要的是服务器还需认证客户端的身份，因此==Kubectl也应有一个证书，并且此证书为server端所认可的CA所签署的证书==。并且客户端身份也要与证书当中标识的身份保持一致。双方需互相做双向证书认证。认证之后双方基于SSL会话实现加密通讯。
注：kubernetes认证无需执行串行检查，用户经过任何一个认证插件通过后，即表示认证通过，无需再经由其他插件进行检查。
授权 kubernetes的授权也支持多种授权插件来完成用户的权限检查，kubernetes 1.6之后开始支持基于RBAC的认证。除此只外还有基于节点的认证、webhook基于http回调机制，通过web的rest服务来实现认证的检查机制。最重要的是RBAC的授权检查机制。基于角色的访问控制，通常只有许可授权，没有拒绝授权。默认都是拒绝。
在默认情况下，使用kubeadm部署Kubernetes集群是强制启用了RBAC认证的。
准入控制 一般而言，准入控制本身只是用来定义对应授权检查完成之后的后续其他安全检查操作的。
用户账号 一般而言用户账号大体上应具有以下信息
user 用户，一般而言由username与userid组成。
group 用户组
extra 用来提供额外信息
API资源 k8sapiserver是分组的，向哪个组，哪个版本的哪个api资源对象发出请求必须进行标识，所有的请求资源通过url path进行标识的。如 /apis/apps/v1/，所有名称空间级别的资源在访问时一般都需指名namespaces关键词，并给出namespaces名称来获取 /apis/apps/v1/namespaces/default/ /apis/apps/v1/namespaces/default/nginx 。
一个完整意义上的url 对象引用url格式 ==/apis/<GROUPS>/<VERSION>/namespaces/<NameSpace_name>/<Kind>/[/object_id]==
bash 1 2 3 $ kubectl api-versions admissionregistration.k8s.io/v1beta1 ... Kubernetes中，所有的api都取决于一个根 /apis
text 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 $ curl -k --cert /etc/k8s/pki/apiserver-kubelet-client."><meta name=author content="cylon"><link rel=canonical href=https://www.oomkill.com/2018/09/kubernetes-serviceaccount/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://www.oomkill.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.oomkill.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.oomkill.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.oomkill.com/favicon.ico><link rel=mask-icon href=https://www.oomkill.com/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://www.oomkill.com/2018/09/kubernetes-serviceaccount/><noscript><style>#theme-toggle,#top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link crossorigin=anonymous href=/assets/css/pe.min.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/pe.min.js></script><link rel=stylesheet href=https://cdn.staticfile.net/font-awesome/6.5.1/css/all.min.css><link rel=stylesheet href=https://cdn.staticfile.net/font-awesome/6.5.1/css/v4-shims.min.css><script defer src=https://cdn.staticfile.net/jquery/3.5.1/jquery.min.js></script><link rel=stylesheet href=https://cdn.staticfile.net/fancybox/3.5.7/jquery.fancybox.min.css><script defer src=https://cdn.staticfile.net/fancybox/3.5.7/jquery.fancybox.min.js></script><script id=MathJax-script async src=https://cdn.staticfile.net/mathjax/3.2.2/es5/tex-chtml.js></script><script>MathJax={tex:{displayMath:[["$$","$$"]],inlineMath:[["\\$","\\$"]]}}</script><meta property="og:title" content="kubernetes概念 - serviceaccount"><meta property="og:description" content="在整个Kubernetes集群来讲 apiserver是访问控制的唯一入口。如通过service或ingress暴露之后，是可以不通过apiserver接入的，只需要通过节点的nodePort或者ingress controller daemonset共享宿主机节点网络名称空间监听的宿主机网络地址（节点地址），直接接入。
当请求到达APIServer时，会经历几个阶段，如图所示
图：Kubernetes API 请求的请求处理步骤图Source：https://kubevious.io/blog/post/securing-kubernetes-using-pod-security-policy-admission-controller任何用户（sa与人类用户）在通过任何方式试图操作API资源时，必须要经历下列的操作：
Authentication，这个步骤在建立TLS连接后，验证包含，证书、密码，Token；可以指定多种认证，依次尝试每一个，直到其中一个认证成功。如果认证失败，此时客户端收到的是401。 Authorization，此步骤是在完成 Authentication 后确定了来源用户，此时用户的请求动作必须被授权。如bob用户对pod资源有 get , list 权限操作。如果 Admission Control：此步骤为图3，与 Authorization 不同的时，这里只要有任意准入控制器拒绝，则拒绝；多个准入控制器会按顺序执行 Refer to controlling access
认证 Kubernetes是高度模块化设计的，因此其认证授权与准入控制是各自都通过插件的方式，可由用户自定义选择经由什么样的插件来完成何种控制逻辑。如对称秘钥认证方式、令牌认证。由于Kubernetes提供的是resetful方式的接口，其服务都是通过HTTP协议提供的，因此认证信息只能经由HTTP协议的认证首部进行传递，此认证首部通常被称作认证令牌(token)。
ssl认证，对于Kubernetes访问来讲，ssl证书能让客户端去确认服务器的身份，（要求服务端发送服务端证书，确认证书是否为认可的CA签署的。）在Kubernetes通信过程当中，重要的是服务器还需认证客户端的身份，因此==Kubectl也应有一个证书，并且此证书为server端所认可的CA所签署的证书==。并且客户端身份也要与证书当中标识的身份保持一致。双方需互相做双向证书认证。认证之后双方基于SSL会话实现加密通讯。
注：kubernetes认证无需执行串行检查，用户经过任何一个认证插件通过后，即表示认证通过，无需再经由其他插件进行检查。
授权 kubernetes的授权也支持多种授权插件来完成用户的权限检查，kubernetes 1.6之后开始支持基于RBAC的认证。除此只外还有基于节点的认证、webhook基于http回调机制，通过web的rest服务来实现认证的检查机制。最重要的是RBAC的授权检查机制。基于角色的访问控制，通常只有许可授权，没有拒绝授权。默认都是拒绝。
在默认情况下，使用kubeadm部署Kubernetes集群是强制启用了RBAC认证的。
准入控制 一般而言，准入控制本身只是用来定义对应授权检查完成之后的后续其他安全检查操作的。
用户账号 一般而言用户账号大体上应具有以下信息
user 用户，一般而言由username与userid组成。
group 用户组
extra 用来提供额外信息
API资源 k8sapiserver是分组的，向哪个组，哪个版本的哪个api资源对象发出请求必须进行标识，所有的请求资源通过url path进行标识的。如 /apis/apps/v1/，所有名称空间级别的资源在访问时一般都需指名namespaces关键词，并给出namespaces名称来获取 /apis/apps/v1/namespaces/default/ /apis/apps/v1/namespaces/default/nginx 。
一个完整意义上的url 对象引用url格式 ==/apis/<GROUPS>/<VERSION>/namespaces/<NameSpace_name>/<Kind>/[/object_id]==
bash 1 2 3 $ kubectl api-versions admissionregistration.k8s.io/v1beta1 ... Kubernetes中，所有的api都取决于一个根 /apis
text 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 $ curl -k --cert /etc/k8s/pki/apiserver-kubelet-client."><meta property="og:type" content="article"><meta property="og:url" content="https://www.oomkill.com/2018/09/kubernetes-serviceaccount/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-09-28T00:00:00+00:00"><meta property="article:modified_time" content="2023-03-22T23:00:36+08:00"><meta property="og:site_name" content="Cylon's Collection"><meta name=twitter:card content="summary"><meta name=twitter:title content="kubernetes概念 - serviceaccount"><meta name=twitter:description content="在整个Kubernetes集群来讲 apiserver是访问控制的唯一入口。如通过service或ingress暴露之后，是可以不通过apiserver接入的，只需要通过节点的nodePort或者ingress controller daemonset共享宿主机节点网络名称空间监听的宿主机网络地址（节点地址），直接接入。
当请求到达APIServer时，会经历几个阶段，如图所示
图：Kubernetes API 请求的请求处理步骤图Source：https://kubevious.io/blog/post/securing-kubernetes-using-pod-security-policy-admission-controller任何用户（sa与人类用户）在通过任何方式试图操作API资源时，必须要经历下列的操作：
Authentication，这个步骤在建立TLS连接后，验证包含，证书、密码，Token；可以指定多种认证，依次尝试每一个，直到其中一个认证成功。如果认证失败，此时客户端收到的是401。 Authorization，此步骤是在完成 Authentication 后确定了来源用户，此时用户的请求动作必须被授权。如bob用户对pod资源有 get , list 权限操作。如果 Admission Control：此步骤为图3，与 Authorization 不同的时，这里只要有任意准入控制器拒绝，则拒绝；多个准入控制器会按顺序执行 Refer to controlling access
认证 Kubernetes是高度模块化设计的，因此其认证授权与准入控制是各自都通过插件的方式，可由用户自定义选择经由什么样的插件来完成何种控制逻辑。如对称秘钥认证方式、令牌认证。由于Kubernetes提供的是resetful方式的接口，其服务都是通过HTTP协议提供的，因此认证信息只能经由HTTP协议的认证首部进行传递，此认证首部通常被称作认证令牌(token)。
ssl认证，对于Kubernetes访问来讲，ssl证书能让客户端去确认服务器的身份，（要求服务端发送服务端证书，确认证书是否为认可的CA签署的。）在Kubernetes通信过程当中，重要的是服务器还需认证客户端的身份，因此==Kubectl也应有一个证书，并且此证书为server端所认可的CA所签署的证书==。并且客户端身份也要与证书当中标识的身份保持一致。双方需互相做双向证书认证。认证之后双方基于SSL会话实现加密通讯。
注：kubernetes认证无需执行串行检查，用户经过任何一个认证插件通过后，即表示认证通过，无需再经由其他插件进行检查。
授权 kubernetes的授权也支持多种授权插件来完成用户的权限检查，kubernetes 1.6之后开始支持基于RBAC的认证。除此只外还有基于节点的认证、webhook基于http回调机制，通过web的rest服务来实现认证的检查机制。最重要的是RBAC的授权检查机制。基于角色的访问控制，通常只有许可授权，没有拒绝授权。默认都是拒绝。
在默认情况下，使用kubeadm部署Kubernetes集群是强制启用了RBAC认证的。
准入控制 一般而言，准入控制本身只是用来定义对应授权检查完成之后的后续其他安全检查操作的。
用户账号 一般而言用户账号大体上应具有以下信息
user 用户，一般而言由username与userid组成。
group 用户组
extra 用来提供额外信息
API资源 k8sapiserver是分组的，向哪个组，哪个版本的哪个api资源对象发出请求必须进行标识，所有的请求资源通过url path进行标识的。如 /apis/apps/v1/，所有名称空间级别的资源在访问时一般都需指名namespaces关键词，并给出namespaces名称来获取 /apis/apps/v1/namespaces/default/ /apis/apps/v1/namespaces/default/nginx 。
一个完整意义上的url 对象引用url格式 ==/apis/<GROUPS>/<VERSION>/namespaces/<NameSpace_name>/<Kind>/[/object_id]==
bash 1 2 3 $ kubectl api-versions admissionregistration.k8s.io/v1beta1 ... Kubernetes中，所有的api都取决于一个根 /apis
text 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 $ curl -k --cert /etc/k8s/pki/apiserver-kubelet-client."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.oomkill.com/posts/"},{"@type":"ListItem","position":2,"name":"kubernetes概念 - serviceaccount","item":"https://www.oomkill.com/2018/09/kubernetes-serviceaccount/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"kubernetes概念 - serviceaccount","name":"kubernetes概念 - serviceaccount","description":"在整个Kubernetes集群来讲 apiserver是访问控制的唯一入口。如通过service或ingress暴露之后，是可以不通过apiserver接入的，只需要通过节点的nodePort或者ingress controller daemonset共享宿主机节点网络名称空间监听的宿主机网络地址（节点地址），直接接入。\n当请求到达APIServer时，会经历几个阶段，如图所示\n图：Kubernetes API 请求的请求处理步骤图\rSource：https://kubevious.io/blog/post/securing-kubernetes-using-pod-security-policy-admission-controller\r任何用户（sa与人类用户）在通过任何方式试图操作API资源时，必须要经历下列的操作：\nAuthentication，这个步骤在建立TLS连接后，验证包含，证书、密码，Token；可以指定多种认证，依次尝试每一个，直到其中一个认证成功。如果认证失败，此时客户端收到的是401。 Authorization，此步骤是在完成 Authentication 后确定了来源用户，此时用户的请求动作必须被授权。如bob用户对pod资源有 get , list 权限操作。如果 Admission Control：此步骤为图3，与 Authorization 不同的时，这里只要有任意准入控制器拒绝，则拒绝；多个准入控制器会按顺序执行 Refer to controlling access\n认证 Kubernetes是高度模块化设计的，因此其认证授权与准入控制是各自都通过插件的方式，可由用户自定义选择经由什么样的插件来完成何种控制逻辑。如对称秘钥认证方式、令牌认证。由于Kubernetes提供的是resetful方式的接口，其服务都是通过HTTP协议提供的，因此认证信息只能经由HTTP协议的认证首部进行传递，此认证首部通常被称作认证令牌(token)。\nssl认证，对于Kubernetes访问来讲，ssl证书能让客户端去确认服务器的身份，（要求服务端发送服务端证书，确认证书是否为认可的CA签署的。）在Kubernetes通信过程当中，重要的是服务器还需认证客户端的身份，因此==Kubectl也应有一个证书，并且此证书为server端所认可的CA所签署的证书==。并且客户端身份也要与证书当中标识的身份保持一致。双方需互相做双向证书认证。认证之后双方基于SSL会话实现加密通讯。\n注：kubernetes认证无需执行串行检查，用户经过任何一个认证插件通过后，即表示认证通过，无需再经由其他插件进行检查。\n授权 kubernetes的授权也支持多种授权插件来完成用户的权限检查，kubernetes 1.6之后开始支持基于RBAC的认证。除此只外还有基于节点的认证、webhook基于http回调机制，通过web的rest服务来实现认证的检查机制。最重要的是RBAC的授权检查机制。基于角色的访问控制，通常只有许可授权，没有拒绝授权。默认都是拒绝。\n在默认情况下，使用kubeadm部署Kubernetes集群是强制启用了RBAC认证的。\n准入控制 一般而言，准入控制本身只是用来定义对应授权检查完成之后的后续其他安全检查操作的。\n用户账号 一般而言用户账号大体上应具有以下信息\nuser 用户，一般而言由username与userid组成。\ngroup 用户组\nextra 用来提供额外信息\nAPI资源 k8sapiserver是分组的，向哪个组，哪个版本的哪个api资源对象发出请求必须进行标识，所有的请求资源通过url path进行标识的。如 /apis/apps/v1/，所有名称空间级别的资源在访问时一般都需指名namespaces关键词，并给出namespaces名称来获取 /apis/apps/v1/namespaces/default/ /apis/apps/v1/namespaces/default/nginx 。\n一个完整意义上的url 对象引用url格式 ==/apis/\u0026lt;GROUPS\u0026gt;/\u0026lt;VERSION\u0026gt;/namespaces/\u0026lt;NameSpace_name\u0026gt;/\u0026lt;Kind\u0026gt;/[/object_id]==\nbash 1 2 3 $ kubectl api-versions admissionregistration.k8s.io/v1beta1 ... Kubernetes中，所有的api都取决于一个根 /apis\ntext 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 $ curl -k --cert /etc/k8s/pki/apiserver-kubelet-client.","keywords":["kubernetes"],"articleBody":"在整个Kubernetes集群来讲 apiserver是访问控制的唯一入口。如通过service或ingress暴露之后，是可以不通过apiserver接入的，只需要通过节点的nodePort或者ingress controller daemonset共享宿主机节点网络名称空间监听的宿主机网络地址（节点地址），直接接入。\n当请求到达APIServer时，会经历几个阶段，如图所示\n图：Kubernetes API 请求的请求处理步骤图\rSource：https://kubevious.io/blog/post/securing-kubernetes-using-pod-security-policy-admission-controller\r任何用户（sa与人类用户）在通过任何方式试图操作API资源时，必须要经历下列的操作：\nAuthentication，这个步骤在建立TLS连接后，验证包含，证书、密码，Token；可以指定多种认证，依次尝试每一个，直到其中一个认证成功。如果认证失败，此时客户端收到的是401。 Authorization，此步骤是在完成 Authentication 后确定了来源用户，此时用户的请求动作必须被授权。如bob用户对pod资源有 get , list 权限操作。如果 Admission Control：此步骤为图3，与 Authorization 不同的时，这里只要有任意准入控制器拒绝，则拒绝；多个准入控制器会按顺序执行 Refer to controlling access\n认证 Kubernetes是高度模块化设计的，因此其认证授权与准入控制是各自都通过插件的方式，可由用户自定义选择经由什么样的插件来完成何种控制逻辑。如对称秘钥认证方式、令牌认证。由于Kubernetes提供的是resetful方式的接口，其服务都是通过HTTP协议提供的，因此认证信息只能经由HTTP协议的认证首部进行传递，此认证首部通常被称作认证令牌(token)。\nssl认证，对于Kubernetes访问来讲，ssl证书能让客户端去确认服务器的身份，（要求服务端发送服务端证书，确认证书是否为认可的CA签署的。）在Kubernetes通信过程当中，重要的是服务器还需认证客户端的身份，因此==Kubectl也应有一个证书，并且此证书为server端所认可的CA所签署的证书==。并且客户端身份也要与证书当中标识的身份保持一致。双方需互相做双向证书认证。认证之后双方基于SSL会话实现加密通讯。\n注：kubernetes认证无需执行串行检查，用户经过任何一个认证插件通过后，即表示认证通过，无需再经由其他插件进行检查。\n授权 kubernetes的授权也支持多种授权插件来完成用户的权限检查，kubernetes 1.6之后开始支持基于RBAC的认证。除此只外还有基于节点的认证、webhook基于http回调机制，通过web的rest服务来实现认证的检查机制。最重要的是RBAC的授权检查机制。基于角色的访问控制，通常只有许可授权，没有拒绝授权。默认都是拒绝。\n在默认情况下，使用kubeadm部署Kubernetes集群是强制启用了RBAC认证的。\n准入控制 一般而言，准入控制本身只是用来定义对应授权检查完成之后的后续其他安全检查操作的。\n用户账号 一般而言用户账号大体上应具有以下信息\nuser 用户，一般而言由username与userid组成。\ngroup 用户组\nextra 用来提供额外信息\nAPI资源 k8sapiserver是分组的，向哪个组，哪个版本的哪个api资源对象发出请求必须进行标识，所有的请求资源通过url path进行标识的。如 /apis/apps/v1/，所有名称空间级别的资源在访问时一般都需指名namespaces关键词，并给出namespaces名称来获取 /apis/apps/v1/namespaces/default/ /apis/apps/v1/namespaces/default/nginx 。\n一个完整意义上的url 对象引用url格式 ==/apis///namespaces///[/object_id]==\nbash 1 2 3 $ kubectl api-versions admissionregistration.k8s.io/v1beta1 ... Kubernetes中，所有的api都取决于一个根 /apis\ntext 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 $ curl -k --cert /etc/k8s/pki/apiserver-kubelet-client.crt --key /etc/k8s/pki/apiserver-kubelet-client.key https://localhost:6443/apis/apps/v1/namespaces/typay/deployments/nginx-ingress-controller { \"kind\": \"Deployment\", \"apiVersion\": \"apps/v1\", \"metadata\": { \"name\": \"nginx-ingress-controller\", \"namespace\": \"houtu\", \"selfLink\": \"/apis/apps/v1/namespaces/houtu/deployments/nginx-ingress-controller\", \"uid\": \"dc8cbca7-fcab-49c5-a4f4-b44858bbf603\", \"resourceVersion\": \"225525\", \"generation\": 4, \"creationTimestamp\": \"2019-11-21T12:47:33Z\", \"labels\": { \"k8s-app\": \"nginx-ingress-controller\" }, \"annotations\": { \"deployment.kubernetes.io/revision\": \"4\", \"kubectl.kubernetes.io/last-applied-configuration\": \"{\\\"apiVersion\\\":\\\"extensions/v1beta1\\\",\\\"kind\\\":\\\"Deployment\\\",\\\"metadata\\\":{\\\"annotations\\\":{},\\\"labels\\\":{\\\"k8s-app\\\":\\\"nginx-ingress-controller\\\"},\\\"name\\\":\\\"nginx-ingress-controller\\\",\\\"namespace\\\":\\\"houtu\\\"},\\\"spec\\\":{\\\"replicas\\\":1,\\\"template\\\":{\\\"metadata\\\":{\\\"labels\\\":{\\\"k8s-app\\\":\\\"nginx-ingress-controller\\\"}},\\\"spec\\\":{\\\"containers\\\":[{\\\"args\\\":[\\\"/nginx-ingress-controller\\\",\\\"--default-backend-service=houtu/push-front\\\"],\\\"env\\\":[{\\\"name\\\":\\\"POD_NAME\\\",\\\"valueFrom\\\":{\\\"fieldRef\\\":{\\\"fieldPath\\\":\\\"metadata.name\\\"}}},{\\\"name\\\":\\\"POD_NAMESPACE\\\",\\\"valueFrom\\\":{\\\"fieldRef\\\":{\\\"fieldPath\\\":\\\"metadata.namespace\\\"}}}],\\\"image\\\":\\\"quay.io/kubernetes-ingress-controller/nginx-ingress-controller:0.26.1\\\",\\\"livenessProbe\\\":{\\\"httpGet\\\":{\\\"path\\\":\\\"/healthz\\\",\\\"port\\\":10254,\\\"scheme\\\":\\\"HTTP\\\"},\\\"initialDelaySeconds\\\":10,\\\"timeoutSeconds\\\":1},\\\"name\\\":\\\"nginx-ingress-controller\\\",\\\"ports\\\":[{\\\"containerPort\\\":80,\\\"hostPort\\\":80},{\\\"containerPort\\\":443,\\\"hostPort\\\":443}],\\\"readinessProbe\\\":{\\\"httpGet\\\":{\\\"path\\\":\\\"/healthz\\\",\\\"port\\\":10254,\\\"scheme\\\":\\\"HTTP\\\"}}}],\\\"hostNetwork\\\":true,\\\"serviceAccountName\\\":\\\"nginx-ingress-serviceaccount\\\",\\\"terminationGracePeriodSeconds\\\":60}}}}\\n\" } }, \"spec\": { \"replicas\": 1, \"selector\": { \"matchLabels\": { \"k8s-app\": \"nginx-ingress-controller\" } }, \"template\": { \"metadata\": { \"creationTimestamp\": null, \"labels\": { \"k8s-app\": \"nginx-ingress-controller\" } }, \"spec\": { \"containers\": [ { \"name\": \"nginx-ingress-controller\", \"image\": \"quay.io/kubernetes-ingress-controller/nginx-ingress-controller:0.26.1\", \"args\": [ \"/nginx-ingress-controller\", \"--default-backend-service=houtu/push-front\" ], \"ports\": [ { \"hostPort\": 80, \"containerPort\": 80, \"protocol\": \"TCP\" }, { \"hostPort\": 443, \"containerPort\": 443, \"protocol\": \"TCP\" } ], \"env\": [ { \"name\": \"POD_NAME\", \"valueFrom\": { \"fieldRef\": { \"apiVersion\": \"v1\", \"fieldPath\": \"metadata.name\" } } }, { \"name\": \"POD_NAMESPACE\", \"valueFrom\": { \"fieldRef\": { \"apiVersion\": \"v1\", \"fieldPath\": \"metadata.namespace\" } } } ], \"resources\": { }, \"livenessProbe\": { \"httpGet\": { \"path\": \"/healthz\", \"port\": 10254, \"scheme\": \"HTTP\" }, \"initialDelaySeconds\": 10, \"timeoutSeconds\": 1, \"periodSeconds\": 10, \"successThreshold\": 1, \"failureThreshold\": 3 }, \"readinessProbe\": { \"httpGet\": { \"path\": \"/healthz\", \"port\": 10254, \"scheme\": \"HTTP\" }, \"timeoutSeconds\": 1, \"periodSeconds\": 10, \"successThreshold\": 1, \"failureThreshold\": 3 }, \"terminationMessagePath\": \"/dev/termination-log\", \"terminationMessagePolicy\": \"File\", \"imagePullPolicy\": \"IfNotPresent\" } ], \"restartPolicy\": \"Always\", \"terminationGracePeriodSeconds\": 60, \"dnsPolicy\": \"ClusterFirst\", \"serviceAccountName\": \"nginx-ingress-serviceaccount\", \"serviceAccount\": \"nginx-ingress-serviceaccount\", \"hostNetwork\": true, \"securityContext\": { }, \"schedulerName\": \"default-scheduler\" } }, \"strategy\": { \"type\": \"RollingUpdate\", \"rollingUpdate\": { \"maxUnavailable\": 1, \"maxSurge\": 1 } }, \"revisionHistoryLimit\": 2147483647, \"progressDeadlineSeconds\": 2147483647 }, \"status\": { \"observedGeneration\": 4, \"replicas\": 1, \"updatedReplicas\": 1, \"unavailableReplicas\": 1, \"conditions\": [ { \"type\": \"Available\", \"status\": \"True\", \"lastUpdateTime\": \"2019-11-21T12:47:33Z\", \"lastTransitionTime\": \"2019-11-21T12:47:33Z\", \"reason\": \"MinimumReplicasAvailable\", \"message\": \"Deployment has minimum availability.\" } ] } } bash 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 $ curl -k --cert /etc/k8s/pki/apiserver-kubelet-client.crt --key /etc/k8s/pki/apiserver-kubelet-client.key https://localhost:6443/api/v1/namespaces/houtu { \"kind\": \"Namespace\", \"apiVersion\": \"v1\", \"metadata\": { \"name\": \"houtu\", \"selfLink\": \"/api/v1/namespaces/houtu\", \"uid\": \"da736612-d112-4e38-8546-0f2b9169b92f\", \"resourceVersion\": \"201510\", \"creationTimestamp\": \"2019-11-21T08:33:38Z\" }, \"spec\": { \"finalizers\": [ \"kubernetes\" ] }, \"status\": { \"phase\": \"Active\" } } 删除操作\ntext 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 $ curl X DELETE -k --cert /etc/k8s/pki/apiserver-kubelet-client.crt --key /etc/k8s/pki/apiserver-kubelet-client.key https://localhost:6443/apis/apps/v1/namespaces/default/deployments/nginx-test/ { \"kind\": \"Status\", \"apiVersion\": \"v1\", \"metadata\": { }, \"status\": \"Success\", \"details\": { \"name\": \"nginx-test\", \"group\": \"apps\", \"kind\": \"deployments\", \"uid\": \"12c5184c-82bc-4f7d-8ec8-38a2439983cf\" } } $ kubectl get deploy No resources found. 在Kubernetes之上，来自于那些地方的客户端需要和apiserver打交道\n集群外部客户端，通过apiserver对外通信的监听地址 集群之上的客户端，apiserver拥有一个在集群内工作地址，``kubectl get svc` 查看，kubernetes是将apiserver以service方式引入到集群内部，从而使得Pod直接请求集群上的apiserver的服务了。 Pod在请求apiserver上的服务是通过10.96.0.1来进行的。但是apiserver请求是需要做认证的。首先apiserver将自己证书传递给客户端，客户端去校验服务端(apiserver)身份。 服务器发给每个Pod客户端的时候，证书所标明的身份的地址为10.96.0.1，所以在apiserver上手动创建证书，必须要确保证书持有者名称能够解析到两条IP记录才可以。\ntext 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 $ kubectl get svc NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE kubernetes ClusterIP 10.96.0.1 443/TCP 47h $ kubectl describe svc kubernetes Name: kubernetes Namespace: default Labels: component=apiserver provider=kubernetes Annotations: Selector: Type: ClusterIP IP: 10.96.0.1 Port: https 443/TCP TargetPort: 6443/TCP Endpoints: 172.31.71.50:6443 Session Affinity: None Events: 类型分类\n对象类 deployment、namespace都属于对象类。 同一类型下的所有对象的集合在reset风格API下叫集合，在Kubernetes中被称之为列表（list）。 xx Kubernetes api账户有两类，真实的账户（人用的账户）userAccount与==Pod客户端serviceAccount==（Pod连接apiserver使用的账户）。\n每个Pod无论你定义与否，都会挂载一个存储卷，这就是Podservice认证时的认证信息，通过secret定义存储卷的方式关联到Pod上，从而使Pod内运行的应用，通次secret保存的认证信息，来连接apiserver并完成认证。\n在每一个名称空间当中都存在一个默认的secret，default-token-xxx，这是让当前名称空间当中所有的Pod资源试图去连接apiserver时，隐藏的、预制的一个认证信息。所以所有的Pod都能直接连接apiserver。此secret所包含的认证信息仅仅是获取当前Pod自身的属性。\n给Pod增加自定义服务账号。 serviceAccount也属于标准的Kubernetes资源，可以自行创建serviceAccount，由自定义Pod使用serviceAccountName去加载自定义serviceAccount。serviceAccount是一个可以使用命令行创建的简单资源对象，可以使用kubectl create serviceaccount，创建也可以使用资源清单进行创建。\n语法\ntext 1 kubectl create serviceaccount {Name} -o yaml --dry-run serveraccount本身不具备权限，可以使用rbac对serviceaccount授予权限\n创建完之后会自动生成一个token信息，用于让sa连接至当前系统认证的信息。注：认证不代表权限，可以登录、认证到Kubernetes但是做不了其余事情。所有的的操作权限靠授权实现的。\n在创建Pod中使用自定义的sa\nyaml 1 2 3 spec: containers: serviceAccountName: admin text 1 2 3 4 5 6 7 Volumes: default-token-4pj85: Type: Secret (a volume populated by a Secret) SecretName: default-token-4pj85 Optional: false QoS Class: BestEffort Node-Selectors: 在定义好secret后，在定义Pod时，使用 imagePullSecrets 指明用哪个secret对象，secret对象中包含了认证私有regsi的账号和密码。\n在Pod当中也可以不使用imagePullSecrets来告诉Pod如何去下载镜像文件。而可以直接使用serviceAccountName。serviceAccountName相当于指定一个sa账号，而sa账号是可以附带认证到私有regsiry的secret信息的。Pod通过sa的Image pull secrets也能完成资源镜像下载时的认证。这样就不会在Pod资源清单中泄露出去secret使用的什么信息。\n使用kubectl describe sa admin\nPod获取私有镜像时的两种认证方式\n在Pod上直接使用imagePullSecrets字段指定认证使用的secret对象。 在Pod自定义serviceAccount，在serviceAccount附加此Pod获取镜像认证时使用的secret对象。 Reference controlling access\n","wordCount":"733","inLanguage":"zh","datePublished":"2018-09-28T00:00:00Z","dateModified":"2023-03-22T23:00:36+08:00","author":{"@type":"Person","name":"cylon"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.oomkill.com/2018/09/kubernetes-serviceaccount/"},"publisher":{"@type":"Organization","name":"Cylon's Collection","logo":{"@type":"ImageObject","url":"https://www.oomkill.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.oomkill.com/><img src=https://www.oomkill.com/favicon.ico alt aria-label=logo height=20>Cylon's Collection</a><div class=logo-switches><button id=theme-toggle><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.oomkill.com/archives><span>归档</span></a></li><li><a href=https://www.oomkill.com/tags><span>标签</span></a></li><li><a href=https://www.oomkill.com/search><span>搜索</span></a></li><li><a href=https://www.oomkill.com/about accesskey=/><span>关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">kubernetes概念 - serviceaccount</h1><div class=post-meta><span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg><span>2018-09-28</span></span>&nbsp;·&nbsp;<span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select:text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z" style="user-select:text"/><polyline points="14 2 14 8 20 8" style="user-select:text"/><line x1="16" y1="13" x2="8" y2="13" style="user-select:text"/><line x1="16" y1="17" x2="8" y2="17" style="user-select:text"/><polyline points="10 9 9 9 8 9" style="user-select:text"/></svg><span>733 字</span></span>&nbsp;·&nbsp;<span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><span>4 分钟</span></span>
<span class=pe-post-meta-item>&nbsp;·&nbsp;<svg t="1714036239378" fill="currentcolor" class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="6659" width="256" height="256"><path d="M690 78.2c-18.6-18.8-49-19-67.8-.4s-19 49-.4 67.8l255.4 258.6c67.8 68.6 67.8 178.8.0 247.4L653.4 878.2c-18.6 18.8-18.4 49.2.4 67.8s49.2 18.4 67.8-.4l224-226.4c104.8-106 104.8-276.4.0-382.4L690 78.2zM485.4 101.4c-24-24-56.6-37.4-90.6-37.4H96C43 64 0 107 0 160v299c0 34 13.4 66.6 37.4 90.6l336 336c50 50 131 50 181 0l267-267c50-50 50-131 0-181l-336-336zM96 160h299c8.4.0 16.6 3.4 22.6 9.4l336 336c12.4 12.4 12.4 32.8.0 45.2l-267 267c-12.4 12.4-32.8 12.4-45.2.0l-336-336c-6-6-9.4-14.2-9.4-22.6V160zm192 128a64 64 0 10-128 0 64 64 0 10128 0z" p-id="6660"/></svg></span><ul class=pe-post-meta-item><a href=https://www.oomkill.com/tags/kubernetes/>#Kubernetes</a></ul></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details><summary><span class=details>目录</span></summary><div class=inner><ul><ul><li><a href=#%e8%ae%a4%e8%af%81 aria-label=认证>认证</a><li><a href=#%e6%8e%88%e6%9d%83 aria-label=授权>授权</a><li><a href=#%e5%87%86%e5%85%a5%e6%8e%a7%e5%88%b6 aria-label=准入控制>准入控制</a><li><a href=#%e7%94%a8%e6%88%b7%e8%b4%a6%e5%8f%b7 aria-label=用户账号>用户账号</a><li><a href=#%e7%bb%99pod%e5%a2%9e%e5%8a%a0%e8%87%aa%e5%ae%9a%e4%b9%89%e6%9c%8d%e5%8a%a1%e8%b4%a6%e5%8f%b7 aria-label=给Pod增加自定义服务账号。>给Pod增加自定义服务账号。</a></ul><li><a href=#reference aria-label=Reference>Reference</a></li></div></details></div></aside><script src=/js/pe-toc.min.445eb1bfc5e85dd13b9519fcc2a806522e9629b6224a2974052789ba00ab78af.js integrity="sha256-RF6xv8XoXdE7lRn8wqgGUi6WKbYiSil0BSeJugCreK8="></script><div class=post-content><p>在整个Kubernetes集群来讲 apiserver是访问控制的唯一入口。如通过service或ingress暴露之后，是可以不通过apiserver接入的，只需要通过节点的nodePort或者ingress controller daemonset共享宿主机节点网络名称空间监听的宿主机网络地址（节点地址），直接接入。</p><p>当请求到达APIServer时，会经历几个阶段，如图所示</p><p><div class=pe-fancybox><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/image-20221025003822017.png><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/image-20221025003822017.png#center alt=image-20221025003822017 onerror='this.onerror=null,this.src="/placeholder.svg",this.className="pe-image-placeholder"'></a></div></p><center>图：Kubernetes API 请求的请求处理步骤图</center><center><em>Source：</em>https://kubevious.io/blog/post/securing-kubernetes-using-pod-security-policy-admission-controller</center><p><strong>任何用户（sa与人类用户）在通过任何方式试图操作API资源时，必须要经历下列的操作</strong>：</p><ul><li><strong>Authentication</strong>，这个步骤在建立TLS连接后，验证包含，证书、密码，Token；可以指定多种认证，依次尝试每一个，直到其中一个认证成功。如果认证失败，此时客户端收到的是401。</li><li><strong>Authorization</strong>，此步骤是在完成 <em>Authentication</em> 后确定了来源用户，此时用户的请求动作必须被授权。如bob用户对pod资源有 <code>get</code> , <code>list</code> 权限操作。如果</li><li><strong>Admission Control</strong>：此步骤为图3，与 <em>Authorization</em> 不同的时，这里只要有任意准入控制器拒绝，则拒绝；多个准入控制器会按顺序执行</li></ul><p>Refer to <a href=https://kubernetes.io/docs/concepts/security/controlling-access/ target=_blank rel="noopener nofollow noreferrer">controlling access</a></p><h3 id=认证>认证<a hidden class=anchor aria-hidden=true href=#认证>#</a></h3><p>Kubernetes是高度模块化设计的，因此其认证授权与准入控制是各自都通过插件的方式，可由用户自定义选择经由什么样的插件来完成何种控制逻辑。如<strong>对称秘钥认证方式</strong>、<strong>令牌认证</strong>。由于Kubernetes提供的是resetful方式的接口，其服务都是通过HTTP协议提供的，因此认证信息只能经由HTTP协议的认证首部进行传递，此认证首部通常被称作认证令牌(token)。</p><p><strong>ssl认证</strong>，对于Kubernetes访问来讲，ssl证书能让客户端去确认服务器的身份，（要求服务端发送服务端证书，确认证书是否为认可的CA签署的。）在Kubernetes通信过程当中，重要的是服务器还需认证客户端的身份，因此==Kubectl也应有一个证书，并且此证书为server端所认可的CA所签署的证书==。并且客户端身份也要与证书当中标识的身份保持一致。双方需互相做双向证书认证。认证之后双方基于SSL会话实现加密通讯。</p><hr><p>注：kubernetes认证无需执行串行检查，用户经过任何一个认证插件通过后，即表示认证通过，无需再经由其他插件进行检查。</p><hr><h3 id=授权>授权<a hidden class=anchor aria-hidden=true href=#授权>#</a></h3><p>kubernetes的授权也支持多种授权插件来完成用户的权限检查，kubernetes 1.6之后开始支持基于RBAC的认证。除此只外还有基于节点的认证、webhook基于http回调机制，通过web的rest服务来实现认证的检查机制。最重要的是RBAC的授权检查机制。基于角色的访问控制，通常只有许可授权，没有拒绝授权。默认都是拒绝。</p><p>在默认情况下，使用kubeadm部署Kubernetes集群是强制启用了RBAC认证的。</p><h3 id=准入控制>准入控制<a hidden class=anchor aria-hidden=true href=#准入控制>#</a></h3><p>一般而言，准入控制本身只是用来定义对应授权检查完成之后的后续其他安全检查操作的。</p><h3 id=用户账号>用户账号<a hidden class=anchor aria-hidden=true href=#用户账号>#</a></h3><p>一般而言用户账号大体上应具有以下信息</p><ul><li><p><strong>user</strong> 用户，一般而言由<code>username</code>与<code>userid</code>组成。</p></li><li><p><strong>group</strong> 用户组</p></li><li><p><strong>extra</strong> 用来提供额外信息</p></li><li><p><strong>API资源</strong> k8sapiserver是分组的，向哪个组，哪个版本的哪个api资源对象发出请求必须进行标识，所有的请求资源通过url path进行标识的。如 <strong><code>/apis/apps/v1/</code></strong>，所有名称空间级别的资源在访问时一般都需指名namespaces关键词，并给出namespaces名称来获取 <strong><code>/apis/apps/v1/namespaces/default/</code></strong> <strong><code>/apis/apps/v1/namespaces/default/nginx</code></strong> 。</p><p>一个完整意义上的url 对象引用url格式 ==<code>/apis/&lt;GROUPS>/&lt;VERSION>/namespaces/&lt;NameSpace_name>/&lt;Kind>/[/object_id]</code>==</p></li></ul><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl api-versions
</span></span><span class=line><span class=cl>admissionregistration.k8s.io/v1beta1
</span></span><span class=line><span class=cl>...</span></span></code></pre></td></tr></table></div></div></div></div><p>Kubernetes中，所有的api都取决于一个根 <code>/apis</code></p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>text</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ curl -k --cert /etc/k8s/pki/apiserver-kubelet-client.crt --key /etc/k8s/pki/apiserver-kubelet-client.key  https://localhost:6443/apis/apps/v1/namespaces/typay/deployments/nginx-ingress-controller
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  &#34;kind&#34;: &#34;Deployment&#34;,
</span></span><span class=line><span class=cl>  &#34;apiVersion&#34;: &#34;apps/v1&#34;,
</span></span><span class=line><span class=cl>  &#34;metadata&#34;: {
</span></span><span class=line><span class=cl>    &#34;name&#34;: &#34;nginx-ingress-controller&#34;,
</span></span><span class=line><span class=cl>    &#34;namespace&#34;: &#34;houtu&#34;,
</span></span><span class=line><span class=cl>    &#34;selfLink&#34;: &#34;/apis/apps/v1/namespaces/houtu/deployments/nginx-ingress-controller&#34;,
</span></span><span class=line><span class=cl>    &#34;uid&#34;: &#34;dc8cbca7-fcab-49c5-a4f4-b44858bbf603&#34;,
</span></span><span class=line><span class=cl>    &#34;resourceVersion&#34;: &#34;225525&#34;,
</span></span><span class=line><span class=cl>    &#34;generation&#34;: 4,
</span></span><span class=line><span class=cl>    &#34;creationTimestamp&#34;: &#34;2019-11-21T12:47:33Z&#34;,
</span></span><span class=line><span class=cl>    &#34;labels&#34;: {
</span></span><span class=line><span class=cl>      &#34;k8s-app&#34;: &#34;nginx-ingress-controller&#34;
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>    &#34;annotations&#34;: {
</span></span><span class=line><span class=cl>      &#34;deployment.kubernetes.io/revision&#34;: &#34;4&#34;,
</span></span><span class=line><span class=cl>      &#34;kubectl.kubernetes.io/last-applied-configuration&#34;: &#34;{\&#34;apiVersion\&#34;:\&#34;extensions/v1beta1\&#34;,\&#34;kind\&#34;:\&#34;Deployment\&#34;,\&#34;metadata\&#34;:{\&#34;annotations\&#34;:{},\&#34;labels\&#34;:{\&#34;k8s-app\&#34;:\&#34;nginx-ingress-controller\&#34;},\&#34;name\&#34;:\&#34;nginx-ingress-controller\&#34;,\&#34;namespace\&#34;:\&#34;houtu\&#34;},\&#34;spec\&#34;:{\&#34;replicas\&#34;:1,\&#34;template\&#34;:{\&#34;metadata\&#34;:{\&#34;labels\&#34;:{\&#34;k8s-app\&#34;:\&#34;nginx-ingress-controller\&#34;}},\&#34;spec\&#34;:{\&#34;containers\&#34;:[{\&#34;args\&#34;:[\&#34;/nginx-ingress-controller\&#34;,\&#34;--default-backend-service=houtu/push-front\&#34;],\&#34;env\&#34;:[{\&#34;name\&#34;:\&#34;POD_NAME\&#34;,\&#34;valueFrom\&#34;:{\&#34;fieldRef\&#34;:{\&#34;fieldPath\&#34;:\&#34;metadata.name\&#34;}}},{\&#34;name\&#34;:\&#34;POD_NAMESPACE\&#34;,\&#34;valueFrom\&#34;:{\&#34;fieldRef\&#34;:{\&#34;fieldPath\&#34;:\&#34;metadata.namespace\&#34;}}}],\&#34;image\&#34;:\&#34;quay.io/kubernetes-ingress-controller/nginx-ingress-controller:0.26.1\&#34;,\&#34;livenessProbe\&#34;:{\&#34;httpGet\&#34;:{\&#34;path\&#34;:\&#34;/healthz\&#34;,\&#34;port\&#34;:10254,\&#34;scheme\&#34;:\&#34;HTTP\&#34;},\&#34;initialDelaySeconds\&#34;:10,\&#34;timeoutSeconds\&#34;:1},\&#34;name\&#34;:\&#34;nginx-ingress-controller\&#34;,\&#34;ports\&#34;:[{\&#34;containerPort\&#34;:80,\&#34;hostPort\&#34;:80},{\&#34;containerPort\&#34;:443,\&#34;hostPort\&#34;:443}],\&#34;readinessProbe\&#34;:{\&#34;httpGet\&#34;:{\&#34;path\&#34;:\&#34;/healthz\&#34;,\&#34;port\&#34;:10254,\&#34;scheme\&#34;:\&#34;HTTP\&#34;}}}],\&#34;hostNetwork\&#34;:true,\&#34;serviceAccountName\&#34;:\&#34;nginx-ingress-serviceaccount\&#34;,\&#34;terminationGracePeriodSeconds\&#34;:60}}}}\n&#34;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>  },
</span></span><span class=line><span class=cl>  &#34;spec&#34;: {
</span></span><span class=line><span class=cl>    &#34;replicas&#34;: 1,
</span></span><span class=line><span class=cl>    &#34;selector&#34;: {
</span></span><span class=line><span class=cl>      &#34;matchLabels&#34;: {
</span></span><span class=line><span class=cl>        &#34;k8s-app&#34;: &#34;nginx-ingress-controller&#34;
</span></span><span class=line><span class=cl>      }
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>    &#34;template&#34;: {
</span></span><span class=line><span class=cl>      &#34;metadata&#34;: {
</span></span><span class=line><span class=cl>        &#34;creationTimestamp&#34;: null,
</span></span><span class=line><span class=cl>        &#34;labels&#34;: {
</span></span><span class=line><span class=cl>          &#34;k8s-app&#34;: &#34;nginx-ingress-controller&#34;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>      },
</span></span><span class=line><span class=cl>      &#34;spec&#34;: {
</span></span><span class=line><span class=cl>        &#34;containers&#34;: [
</span></span><span class=line><span class=cl>          {
</span></span><span class=line><span class=cl>            &#34;name&#34;: &#34;nginx-ingress-controller&#34;,
</span></span><span class=line><span class=cl>            &#34;image&#34;: &#34;quay.io/kubernetes-ingress-controller/nginx-ingress-controller:0.26.1&#34;,
</span></span><span class=line><span class=cl>            &#34;args&#34;: [
</span></span><span class=line><span class=cl>              &#34;/nginx-ingress-controller&#34;,
</span></span><span class=line><span class=cl>              &#34;--default-backend-service=houtu/push-front&#34;
</span></span><span class=line><span class=cl>            ],
</span></span><span class=line><span class=cl>            &#34;ports&#34;: [
</span></span><span class=line><span class=cl>              {
</span></span><span class=line><span class=cl>                &#34;hostPort&#34;: 80,
</span></span><span class=line><span class=cl>                &#34;containerPort&#34;: 80,
</span></span><span class=line><span class=cl>                &#34;protocol&#34;: &#34;TCP&#34;
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>              {
</span></span><span class=line><span class=cl>                &#34;hostPort&#34;: 443,
</span></span><span class=line><span class=cl>                &#34;containerPort&#34;: 443,
</span></span><span class=line><span class=cl>                &#34;protocol&#34;: &#34;TCP&#34;
</span></span><span class=line><span class=cl>              }
</span></span><span class=line><span class=cl>            ],
</span></span><span class=line><span class=cl>            &#34;env&#34;: [
</span></span><span class=line><span class=cl>              {
</span></span><span class=line><span class=cl>                &#34;name&#34;: &#34;POD_NAME&#34;,
</span></span><span class=line><span class=cl>                &#34;valueFrom&#34;: {
</span></span><span class=line><span class=cl>                  &#34;fieldRef&#34;: {
</span></span><span class=line><span class=cl>                    &#34;apiVersion&#34;: &#34;v1&#34;,
</span></span><span class=line><span class=cl>                    &#34;fieldPath&#34;: &#34;metadata.name&#34;
</span></span><span class=line><span class=cl>                  }
</span></span><span class=line><span class=cl>                }
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>              {
</span></span><span class=line><span class=cl>                &#34;name&#34;: &#34;POD_NAMESPACE&#34;,
</span></span><span class=line><span class=cl>                &#34;valueFrom&#34;: {
</span></span><span class=line><span class=cl>                  &#34;fieldRef&#34;: {
</span></span><span class=line><span class=cl>                    &#34;apiVersion&#34;: &#34;v1&#34;,
</span></span><span class=line><span class=cl>                    &#34;fieldPath&#34;: &#34;metadata.namespace&#34;
</span></span><span class=line><span class=cl>                  }
</span></span><span class=line><span class=cl>                }
</span></span><span class=line><span class=cl>              }
</span></span><span class=line><span class=cl>            ],
</span></span><span class=line><span class=cl>            &#34;resources&#34;: {
</span></span><span class=line><span class=cl>              
</span></span><span class=line><span class=cl>            },
</span></span><span class=line><span class=cl>            &#34;livenessProbe&#34;: {
</span></span><span class=line><span class=cl>              &#34;httpGet&#34;: {
</span></span><span class=line><span class=cl>                &#34;path&#34;: &#34;/healthz&#34;,
</span></span><span class=line><span class=cl>                &#34;port&#34;: 10254,
</span></span><span class=line><span class=cl>                &#34;scheme&#34;: &#34;HTTP&#34;
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>              &#34;initialDelaySeconds&#34;: 10,
</span></span><span class=line><span class=cl>              &#34;timeoutSeconds&#34;: 1,
</span></span><span class=line><span class=cl>              &#34;periodSeconds&#34;: 10,
</span></span><span class=line><span class=cl>              &#34;successThreshold&#34;: 1,
</span></span><span class=line><span class=cl>              &#34;failureThreshold&#34;: 3
</span></span><span class=line><span class=cl>            },
</span></span><span class=line><span class=cl>            &#34;readinessProbe&#34;: {
</span></span><span class=line><span class=cl>              &#34;httpGet&#34;: {
</span></span><span class=line><span class=cl>                &#34;path&#34;: &#34;/healthz&#34;,
</span></span><span class=line><span class=cl>                &#34;port&#34;: 10254,
</span></span><span class=line><span class=cl>                &#34;scheme&#34;: &#34;HTTP&#34;
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>              &#34;timeoutSeconds&#34;: 1,
</span></span><span class=line><span class=cl>              &#34;periodSeconds&#34;: 10,
</span></span><span class=line><span class=cl>              &#34;successThreshold&#34;: 1,
</span></span><span class=line><span class=cl>              &#34;failureThreshold&#34;: 3
</span></span><span class=line><span class=cl>            },
</span></span><span class=line><span class=cl>            &#34;terminationMessagePath&#34;: &#34;/dev/termination-log&#34;,
</span></span><span class=line><span class=cl>            &#34;terminationMessagePolicy&#34;: &#34;File&#34;,
</span></span><span class=line><span class=cl>            &#34;imagePullPolicy&#34;: &#34;IfNotPresent&#34;
</span></span><span class=line><span class=cl>          }
</span></span><span class=line><span class=cl>        ],
</span></span><span class=line><span class=cl>        &#34;restartPolicy&#34;: &#34;Always&#34;,
</span></span><span class=line><span class=cl>        &#34;terminationGracePeriodSeconds&#34;: 60,
</span></span><span class=line><span class=cl>        &#34;dnsPolicy&#34;: &#34;ClusterFirst&#34;,
</span></span><span class=line><span class=cl>        &#34;serviceAccountName&#34;: &#34;nginx-ingress-serviceaccount&#34;,
</span></span><span class=line><span class=cl>        &#34;serviceAccount&#34;: &#34;nginx-ingress-serviceaccount&#34;,
</span></span><span class=line><span class=cl>        &#34;hostNetwork&#34;: true,
</span></span><span class=line><span class=cl>        &#34;securityContext&#34;: {
</span></span><span class=line><span class=cl>          
</span></span><span class=line><span class=cl>        },
</span></span><span class=line><span class=cl>        &#34;schedulerName&#34;: &#34;default-scheduler&#34;
</span></span><span class=line><span class=cl>      }
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>    &#34;strategy&#34;: {
</span></span><span class=line><span class=cl>      &#34;type&#34;: &#34;RollingUpdate&#34;,
</span></span><span class=line><span class=cl>      &#34;rollingUpdate&#34;: {
</span></span><span class=line><span class=cl>        &#34;maxUnavailable&#34;: 1,
</span></span><span class=line><span class=cl>        &#34;maxSurge&#34;: 1
</span></span><span class=line><span class=cl>      }
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>    &#34;revisionHistoryLimit&#34;: 2147483647,
</span></span><span class=line><span class=cl>    &#34;progressDeadlineSeconds&#34;: 2147483647
</span></span><span class=line><span class=cl>  },
</span></span><span class=line><span class=cl>  &#34;status&#34;: {
</span></span><span class=line><span class=cl>    &#34;observedGeneration&#34;: 4,
</span></span><span class=line><span class=cl>    &#34;replicas&#34;: 1,
</span></span><span class=line><span class=cl>    &#34;updatedReplicas&#34;: 1,
</span></span><span class=line><span class=cl>    &#34;unavailableReplicas&#34;: 1,
</span></span><span class=line><span class=cl>    &#34;conditions&#34;: [
</span></span><span class=line><span class=cl>      {
</span></span><span class=line><span class=cl>        &#34;type&#34;: &#34;Available&#34;,
</span></span><span class=line><span class=cl>        &#34;status&#34;: &#34;True&#34;,
</span></span><span class=line><span class=cl>        &#34;lastUpdateTime&#34;: &#34;2019-11-21T12:47:33Z&#34;,
</span></span><span class=line><span class=cl>        &#34;lastTransitionTime&#34;: &#34;2019-11-21T12:47:33Z&#34;,
</span></span><span class=line><span class=cl>        &#34;reason&#34;: &#34;MinimumReplicasAvailable&#34;,
</span></span><span class=line><span class=cl>        &#34;message&#34;: &#34;Deployment has minimum availability.&#34;
</span></span><span class=line><span class=cl>      }
</span></span><span class=line><span class=cl>    ]
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div></div><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ curl -k --cert /etc/k8s/pki/apiserver-kubelet-client.crt --key /etc/k8s/pki/apiserver-kubelet-client.key  https://localhost:6443/api/v1/namespaces/houtu
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;kind&#34;</span>: <span class=s2>&#34;Namespace&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;apiVersion&#34;</span>: <span class=s2>&#34;v1&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;metadata&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;name&#34;</span>: <span class=s2>&#34;houtu&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;selfLink&#34;</span>: <span class=s2>&#34;/api/v1/namespaces/houtu&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;uid&#34;</span>: <span class=s2>&#34;da736612-d112-4e38-8546-0f2b9169b92f&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;resourceVersion&#34;</span>: <span class=s2>&#34;201510&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;creationTimestamp&#34;</span>: <span class=s2>&#34;2019-11-21T08:33:38Z&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;spec&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;finalizers&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;kubernetes&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;status&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;phase&#34;</span>: <span class=s2>&#34;Active&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></td></tr></table></div></div></div></div><p>删除操作</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>text</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ curl X DELETE -k --cert /etc/k8s/pki/apiserver-kubelet-client.crt --key /etc/k8s/pki/apiserver-kubelet-client.key  https://localhost:6443/apis/apps/v1/namespaces/default/deployments/nginx-test/
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  &#34;kind&#34;: &#34;Status&#34;,
</span></span><span class=line><span class=cl>  &#34;apiVersion&#34;: &#34;v1&#34;,
</span></span><span class=line><span class=cl>  &#34;metadata&#34;: {
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>  },
</span></span><span class=line><span class=cl>  &#34;status&#34;: &#34;Success&#34;,
</span></span><span class=line><span class=cl>  &#34;details&#34;: {
</span></span><span class=line><span class=cl>    &#34;name&#34;: &#34;nginx-test&#34;,
</span></span><span class=line><span class=cl>    &#34;group&#34;: &#34;apps&#34;,
</span></span><span class=line><span class=cl>    &#34;kind&#34;: &#34;deployments&#34;,
</span></span><span class=line><span class=cl>    &#34;uid&#34;: &#34;12c5184c-82bc-4f7d-8ec8-38a2439983cf&#34;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ kubectl get deploy
</span></span><span class=line><span class=cl>No resources found.</span></span></code></pre></td></tr></table></div></div></div></div><p>在Kubernetes之上，来自于那些地方的客户端需要和apiserver打交道</p><ul><li>集群外部客户端，通过apiserver对外通信的监听地址</li><li>集群之上的客户端，apiserver拥有一个在集群内工作地址，``kubectl get svc` 查看，kubernetes是将apiserver以service方式引入到集群内部，从而使得Pod直接请求集群上的apiserver的服务了。</li></ul><p>Pod在请求apiserver上的服务是通过10.96.0.1来进行的。但是apiserver请求是需要做认证的。首先apiserver将自己证书传递给客户端，客户端去校验服务端(apiserver)身份。 服务器发给每个Pod客户端的时候，证书所标明的身份的地址为10.96.0.1，所以在apiserver上手动创建证书，必须要确保证书持有者名称能够解析到两条IP记录才可以。</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>text</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ kubectl get svc
</span></span><span class=line><span class=cl>NAME         TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE
</span></span><span class=line><span class=cl>kubernetes   ClusterIP   10.96.0.1    &lt;none&gt;        443/TCP   47h
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ kubectl describe svc kubernetes
</span></span><span class=line><span class=cl>Name:              kubernetes
</span></span><span class=line><span class=cl>Namespace:         default
</span></span><span class=line><span class=cl>Labels:            component=apiserver
</span></span><span class=line><span class=cl>                   provider=kubernetes
</span></span><span class=line><span class=cl>Annotations:       &lt;none&gt;
</span></span><span class=line><span class=cl>Selector:          &lt;none&gt;
</span></span><span class=line><span class=cl>Type:              ClusterIP
</span></span><span class=line><span class=cl>IP:                10.96.0.1
</span></span><span class=line><span class=cl>Port:              https  443/TCP
</span></span><span class=line><span class=cl>TargetPort:        6443/TCP
</span></span><span class=line><span class=cl>Endpoints:         172.31.71.50:6443
</span></span><span class=line><span class=cl>Session Affinity:  None
</span></span><span class=line><span class=cl>Events:            &lt;none&gt;</span></span></code></pre></td></tr></table></div></div></div></div><p>类型分类</p><ul><li>对象类 deployment、namespace都属于对象类。</li><li>同一类型下的所有对象的集合在reset风格API下叫集合，在Kubernetes中被称之为列表（list）。</li><li>xx</li></ul><p>Kubernetes api账户有两类，真实的账户（人用的账户）userAccount与==Pod客户端serviceAccount==（Pod连接apiserver使用的账户）。</p><p>每个Pod无论你定义与否，都会挂载一个存储卷，这就是Podservice认证时的认证信息，通过secret定义存储卷的方式关联到Pod上，从而使Pod内运行的应用，通次secret保存的认证信息，来连接apiserver并完成认证。</p><p>在每一个名称空间当中都存在一个默认的secret，<code>default-token-xxx</code>，这是让当前名称空间当中所有的Pod资源试图去连接apiserver时，隐藏的、预制的一个认证信息。所以所有的Pod都能直接连接apiserver。此secret所包含的认证信息仅仅是获取当前Pod自身的属性。</p><h3 id=给pod增加自定义服务账号>给Pod增加自定义服务账号。<a hidden class=anchor aria-hidden=true href=#给pod增加自定义服务账号>#</a></h3><p>serviceAccount也属于标准的Kubernetes资源，可以自行创建serviceAccount，由自定义Pod使用serviceAccountName去加载自定义serviceAccount。serviceAccount是一个可以使用命令行创建的简单资源对象，可以使用<code>kubectl create serviceaccount</code>，创建也可以使用资源清单进行创建。</p><p>语法</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>text</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl create serviceaccount {Name} -o yaml --dry-run</span></span></code></pre></td></tr></table></div></div></div></div><p><strong>serveraccount本身不具备权限，可以使用rbac对serviceaccount授予权限</strong></p><p>创建完之后会自动生成一个token信息，用于让sa连接至当前系统认证的信息。注：认证不代表权限，可以登录、认证到Kubernetes但是做不了其余事情。所有的的操作权限靠授权实现的。</p><p>在创建Pod中使用自定义的sa</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>yaml</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>serviceAccountName</span><span class=p>:</span><span class=w> </span><span class=l>admin</span></span></span></code></pre></td></tr></table></div></div></div></div><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>text</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Volumes:
</span></span><span class=line><span class=cl>  default-token-4pj85:
</span></span><span class=line><span class=cl>    Type:        Secret (a volume populated by a Secret)
</span></span><span class=line><span class=cl>    SecretName:  default-token-4pj85
</span></span><span class=line><span class=cl>    Optional:    false
</span></span><span class=line><span class=cl>QoS Class:       BestEffort
</span></span><span class=line><span class=cl>Node-Selectors:  &lt;none&gt;</span></span></code></pre></td></tr></table></div></div></div></div><p>在定义好secret后，在定义Pod时，使用 <code>imagePullSecrets</code> 指明用哪个secret对象，secret对象中包含了认证私有regsi的账号和密码。</p><p>在Pod当中也可以不使用imagePullSecrets来告诉Pod如何去下载镜像文件。而可以直接使用serviceAccountName。serviceAccountName相当于指定一个sa账号，而sa账号是可以附带认证到私有regsiry的secret信息的。Pod通过sa的<code>Image pull secrets</code>也能完成资源镜像下载时的认证。这样就不会在Pod资源清单中泄露出去secret使用的什么信息。</p><p>使用kubectl describe sa admin</p><blockquote><p><strong>Pod获取私有镜像时的两种认证方式</strong></p></blockquote><ul><li>在Pod上直接使用<code>imagePullSecrets</code>字段指定认证使用的secret对象。</li><li>在Pod自定义serviceAccount，在serviceAccount附加此Pod获取镜像认证时使用的secret对象。</li></ul><h2 id=reference>Reference<a hidden class=anchor aria-hidden=true href=#reference>#</a></h2><blockquote><p><a href=https://kubernetes.io/docs/concepts/security/controlling-access/ target=_blank rel="noopener nofollow noreferrer">controlling access</a></p></blockquote></div><div class=pe-copyright><hr><blockquote><p>本文为原创内容，版权归作者所有。如需转载，请在文章中声明本文标题及链接。</p><p>文章标题：kubernetes概念 - serviceaccount</p><p>文章链接：<a href=https://www.oomkill.com/2018/09/kubernetes-serviceaccount/ target=_blank>https://www.oomkill.com/2018/09/kubernetes-serviceaccount/</a></p><p>许可协议：<a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></p></blockquote></div><div class=comments-separator></div><h3 class=relatedContentTitle>相关阅读</h3><ul class=relatedContent><li><a href=/2018/09/k8s-dashboard/><span>kubernetes概念 - Dashboard</span></a></li><li><a href=/2018/09/kubenetes-deployment/><span>kubernetes概念 - Kubenetes Deployment</span></a></li><li><a href=/2018/09/kubernetes-pod-controller/><span>kubernetes概念 - Kubernetes Pod控制器</span></a></li><li><a href=/2018/09/kubernetes-service/><span>kubernetes概念 - Service</span></a></li><li><a href=/2018/09/k8s-cm/><span>kubernetes概念 - configMap</span></a></li></ul><div class=comments-separator></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.oomkill.com/tags/kubernetes/>Kubernetes</a></li></ul><nav class=paginav><a class=prev href=https://www.oomkill.com/2018/09/kubernetes-service/><span class=title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left" style="user-select:text"><line x1="19" y1="12" x2="5" y2="12" style="user-select:text"/><polyline points="12 19 5 12 12 5" style="user-select:text"/></polyline></svg>&nbsp;</span>
<span>kubernetes概念 - Service</span>
</a><a class=next href=https://www.oomkill.com/2018/09/rpm-package/><span class=title></span>
<span>Unix归档模式 cpio - 深入剖析与构建rpm包&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select:text"><line x1="5" y1="12" x2="19" y2="12" style="user-select:text"/><polyline points="12 5 19 12 12 19" style="user-select:text"/></svg></span></a></nav></footer><div class=pe-comments-decoration><p class=pe-comments-title></p><p class=pe-comments-subtitle></p></div><div id=pe-comments></div><script src=/js/pe-go-comment.min.86a214102576ba5f9b7bdc29eed8d58dd56e34aef80b3c65c73ea9cc88443696.js integrity="sha256-hqIUECV2ul+be9wp7tjVjdVuNK74Czxlxz6pzIhENpY="></script><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const s={src:"https://giscus.app/client.js","data-repo":"cylonchau/cylonchau.github.io","data-repo-id":"R_kgDOIRlNSQ","data-category":"Announcements","data-category-id":"DIC_kwDOIRlNSc4CXy1U","data-mapping":"pathname","data-term":"posts/Kubernetes serviceaccount","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":getStoredTheme(),"data-lang":"zh-TW","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(s).forEach(([t,n])=>e.setAttribute(t,n)),document.querySelector("#pe-comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme);const n=document.querySelector("#theme-toggle-float");n&&n.addEventListener("click",setGiscusTheme)})</script></article></main><footer class=footer><span>&copy; 2024 <a href=https://www.oomkill.com/>Cylon's Collection</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> on
<a href=https://pages.github.com/ rel=noopener target=_blank>GitHub Pages</a> & Theme
        <a href=https://github.com/tofuwine/PaperMod-PE rel=noopener target=_blank>PaperMod-PE</a></span></footer><div class=pe-right-sidebar><a href=javascript:void(0); id=theme-toggle-float class=pe-float-btn><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</a><a href=#top class=pe-float-btn id=top-link><span id=pe-read-progress></span></a></div><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>