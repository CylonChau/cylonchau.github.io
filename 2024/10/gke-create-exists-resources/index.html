<!doctype html><html lang=zh dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>使用terraform利用已有资源创建GKE集群 | Cylon's Collection</title><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NP3JNCPR" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><meta name=keywords content="GKE集群,terraform"><meta name=description content='近日创建GKE集群，需要使用现有的VPC进行创建，所以需要掌握两个步骤，导入资源，创建集群
terraform 导入命令 GCP中的资源地址和 ID。资源地址是指向配置中的资源实例的标识符。ID 是标识 Google Cloud 中要导入的资源的标识符
资源地址通常为 terraform在定义这类资源时配置的（对应提供商支持），以 GCP 为例 Cloud Storage 存储桶， google_storage_bucket.sample，sample 为 id，定义如下
yaml 1 2 3 4 5 6 resource "google_storage_bucket" "sample" { name = "my-bucket" project = "sample-project" location = "US" force_destroy = true } 示例 - 导入现有GKE集群 语法
bash 1 terraform import <resource_name>.<name> <project>/<locations>/<real_resource_name> 实例
bash 1 terraform import google_container_cluster.gke project20231124/asia-east2/gke-prd-cluster-02 输出结果如下
bash 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 $ terraform import google_container_cluster.'><meta name=author content="cylon"><link rel=canonical href=http://localhost:1313/2024/10/gke-create-exists-resources/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/favicon.ico><link rel=mask-icon href=http://localhost:1313/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=http://localhost:1313/2024/10/gke-create-exists-resources/><noscript><style>#theme-toggle,#top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link crossorigin=anonymous href=/assets/css/pe.min.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/pe.min.js></script><link rel=stylesheet href=https://cdn.staticfile.net/font-awesome/6.5.1/css/all.min.css><link rel=stylesheet href=https://cdn.staticfile.net/font-awesome/6.5.1/css/v4-shims.min.css><script id=MathJax-script async src=https://cdn.staticfile.net/mathjax/3.2.2/es5/tex-chtml.js></script><script>MathJax={tex:{displayMath:[["$$","$$"]],inlineMath:[["\\$","\\$"]]}}</script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><meta name=referrer content="no-referrer-when-downgrade"><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-NP3JNCPR")</script><meta property="og:title" content="使用terraform利用已有资源创建GKE集群"><meta property="og:description" content='近日创建GKE集群，需要使用现有的VPC进行创建，所以需要掌握两个步骤，导入资源，创建集群
terraform 导入命令 GCP中的资源地址和 ID。资源地址是指向配置中的资源实例的标识符。ID 是标识 Google Cloud 中要导入的资源的标识符
资源地址通常为 terraform在定义这类资源时配置的（对应提供商支持），以 GCP 为例 Cloud Storage 存储桶， google_storage_bucket.sample，sample 为 id，定义如下
yaml 1 2 3 4 5 6 resource "google_storage_bucket" "sample" { name = "my-bucket" project = "sample-project" location = "US" force_destroy = true } 示例 - 导入现有GKE集群 语法
bash 1 terraform import <resource_name>.<name> <project>/<locations>/<real_resource_name> 实例
bash 1 terraform import google_container_cluster.gke project20231124/asia-east2/gke-prd-cluster-02 输出结果如下
bash 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 $ terraform import google_container_cluster.'><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/2024/10/gke-create-exists-resources/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-10-02T00:00:00+00:00"><meta property="article:modified_time" content="2024-10-02T23:00:36+08:00"><meta property="og:site_name" content="Cylon's Collection"><meta name=twitter:card content="summary"><meta name=twitter:title content="使用terraform利用已有资源创建GKE集群"><meta name=twitter:description content='近日创建GKE集群，需要使用现有的VPC进行创建，所以需要掌握两个步骤，导入资源，创建集群
terraform 导入命令 GCP中的资源地址和 ID。资源地址是指向配置中的资源实例的标识符。ID 是标识 Google Cloud 中要导入的资源的标识符
资源地址通常为 terraform在定义这类资源时配置的（对应提供商支持），以 GCP 为例 Cloud Storage 存储桶， google_storage_bucket.sample，sample 为 id，定义如下
yaml 1 2 3 4 5 6 resource "google_storage_bucket" "sample" { name = "my-bucket" project = "sample-project" location = "US" force_destroy = true } 示例 - 导入现有GKE集群 语法
bash 1 terraform import <resource_name>.<name> <project>/<locations>/<real_resource_name> 实例
bash 1 terraform import google_container_cluster.gke project20231124/asia-east2/gke-prd-cluster-02 输出结果如下
bash 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 $ terraform import google_container_cluster.'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"使用terraform利用已有资源创建GKE集群","item":"http://localhost:1313/2024/10/gke-create-exists-resources/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"使用terraform利用已有资源创建GKE集群","name":"使用terraform利用已有资源创建GKE集群","description":"近日创建GKE集群，需要使用现有的VPC进行创建，所以需要掌握两个步骤，导入资源，创建集群\nterraform 导入命令 GCP中的资源地址和 ID。资源地址是指向配置中的资源实例的标识符。ID 是标识 Google Cloud 中要导入的资源的标识符\n资源地址通常为 terraform在定义这类资源时配置的（对应提供商支持），以 GCP 为例 Cloud Storage 存储桶， google_storage_bucket.sample，sample 为 id，定义如下\nyaml 1 2 3 4 5 6 resource \u0026#34;google_storage_bucket\u0026#34; \u0026#34;sample\u0026#34; { name = \u0026#34;my-bucket\u0026#34; project = \u0026#34;sample-project\u0026#34; location = \u0026#34;US\u0026#34; force_destroy = true } 示例 - 导入现有GKE集群 语法\nbash 1 terraform import \u0026lt;resource_name\u0026gt;.\u0026lt;name\u0026gt; \u0026lt;project\u0026gt;/\u0026lt;locations\u0026gt;/\u0026lt;real_resource_name\u0026gt; 实例\nbash 1 terraform import google_container_cluster.gke project20231124/asia-east2/gke-prd-cluster-02 输出结果如下\nbash 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 $ terraform import google_container_cluster.","keywords":["GKE集群","terraform"],"articleBody":"近日创建GKE集群，需要使用现有的VPC进行创建，所以需要掌握两个步骤，导入资源，创建集群\nterraform 导入命令 GCP中的资源地址和 ID。资源地址是指向配置中的资源实例的标识符。ID 是标识 Google Cloud 中要导入的资源的标识符\n资源地址通常为 terraform在定义这类资源时配置的（对应提供商支持），以 GCP 为例 Cloud Storage 存储桶， google_storage_bucket.sample，sample 为 id，定义如下\nyaml 1 2 3 4 5 6 resource \"google_storage_bucket\" \"sample\" { name = \"my-bucket\" project = \"sample-project\" location = \"US\" force_destroy = true } 示例 - 导入现有GKE集群 语法\nbash 1 terraform import . // 实例\nbash 1 terraform import google_container_cluster.gke project20231124/asia-east2/gke-prd-cluster-02 输出结果如下\nbash 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 $ terraform import google_container_cluster.gke project20231124/asia-east2/gke-prd-cluster-02 data.google_compute_network.available: Reading... data.google_compute_zones.available: Reading... data.google_container_engine_versions.gke_version: Reading... data.google_container_engine_versions.gke_version: Read complete after 1s [id=2024-08-06 07:29:53.793630041 +0000 UTC] data.google_compute_zones.available: Read complete after 1s [id=projects/project20231124/regions/asia-east2] data.google_compute_network.available: Read complete after 2s [id=projects/project20231124/global/networks/gke-cluster-02-vpc-network] google_container_cluster.gke: Importing from ID \"project20231124/asia-east2/gke-prd-cluster-02\"... google_container_cluster.gke: Import prepared! Prepared google_container_cluster for import google_container_cluster.gke: Refreshing state... [id=projects/project20231124/locations/asia-east2/clusters/gke-prd-cluster-02] Import successful! The resources that were imported are shown above. These resources are now in your Terraform state and will henceforth be managed by Terraform. 导入GKE集群节点池 bash 1 2 3 4 5 6 7 8 9 10 11 12 $ terraform import google_container_node_pool.gcp-available-b project20231124/asia-east2/gke-prd-cluster-02 data.google_container_engine_versions.gke_version: Reading... data.google_compute_network.available: Reading... data.google_compute_zones.available: Reading... data.google_compute_zones.available: Read complete after 0s [id=projects/project20231124/regions/asia-east2] data.google_container_engine_versions.gke_version: Read complete after 0s [id=2024-08-06 07:51:46.183235726 +0000 UTC] data.google_compute_network.available: Read complete after 0s [id=projects/project20231124/global/networks/gke-cluster-02-vpc-network] Import successful! The resources that were imported are shown above. These resources are now in your Terraform state and will henceforth be managed by Terraform. 节点池这类资源地址不能查看，只能通过上一级 google_container_cluster 去查看\nbash 1 2 3 4 5 6 $ terraform state show -state=./terraform.tfstate google_container_node_pool.gcp-available-b No instance found for the given address! This command requires that the address references one specific instance. To view the available instances, use \"terraform state list\". Please modify the address to reference a specific instance. 资源地址必须在 terraform state list 中才可以使用 terraform state show 去查看\nbash 1 2 3 4 5 6 7 $ terraform state list data.google_compute_network.available data.google_compute_zones.available data.google_container_engine_versions.gke_version google_compute_subnetwork.vpc-subnet google_container_cluster.gke 导入 VPC bash 1 2 3 4 5 6 7 8 9 10 11 12 13 $ terraform import google_compute_network.vpc-network /project20231124/asia-east2/gke-cluster-02-vpc-network data.google_compute_zones.available: Reading... data.google_compute_network.available: Reading... data.google_container_engine_versions.gke_version: Reading... data.google_container_engine_versions.gke_version: Read complete after 0s [id=2024-08-06 07:41:30.318550432 +0000 UTC] data.google_compute_network.available: Read complete after 0s [id=projects/project20231124/global/networks/gke-cluster-02-vpc-network] data.google_compute_zones.available: Read complete after 0s [id=projects/project20231124/regions/asia-east2] Import successful! The resources that were imported are shown above. These resources are now in your Terraform state and will henceforth be managed by Terraform. 导入VPC子网 语法\nbash 1 terraform import . // 示例\nbash 1 terraform import google_compute_subnetwork.vpc-subnet project20231124/asia-east2/gke-cluster-02-vpc-network 输出\nbash 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 terraform import google_compute_subnetwork.vpc-subnet project20231124/asia-east2/gke-cluster-02-vpc-network data.google_compute_zones.available: Reading... data.google_container_engine_versions.gke_version: Reading... data.google_compute_network.available: Reading... data.google_compute_zones.available: Read complete after 0s [id=projects/project20231124/regions/asia-east2] data.google_container_engine_versions.gke_version: Read complete after 0s [id=2024-08-06 03:43:01.406680586 +0000 UTC] data.google_compute_network.available: Read complete after 1s [id=projects/project20231124/global/networks/gke-cluster-02-vpc-network] google_compute_subnetwork.vpc-subnet: Importing from ID \"project20231124/asia-east2/gke-cluster-02-vpc-network\"... google_compute_subnetwork.vpc-subnet: Import prepared! Prepared google_compute_subnetwork for import google_compute_subnetwork.vpc-subnet: Refreshing state... [id=projects/project20231124/regions/asia-east2/subnetworks/gke-cluster-02-vpc-network] Import successful! The resources that were imported are shown above. These resources are now in your Terraform state and will henceforth be managed by Terraform. 最后查看导入后的资源 bash 1 2 3 4 5 6 7 $ terraform state list data.google_compute_network.available data.google_compute_zones.available data.google_container_engine_versions.gke_version google_compute_subnetwork.vpc-subnet google_container_cluster.gke terraform 查看本地state文件资源 terraform state list 查看本地state文件资源\n语法\nbash 1 2 #读取 state 或 plan file，不指定 [path] 则output当前文件夹下 terraform show [options] [path] 查看某个资源路径的信息 例如查看 VPC 子网\n语法\nbash 1 terraform [global options] state show [options] ADDRESS 示例\nbash 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 # terraform state show -state=./terraform.tfstate google_compute_subnetwork.vpc-subnet # google_compute_subnetwork.vpc-subnet: resource \"google_compute_subnetwork\" \"vpc-subnet\" { creation_timestamp = \"2022-06-25T01:51:49.868-07:00\" description = \"public prod service network\" gateway_address = \"192.233.10.1\" id = \"projects/project20231124/regions/asia-east2/subnetworks/gke-cluster-02-vpc-network\" ip_cidr_range = \"192.233.10.0/24\" name = \"gke-cluster-02-vpc-network\" network = \"https://www.googleapis.com/compute/v1/projects/project20231124/global/networks/gke-cluster-02-vpc-network\" private_ip_google_access = true private_ipv6_google_access = \"DISABLE_GOOGLE_ACCESS\" project = \"project20231124\" purpose = \"PRIVATE\" region = \"asia-east2\" secondary_ip_range = [ { ip_cidr_range = \"10.126.0.0/22\" range_name = \"gke-gke-prd-cluster-02-services-621a7058\" }, { ip_cidr_range = \"10.116.0.0/16\" range_name = \"gke-gke-prd-cluster-02-pods-621a7058\" }, ] self_link = \"https://www.googleapis.com/compute/v1/projects/project20231124/regions/asia-east2/subnetworks/gke-cluster-02-vpc-network\" stack_type = \"IPV4_ONLY\" timeouts {} } ","wordCount":"643","inLanguage":"zh","datePublished":"2024-10-02T00:00:00Z","dateModified":"2024-10-02T23:00:36+08:00","author":{"@type":"Person","name":"cylon"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/2024/10/gke-create-exists-resources/"},"publisher":{"@type":"Organization","name":"Cylon's Collection","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/><img src=http://localhost:1313/favicon.ico alt aria-label=logo height=20>Cylon's Collection</a><div class=logo-switches><button id=theme-toggle><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/archives><span>归档</span></a></li><li><a href=http://localhost:1313/tags><span>标签</span></a></li><li><a href=http://localhost:1313/search><span>搜索</span></a></li><li><a href=http://localhost:1313/about accesskey=/><span>关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">使用terraform利用已有资源创建GKE集群</h1><div class=post-meta><span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg><span>2024-10-02</span></span>&nbsp;·&nbsp;<span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select:text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z" style="user-select:text"/><polyline points="14 2 14 8 20 8" style="user-select:text"/><line x1="16" y1="13" x2="8" y2="13" style="user-select:text"/><line x1="16" y1="17" x2="8" y2="17" style="user-select:text"/><polyline points="10 9 9 9 8 9" style="user-select:text"/></svg><span>643 字</span></span>&nbsp;·&nbsp;<span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><span>4 分钟</span></span>
<span class=pe-post-meta-item>&nbsp;·&nbsp;<svg t="1714036239378" fill="currentcolor" class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="6659" width="256" height="256"><path d="M690 78.2c-18.6-18.8-49-19-67.8-.4s-19 49-.4 67.8l255.4 258.6c67.8 68.6 67.8 178.8.0 247.4L653.4 878.2c-18.6 18.8-18.4 49.2.4 67.8s49.2 18.4 67.8-.4l224-226.4c104.8-106 104.8-276.4.0-382.4L690 78.2zM485.4 101.4c-24-24-56.6-37.4-90.6-37.4H96C43 64 0 107 0 160v299c0 34 13.4 66.6 37.4 90.6l336 336c50 50 131 50 181 0l267-267c50-50 50-131 0-181l-336-336zM96 160h299c8.4.0 16.6 3.4 22.6 9.4l336 336c12.4 12.4 12.4 32.8.0 45.2l-267 267c-12.4 12.4-32.8 12.4-45.2.0l-336-336c-6-6-9.4-14.2-9.4-22.6V160zm192 128a64 64 0 10-128 0 64 64 0 10128 0z" p-id="6660"/></svg></span><ul class=pe-post-meta-item><a href=http://localhost:1313/tags/public-cloud/>#Public Cloud</a></ul></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details><summary><span class=details>目录</span></summary><div class=inner><ul><li><a href=#terraform-%e5%af%bc%e5%85%a5%e5%91%bd%e4%bb%a4 aria-label="terraform 导入命令">terraform 导入命令</a><ul><li><a href=#%e7%a4%ba%e4%be%8b---%e5%af%bc%e5%85%a5%e7%8e%b0%e6%9c%89gke%e9%9b%86%e7%be%a4 aria-label="示例 - 导入现有GKE集群">示例 - 导入现有GKE集群</a><li><a href=#%e5%af%bc%e5%85%a5gke%e9%9b%86%e7%be%a4%e8%8a%82%e7%82%b9%e6%b1%a0 aria-label=导入GKE集群节点池>导入GKE集群节点池</a><li><a href=#%e5%af%bc%e5%85%a5-vpc aria-label="导入 VPC">导入 VPC</a><li><a href=#%e5%af%bc%e5%85%a5vpc%e5%ad%90%e7%bd%91 aria-label=导入VPC子网>导入VPC子网</a><li><a href=#%e6%9c%80%e5%90%8e%e6%9f%a5%e7%9c%8b%e5%af%bc%e5%85%a5%e5%90%8e%e7%9a%84%e8%b5%84%e6%ba%90 aria-label=最后查看导入后的资源>最后查看导入后的资源</a></ul><li><a href=#terraform-%e6%9f%a5%e7%9c%8b%e6%9c%ac%e5%9c%b0state%e6%96%87%e4%bb%b6%e8%b5%84%e6%ba%90 aria-label="terraform 查看本地state文件资源">terraform 查看本地state文件资源</a><ul><li><a href=#%e6%9f%a5%e7%9c%8b%e6%9f%90%e4%b8%aa%e8%b5%84%e6%ba%90%e8%b7%af%e5%be%84%e7%9a%84%e4%bf%a1%e6%81%af aria-label=查看某个资源路径的信息>查看某个资源路径的信息</a></li></div></details></div></aside><script src=/js/pe-toc.min.445eb1bfc5e85dd13b9519fcc2a806522e9629b6224a2974052789ba00ab78af.js integrity="sha256-RF6xv8XoXdE7lRn8wqgGUi6WKbYiSil0BSeJugCreK8="></script><div class=post-content><p>近日创建GKE集群，需要使用现有的VPC进行创建，所以需要掌握两个步骤，导入资源，创建集群</p><h2 id=terraform-导入命令>terraform 导入命令<a hidden class=anchor aria-hidden=true href=#terraform-导入命令>#</a></h2><p>GCP中的资源地址和 ID。<a href=https://developer.hashicorp.com/terraform/cli/state/resource-addressing target=_blank rel="noopener nofollow noreferrer">资源地址</a>是指向配置中的资源实例的标识符。ID 是标识 Google Cloud 中要导入的资源的标识符</p><p>资源地址通常为 terraform在定义这类资源时配置的（对应提供商支持），以 GCP 为例 Cloud Storage 存储桶， google_storage_bucket.sample，sample 为 id，定义如下</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>yaml</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>resource &#34;google_storage_bucket&#34; &#34;sample&#34; {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=l>name          = &#34;my-bucket&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=l>project       = &#34;sample-project&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=l>location      = &#34;US&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=l>force_destroy = true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>}</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=示例---导入现有gke集群>示例 - 导入现有GKE集群<a hidden class=anchor aria-hidden=true href=#示例---导入现有gke集群>#</a></h3><p>语法</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform import &lt;resource_name&gt;.&lt;name&gt; &lt;project&gt;/&lt;locations&gt;/&lt;real_resource_name&gt;</span></span></code></pre></td></tr></table></div></div></div></div><p>实例</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform import google_container_cluster.gke project20231124/asia-east2/gke-prd-cluster-02</span></span></code></pre></td></tr></table></div></div></div></div><p>输出结果如下</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ terraform import google_container_cluster.gke project20231124/asia-east2/gke-prd-cluster-02
</span></span><span class=line><span class=cl>data.google_compute_network.available: Reading...
</span></span><span class=line><span class=cl>data.google_compute_zones.available: Reading...
</span></span><span class=line><span class=cl>data.google_container_engine_versions.gke_version: Reading...
</span></span><span class=line><span class=cl>data.google_container_engine_versions.gke_version: Read <span class=nb>complete</span> after 1s <span class=o>[</span><span class=nv>id</span><span class=o>=</span>2024-08-06 07:29:53.793630041 +0000 UTC<span class=o>]</span>
</span></span><span class=line><span class=cl>data.google_compute_zones.available: Read <span class=nb>complete</span> after 1s <span class=o>[</span><span class=nv>id</span><span class=o>=</span>projects/project20231124/regions/asia-east2<span class=o>]</span>
</span></span><span class=line><span class=cl>data.google_compute_network.available: Read <span class=nb>complete</span> after 2s <span class=o>[</span><span class=nv>id</span><span class=o>=</span>projects/project20231124/global/networks/gke-cluster-02-vpc-network<span class=o>]</span>
</span></span><span class=line><span class=cl>google_container_cluster.gke: Importing from ID <span class=s2>&#34;project20231124/asia-east2/gke-prd-cluster-02&#34;</span>...
</span></span><span class=line><span class=cl>google_container_cluster.gke: Import prepared!
</span></span><span class=line><span class=cl>  Prepared google_container_cluster <span class=k>for</span> import
</span></span><span class=line><span class=cl>google_container_cluster.gke: Refreshing state... <span class=o>[</span><span class=nv>id</span><span class=o>=</span>projects/project20231124/locations/asia-east2/clusters/gke-prd-cluster-02<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Import successful!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The resources that were imported are shown above. These resources are now in
</span></span><span class=line><span class=cl>your Terraform state and will henceforth be managed by Terraform.</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=导入gke集群节点池>导入GKE集群节点池<a hidden class=anchor aria-hidden=true href=#导入gke集群节点池>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ terraform import google_container_node_pool.gcp-available-b project20231124/asia-east2/gke-prd-cluster-02
</span></span><span class=line><span class=cl>data.google_container_engine_versions.gke_version: Reading...
</span></span><span class=line><span class=cl>data.google_compute_network.available: Reading...
</span></span><span class=line><span class=cl>data.google_compute_zones.available: Reading...
</span></span><span class=line><span class=cl>data.google_compute_zones.available: Read <span class=nb>complete</span> after 0s <span class=o>[</span><span class=nv>id</span><span class=o>=</span>projects/project20231124/regions/asia-east2<span class=o>]</span>
</span></span><span class=line><span class=cl>data.google_container_engine_versions.gke_version: Read <span class=nb>complete</span> after 0s <span class=o>[</span><span class=nv>id</span><span class=o>=</span>2024-08-06 07:51:46.183235726 +0000 UTC<span class=o>]</span>
</span></span><span class=line><span class=cl>data.google_compute_network.available: Read <span class=nb>complete</span> after 0s <span class=o>[</span><span class=nv>id</span><span class=o>=</span>projects/project20231124/global/networks/gke-cluster-02-vpc-network<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Import successful!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The resources that were imported are shown above. These resources are now in
</span></span><span class=line><span class=cl>your Terraform state and will henceforth be managed by Terraform.</span></span></code></pre></td></tr></table></div></div></div></div><p>节点池这类资源地址不能查看，只能通过上一级 <code>google_container_cluster</code> 去查看</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ terraform state show -state<span class=o>=</span>./terraform.tfstate  google_container_node_pool.gcp-available-b
</span></span><span class=line><span class=cl>No instance found <span class=k>for</span> the given address!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>This <span class=nb>command</span> requires that the address references one specific instance.
</span></span><span class=line><span class=cl>To view the available instances, use <span class=s2>&#34;terraform state list&#34;</span>. Please modify 
</span></span><span class=line><span class=cl>the address to reference a specific instance.</span></span></code></pre></td></tr></table></div></div></div></div><p>资源地址必须在 <code>terraform state list</code> 中才可以使用 <code>terraform state show</code> 去查看</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ terraform state list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>data.google_compute_network.available
</span></span><span class=line><span class=cl>data.google_compute_zones.available
</span></span><span class=line><span class=cl>data.google_container_engine_versions.gke_version
</span></span><span class=line><span class=cl>google_compute_subnetwork.vpc-subnet
</span></span><span class=line><span class=cl>google_container_cluster.gke</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=导入-vpc>导入 VPC<a hidden class=anchor aria-hidden=true href=#导入-vpc>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ terraform import google_compute_network.vpc-network /project20231124/asia-east2/gke-cluster-02-vpc-network
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>data.google_compute_zones.available: Reading...
</span></span><span class=line><span class=cl>data.google_compute_network.available: Reading...
</span></span><span class=line><span class=cl>data.google_container_engine_versions.gke_version: Reading...
</span></span><span class=line><span class=cl>data.google_container_engine_versions.gke_version: Read <span class=nb>complete</span> after 0s <span class=o>[</span><span class=nv>id</span><span class=o>=</span>2024-08-06 07:41:30.318550432 +0000 UTC<span class=o>]</span>
</span></span><span class=line><span class=cl>data.google_compute_network.available: Read <span class=nb>complete</span> after 0s <span class=o>[</span><span class=nv>id</span><span class=o>=</span>projects/project20231124/global/networks/gke-cluster-02-vpc-network<span class=o>]</span>
</span></span><span class=line><span class=cl>data.google_compute_zones.available: Read <span class=nb>complete</span> after 0s <span class=o>[</span><span class=nv>id</span><span class=o>=</span>projects/project20231124/regions/asia-east2<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Import successful!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The resources that were imported are shown above. These resources are now in
</span></span><span class=line><span class=cl>your Terraform state and will henceforth be managed by Terraform.</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=导入vpc子网>导入VPC子网<a hidden class=anchor aria-hidden=true href=#导入vpc子网>#</a></h3><p>语法</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform import &lt;resource_name&gt;.&lt;name&gt; &lt;project&gt;/&lt;locations&gt;/&lt;real_resource_name&gt;</span></span></code></pre></td></tr></table></div></div></div></div><p>示例</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform import google_compute_subnetwork.vpc-subnet project20231124/asia-east2/gke-cluster-02-vpc-network</span></span></code></pre></td></tr></table></div></div></div></div><p>输出</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform import google_compute_subnetwork.vpc-subnet project20231124/asia-east2/gke-cluster-02-vpc-network
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>data.google_compute_zones.available: Reading...
</span></span><span class=line><span class=cl>data.google_container_engine_versions.gke_version: Reading...
</span></span><span class=line><span class=cl>data.google_compute_network.available: Reading...
</span></span><span class=line><span class=cl>data.google_compute_zones.available: Read <span class=nb>complete</span> after 0s <span class=o>[</span><span class=nv>id</span><span class=o>=</span>projects/project20231124/regions/asia-east2<span class=o>]</span>
</span></span><span class=line><span class=cl>data.google_container_engine_versions.gke_version: Read <span class=nb>complete</span> after 0s <span class=o>[</span><span class=nv>id</span><span class=o>=</span>2024-08-06 03:43:01.406680586 +0000 UTC<span class=o>]</span>
</span></span><span class=line><span class=cl>data.google_compute_network.available: Read <span class=nb>complete</span> after 1s <span class=o>[</span><span class=nv>id</span><span class=o>=</span>projects/project20231124/global/networks/gke-cluster-02-vpc-network<span class=o>]</span>
</span></span><span class=line><span class=cl>google_compute_subnetwork.vpc-subnet: Importing from ID <span class=s2>&#34;project20231124/asia-east2/gke-cluster-02-vpc-network&#34;</span>...
</span></span><span class=line><span class=cl>google_compute_subnetwork.vpc-subnet: Import prepared!
</span></span><span class=line><span class=cl>  Prepared google_compute_subnetwork <span class=k>for</span> import
</span></span><span class=line><span class=cl>google_compute_subnetwork.vpc-subnet: Refreshing state... <span class=o>[</span><span class=nv>id</span><span class=o>=</span>projects/project20231124/regions/asia-east2/subnetworks/gke-cluster-02-vpc-network<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Import successful!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The resources that were imported are shown above. These resources are now in
</span></span><span class=line><span class=cl>your Terraform state and will henceforth be managed by Terraform.</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=最后查看导入后的资源>最后查看导入后的资源<a hidden class=anchor aria-hidden=true href=#最后查看导入后的资源>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ terraform state list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>data.google_compute_network.available
</span></span><span class=line><span class=cl>data.google_compute_zones.available
</span></span><span class=line><span class=cl>data.google_container_engine_versions.gke_version
</span></span><span class=line><span class=cl>google_compute_subnetwork.vpc-subnet
</span></span><span class=line><span class=cl>google_container_cluster.gke</span></span></code></pre></td></tr></table></div></div></div></div><h2 id=terraform-查看本地state文件资源>terraform 查看本地state文件资源<a hidden class=anchor aria-hidden=true href=#terraform-查看本地state文件资源>#</a></h2><p>terraform state list 查看本地state文件资源</p><p>语法</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#读取  state 或 plan file，不指定 [path] 则output当前文件夹下</span>
</span></span><span class=line><span class=cl>terraform show  <span class=o>[</span>options<span class=o>]</span> <span class=o>[</span>path<span class=o>]</span> </span></span></code></pre></td></tr></table></div></div></div></div><h3 id=查看某个资源路径的信息>查看某个资源路径的信息<a hidden class=anchor aria-hidden=true href=#查看某个资源路径的信息>#</a></h3><p>例如查看 VPC 子网</p><p>语法</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform <span class=o>[</span>global options<span class=o>]</span> state show <span class=o>[</span>options<span class=o>]</span> ADDRESS</span></span></code></pre></td></tr></table></div></div></div></div><p>示例</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># terraform state show -state=./terraform.tfstate  google_compute_subnetwork.vpc-subnet </span>
</span></span><span class=line><span class=cl><span class=c1># google_compute_subnetwork.vpc-subnet:</span>
</span></span><span class=line><span class=cl>resource <span class=s2>&#34;google_compute_subnetwork&#34;</span> <span class=s2>&#34;vpc-subnet&#34;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>creation_timestamp</span>         <span class=o>=</span> <span class=s2>&#34;2022-06-25T01:51:49.868-07:00&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>description</span>                <span class=o>=</span> <span class=s2>&#34;public prod service network&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>gateway_address</span>            <span class=o>=</span> <span class=s2>&#34;192.233.10.1&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>id</span>                         <span class=o>=</span> <span class=s2>&#34;projects/project20231124/regions/asia-east2/subnetworks/gke-cluster-02-vpc-network&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>ip_cidr_range</span>              <span class=o>=</span> <span class=s2>&#34;192.233.10.0/24&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>name</span>                       <span class=o>=</span> <span class=s2>&#34;gke-cluster-02-vpc-network&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>network</span>                    <span class=o>=</span> <span class=s2>&#34;https://www.googleapis.com/compute/v1/projects/project20231124/global/networks/gke-cluster-02-vpc-network&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>private_ip_google_access</span>   <span class=o>=</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl>    <span class=nv>private_ipv6_google_access</span> <span class=o>=</span> <span class=s2>&#34;DISABLE_GOOGLE_ACCESS&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>project</span>                    <span class=o>=</span> <span class=s2>&#34;project20231124&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>purpose</span>                    <span class=o>=</span> <span class=s2>&#34;PRIVATE&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>region</span>                     <span class=o>=</span> <span class=s2>&#34;asia-east2&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>secondary_ip_range</span>         <span class=o>=</span> <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>ip_cidr_range</span> <span class=o>=</span> <span class=s2>&#34;10.126.0.0/22&#34;</span>
</span></span><span class=line><span class=cl>            <span class=nv>range_name</span>    <span class=o>=</span> <span class=s2>&#34;gke-gke-prd-cluster-02-services-621a7058&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>ip_cidr_range</span> <span class=o>=</span> <span class=s2>&#34;10.116.0.0/16&#34;</span>
</span></span><span class=line><span class=cl>            <span class=nv>range_name</span>    <span class=o>=</span> <span class=s2>&#34;gke-gke-prd-cluster-02-pods-621a7058&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=nv>self_link</span>                  <span class=o>=</span> <span class=s2>&#34;https://www.googleapis.com/compute/v1/projects/project20231124/regions/asia-east2/subnetworks/gke-cluster-02-vpc-network&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>stack_type</span>                 <span class=o>=</span> <span class=s2>&#34;IPV4_ONLY&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    timeouts <span class=o>{}</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></td></tr></table></div></div></div></div></div><div class=pe-copyright><hr><blockquote><p>本文为原创内容，版权归作者所有。如需转载，请在文章中声明本文标题及链接。</p><p>文章标题：使用terraform利用已有资源创建GKE集群</p><p>文章链接：<a href=http://localhost:1313/2024/10/gke-create-exists-resources/ target=_blank>http://localhost:1313/2024/10/gke-create-exists-resources/</a></p><p>许可协议：<a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></p></blockquote></div><div class=comments-separator></div><h3 class=relatedContentTitle>相关阅读</h3><ul class=relatedContent><li><a href=/2024/05/gke-vpc-firewall/><span>GKE - 为GKE集群增加VPC防火墙规则</span></a></li><li><a href=/2024/09/gke-invalid-pod-limits/><span>GKE强制升级后JAVA Pod无法识别limit限制</span></a></li><li><a href=/2024/06/docker-push-gcr/><span>使用docker管理谷歌物件仓库gcr上的镜像</span></a></li><li><a href=/2024/05/type-of-machine-for-gcp/><span>GCP机器类型</span></a></li><li><a href=/2023/11/price-of-gke/><span>GKE标准集群价格选择示例</span></a></li></ul><div class=comments-separator></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/public-cloud/>Public Cloud</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/2024/11/xz-upgrade/><span class=title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left" style="user-select:text"><line x1="19" y1="12" x2="5" y2="12" style="user-select:text"/><polyline points="12 19 5 12 12 5" style="user-select:text"/></polyline></svg>&nbsp;</span>
<span>CentOS7&amp;Rocky9更新xz</span>
</a><a class=next href=http://localhost:1313/2024/09/rgw-bucket-sync-with-rclone/><span class=title></span>
<span>使用rclone工具完成bucket数据同步&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select:text"><line x1="5" y1="12" x2="19" y2="12" style="user-select:text"/><polyline points="12 5 19 12 12 19" style="user-select:text"/></svg></span></a></nav></footer><div class=pe-comments-decoration><p class=pe-comments-title></p><p class=pe-comments-subtitle></p></div><div id=pe-comments></div><script src=/js/pe-go-comment.min.86a214102576ba5f9b7bdc29eed8d58dd56e34aef80b3c65c73ea9cc88443696.js integrity="sha256-hqIUECV2ul+be9wp7tjVjdVuNK74Czxlxz6pzIhENpY="></script><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const s={src:"https://giscus.app/client.js","data-repo":"cylonchau/cylonchau.github.io","data-repo-id":"R_kgDOIRlNSQ","data-category":"Announcements","data-category-id":"DIC_kwDOIRlNSc4CXy1U","data-mapping":"pathname","data-term":"posts/gke-create-exists-resources","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":getStoredTheme(),"data-lang":"zh-TW","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(s).forEach(([t,n])=>e.setAttribute(t,n)),document.querySelector("#pe-comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme);const n=document.querySelector("#theme-toggle-float");n&&n.addEventListener("click",setGiscusTheme)})</script></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>Cylon's Collection</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> on
<a href=https://pages.github.com/ rel=noopener target=_blank>GitHub Pages</a> & Theme
        <a href=https://github.com/tofuwine/PaperMod-PE rel=noopener target=_blank>PaperMod-PE</a></span></footer><div class=pe-right-sidebar><a href=javascript:void(0); id=theme-toggle-float class=pe-float-btn><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</a><a href=#top class=pe-float-btn id=top-link><span id=pe-read-progress></span></a></div><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>