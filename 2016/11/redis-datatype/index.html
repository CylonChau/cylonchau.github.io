<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>redis数据类型 | Cylon's Collection</title>
<meta name=keywords content="redis"><meta name=description content='key/value介绍 Redis key值是二进制安全的，这意味着可以用任何二进制序列作为key值，从形如“0foo”的简单字符串到一个JPG文件的内容都可以。空字符串也是有效key值。
关于key的几条规则：
太长的键值，例如1024字节的键值，不仅因为消耗内存，而且在数据中查找这类键值的计算成本很高。
太短的键值，如果你要用 u:1000:pwd来代替user:1000:password，这没有什么问题，但后者更易阅读，并且由此增加的空间消耗相对于key object和value object本身来说很小.当然，没人阻止您一定要用更短的键值节省一丁点空间。
最好坚持一种模式;。例如：object-type:id:field就是个不错的注意，像这样user:1000:password。我喜欢对多单词的字段名中加上一个点，就像这样：comment.1234.renlv_to
key建议：object-type:id:field 长度10-20
value建议：string不要超过2K set sortedset元素不要超过5000
bash 1 2 3 4 $ redis-cli set user_list:user_id:5 zhangsan OK $ redis-cli get user_list:user_id:5 "zhangsan" 通用操作 找到全部给定模式的匹配到的key bash 1 2 3 4 5 6 7 127.0.0.1:6379> keys * #<==打印全部key 1) "name" 2) "site" 127.0.0.1:6379> keys na[ma]e #<==返回正则匹配到的key 1) "name" 127.0.0.1:6379> keys nam? 1) "name" randomkey返回随机key bash 1 2 3 4 127.0.0.1:6379> randomkey "name" 127.0.0.1:6379> randomkey "site" exists检查key是否存在 bash 1 2 3 4 127.'><meta name=author content="cylon"><link rel=canonical href=https://www.oomkill.com/2016/11/redis-datatype/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://www.oomkill.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.oomkill.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.oomkill.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.oomkill.com/favicon.ico><link rel=mask-icon href=https://www.oomkill.com/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://www.oomkill.com/2016/11/redis-datatype/><noscript><style>#theme-toggle,#top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link crossorigin=anonymous href=/assets/css/pe.min.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/pe.min.js></script><link rel=stylesheet href=https://cdn.staticfile.net/font-awesome/6.5.1/css/all.min.css><link rel=stylesheet href=https://cdn.staticfile.net/font-awesome/6.5.1/css/v4-shims.min.css><script id=MathJax-script async src=https://cdn.staticfile.net/mathjax/3.2.2/es5/tex-chtml.js></script><script>MathJax={tex:{displayMath:[["$$","$$"]],inlineMath:[["\\$","\\$"]]}}</script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><meta name=referrer content="no-referrer-when-downgrade"><meta property="og:title" content="redis数据类型"><meta property="og:description" content='key/value介绍 Redis key值是二进制安全的，这意味着可以用任何二进制序列作为key值，从形如“0foo”的简单字符串到一个JPG文件的内容都可以。空字符串也是有效key值。
关于key的几条规则：
太长的键值，例如1024字节的键值，不仅因为消耗内存，而且在数据中查找这类键值的计算成本很高。
太短的键值，如果你要用 u:1000:pwd来代替user:1000:password，这没有什么问题，但后者更易阅读，并且由此增加的空间消耗相对于key object和value object本身来说很小.当然，没人阻止您一定要用更短的键值节省一丁点空间。
最好坚持一种模式;。例如：object-type:id:field就是个不错的注意，像这样user:1000:password。我喜欢对多单词的字段名中加上一个点，就像这样：comment.1234.renlv_to
key建议：object-type:id:field 长度10-20
value建议：string不要超过2K set sortedset元素不要超过5000
bash 1 2 3 4 $ redis-cli set user_list:user_id:5 zhangsan OK $ redis-cli get user_list:user_id:5 "zhangsan" 通用操作 找到全部给定模式的匹配到的key bash 1 2 3 4 5 6 7 127.0.0.1:6379> keys * #<==打印全部key 1) "name" 2) "site" 127.0.0.1:6379> keys na[ma]e #<==返回正则匹配到的key 1) "name" 127.0.0.1:6379> keys nam? 1) "name" randomkey返回随机key bash 1 2 3 4 127.0.0.1:6379> randomkey "name" 127.0.0.1:6379> randomkey "site" exists检查key是否存在 bash 1 2 3 4 127.'><meta property="og:type" content="article"><meta property="og:url" content="https://www.oomkill.com/2016/11/redis-datatype/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-11-23T00:00:00+00:00"><meta property="article:modified_time" content="2022-12-14T23:00:36+08:00"><meta property="og:site_name" content="Cylon's Collection"><meta name=twitter:card content="summary"><meta name=twitter:title content="redis数据类型"><meta name=twitter:description content='key/value介绍 Redis key值是二进制安全的，这意味着可以用任何二进制序列作为key值，从形如“0foo”的简单字符串到一个JPG文件的内容都可以。空字符串也是有效key值。
关于key的几条规则：
太长的键值，例如1024字节的键值，不仅因为消耗内存，而且在数据中查找这类键值的计算成本很高。
太短的键值，如果你要用 u:1000:pwd来代替user:1000:password，这没有什么问题，但后者更易阅读，并且由此增加的空间消耗相对于key object和value object本身来说很小.当然，没人阻止您一定要用更短的键值节省一丁点空间。
最好坚持一种模式;。例如：object-type:id:field就是个不错的注意，像这样user:1000:password。我喜欢对多单词的字段名中加上一个点，就像这样：comment.1234.renlv_to
key建议：object-type:id:field 长度10-20
value建议：string不要超过2K set sortedset元素不要超过5000
bash 1 2 3 4 $ redis-cli set user_list:user_id:5 zhangsan OK $ redis-cli get user_list:user_id:5 "zhangsan" 通用操作 找到全部给定模式的匹配到的key bash 1 2 3 4 5 6 7 127.0.0.1:6379> keys * #<==打印全部key 1) "name" 2) "site" 127.0.0.1:6379> keys na[ma]e #<==返回正则匹配到的key 1) "name" 127.0.0.1:6379> keys nam? 1) "name" randomkey返回随机key bash 1 2 3 4 127.0.0.1:6379> randomkey "name" 127.0.0.1:6379> randomkey "site" exists检查key是否存在 bash 1 2 3 4 127.'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.oomkill.com/posts/"},{"@type":"ListItem","position":2,"name":"redis数据类型","item":"https://www.oomkill.com/2016/11/redis-datatype/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"redis数据类型","name":"redis数据类型","description":"key/value介绍 Redis key值是二进制安全的，这意味着可以用任何二进制序列作为key值，从形如“0foo”的简单字符串到一个JPG文件的内容都可以。空字符串也是有效key值。\n关于key的几条规则：\n太长的键值，例如1024字节的键值，不仅因为消耗内存，而且在数据中查找这类键值的计算成本很高。\n太短的键值，如果你要用 u:1000:pwd来代替user:1000:password，这没有什么问题，但后者更易阅读，并且由此增加的空间消耗相对于key object和value object本身来说很小.当然，没人阻止您一定要用更短的键值节省一丁点空间。\n最好坚持一种模式;。例如：object-type:id:field就是个不错的注意，像这样user:1000:password。我喜欢对多单词的字段名中加上一个点，就像这样：comment.1234.renlv_to\nkey建议：object-type:id:field 长度10-20\nvalue建议：string不要超过2K set sortedset元素不要超过5000\nbash 1 2 3 4 $ redis-cli set user_list:user_id:5 zhangsan OK $ redis-cli get user_list:user_id:5 \u0026#34;zhangsan\u0026#34; 通用操作 找到全部给定模式的匹配到的key bash 1 2 3 4 5 6 7 127.0.0.1:6379\u0026gt; keys * #\u0026lt;==打印全部key 1) \u0026#34;name\u0026#34; 2) \u0026#34;site\u0026#34; 127.0.0.1:6379\u0026gt; keys na[ma]e #\u0026lt;==返回正则匹配到的key 1) \u0026#34;name\u0026#34; 127.0.0.1:6379\u0026gt; keys nam? 1) \u0026#34;name\u0026#34; randomkey返回随机key bash 1 2 3 4 127.0.0.1:6379\u0026gt; randomkey \u0026#34;name\u0026#34; 127.0.0.1:6379\u0026gt; randomkey \u0026#34;site\u0026#34; exists检查key是否存在 bash 1 2 3 4 127.","keywords":["redis"],"articleBody":"key/value介绍 Redis key值是二进制安全的，这意味着可以用任何二进制序列作为key值，从形如“0foo”的简单字符串到一个JPG文件的内容都可以。空字符串也是有效key值。\n关于key的几条规则：\n太长的键值，例如1024字节的键值，不仅因为消耗内存，而且在数据中查找这类键值的计算成本很高。\n太短的键值，如果你要用 u:1000:pwd来代替user:1000:password，这没有什么问题，但后者更易阅读，并且由此增加的空间消耗相对于key object和value object本身来说很小.当然，没人阻止您一定要用更短的键值节省一丁点空间。\n最好坚持一种模式;。例如：object-type:id:field就是个不错的注意，像这样user:1000:password。我喜欢对多单词的字段名中加上一个点，就像这样：comment.1234.renlv_to\nkey建议：object-type:id:field 长度10-20\nvalue建议：string不要超过2K set sortedset元素不要超过5000\nbash 1 2 3 4 $ redis-cli set user_list:user_id:5 zhangsan OK $ redis-cli get user_list:user_id:5 \"zhangsan\" 通用操作 找到全部给定模式的匹配到的key bash 1 2 3 4 5 6 7 127.0.0.1:6379\u003e keys * #\u003c==打印全部key 1) \"name\" 2) \"site\" 127.0.0.1:6379\u003e keys na[ma]e #\u003c==返回正则匹配到的key 1) \"name\" 127.0.0.1:6379\u003e keys nam? 1) \"name\" randomkey返回随机key bash 1 2 3 4 127.0.0.1:6379\u003e randomkey \"name\" 127.0.0.1:6379\u003e randomkey \"site\" exists检查key是否存在 bash 1 2 3 4 127.0.0.1:6379\u003e exists site (integer) 1 127.0.0.1:6379\u003e exists sites (integer) 0 type 查看key类型 bash 1 2 3 4 127.0.0.1:6379\u003e type set set 127.0.0.1:6379\u003e type site string 修改key名称 bash 1 2 3 4 5 6 7 127.0.0.1:6379\u003e rename site web OK 127.0.0.1:6379\u003e keys * 1) \"set\" 2) \"web\" 3) \"name\" 4) \"test\" renamnx rename not exists,当要修改的新名称存在,会用改名后的覆盖存在的那个key\nbash 1 2 3 4 5 6 7 8 9 10 11 12 13 127.0.0.1:6379\u003e set rename_test test OK 127.0.0.1:6379\u003e set rename_test1 test1 OK 127.0.0.1:6379\u003e set tmp tmp OK 127.0.0.1:6379\u003e rename rename_test tmp OK 127.0.0.1:6379\u003e keys * 1) \"tmp\" 2) \"rename_test1\" 127.0.0.1:6379\u003e get tmp \"test\" #\u003c==可以看到tmp把rename_test给覆盖了 将当前数据库的 key 移动到给定的数据库db当中 bash 1 2 3 4 5 6 7 8 9 10 11 12 127.0.0.1:6379\u003e select 2 OK 127.0.0.1:6379[2]\u003e keys * (empty list or set) 127.0.0.1:6379[2]\u003e select 0 OK 127.0.0.1:6379\u003e move web 2 (integer) 1 127.0.0.1:6379\u003e select 2 OK 127.0.0.1:6379[2]\u003e keys * 1)\"web\" dbsize返回当前选择的数据库的key数量 bash 1 2 127.0.0.1:6379\u003e dbsize (integer) 1 shutdown 同步保存数据到磁盘，并结束Redis进程 语法：shutdown [NOSAVE|SAVE]\nbash 1 2 3 4 5 redis-cli shutdown save 12632:M 22 Apr 16:42:23.492 * Saving the final RDB snapshot before exiting. 12632:M 22 Apr 16:42:23.528 * DB saved on disk 12632:M 22 Apr 16:42:23.528 * Removing the pid file. 12632:M 22 Apr 16:42:23.529 # Redis is now ready to exit, bye bye... 异步操作Redis bgrewriteaof (异步重写aof日志文件) 作用减少aof文件大小 BGSAVE(异步保存数据到磁盘)\nString字符串类型 这是最简单的Redis类型。如果你只用这种类型,Redis就是一个可以持久化的memcached服务器(注:memcache的数据仅保存在内存中,服务器重启后,数据将丢失)。\n常规字符串操作 在Redis中，常用set设置一对key/value键值，然后用get来获取字符串的值。value值可以是任何类型的字符串(包括二进制数据)，例如你可以在一个键下保存一个jpg图片。但值的长度不能超过1GB。\nset：设置一个建的字符串值\n语法：set key value [EX seconds] [PX milliseconds] [NX|XX]\nbash 1 2 3 4 5 6 7 8 9 10 11 12 127.0.0.1:6379\u003e set k1 test:key:123 OK 127.0.0.1:6379\u003e ttl k1 (integer) -1 #\u003c==set默认生命周期为永久有效 127.0.0.1:6379\u003e set k1 test_key NX #\u003c==设置一个key,如果不存在就创建。 (nil) #\u003c==因k1存在故没有创建 127.0.0.1:6379\u003e set k2 test_key NX OK\t#\u003c==名为k2的key不存在成功创建 127.0.0.1:6379\u003e set k2 test EX 100 #\u003c==设置key的生命周期 px毫秒 ex秒 OK 127.0.0.1:6379\u003e ttl k2 (integer) 97 mset：设置多个key value\nbash 1 2 3 4 5 6 127.0.0.1:6379\u003e mset key zhangsan ex 100 key1 lisi OK 127.0.0.1:6379\u003e keys * 1) \"key1\" 2) \"ex\" 3) \"key\" #\u003c==通过结果可得知 mset不支持判断是否存在与设置生命周期 setrange：从指定偏移量开始重写字符串的一部分\nbash 1 2 3 4 5 6 127.0.0.1:6379\u003e set key test:123 OK 127.0.0.1:6379\u003e setrange key 5 abc (integer) 8 127.0.0.1:6379\u003e get key \"test:abc\" #\u003c==不存在的偏移量用\\x00填充 append：将值附加到key中\nbash 1 2 3 4 5 6 127.0.0.1:6379\u003e set test a OK 127.0.0.1:6379\u003e APPEND test bc (integer) 3 127.0.0.1:6379\u003e get test \"abc\" getrange：Get a substring of the string stored at a key\nbash 1 2 3 4 5 6 7 8 127.0.0.1:6379\u003e set k test:getrange OK 127.0.0.1:6379\u003e getrange k 0 3 \"test\" 127.0.0.1:6379\u003e getrange k 0 100 \"test:getrange\" #\u003c==如果指定值大于字符串长度返回到字符串结尾处 127.0.0.1:6379\u003e getrange k 100 1000 \"\" #\u003c==如果开始位置大于字符串总长度,返回空字符串 String类型可以用来存储数字 虽然字符串是Redis的基本值类型,但你仍然能通过它完成一些有趣的操作。例如：原子递增。\nINCR命令将字符串值解析成整型,将其加1,最后将结果保存为新的字符串值,类似的命令有INCRBY, DECR and DECRBYC实际上他们在内部就是同一个命令,只是看上去有点儿不同。\nincr是原子操作意味着什么呢?就是说即使多个客户端对同一个key发出INCR命令,也决不会导致竟争的情况.例如如下情况永远不可能发生:「客户端1和客户端2同时读出“10\",他们俩都对其加到11,然后将新值设置为11。最终的值一定是12,read-increment-set操作完成时,其他客户端不会在同一时间执行任何命令。\nincr:将键的整数值递增1\nbash 1 2 3 4 127.0.0.1:6379\u003e set num 1 OK 127.0.0.1:6379\u003e incr num (integer) 2 decr:将键的整数值递减1\nbash 1 2 3 4 127.0.0.1:6379\u003e decr num (integer) 0 127.0.0.1:6379\u003e decr num (integer) -1 #\u003c==与memcached不同的是,redis会被减少为负数 incrby:将键增加一个指定定量\nbash 1 2 127.0.0.1:6379\u003e incrby num 10 (integer) 9 incrbyfloat: 将键增加一个指定定量的浮点值\nbash 1 2 3 4 127.0.0.1:6379\u003e incrbyfloat num \"9.1\" #\u003c==操作后值变为浮点型 127.0.0.1:6379\u003e incrby num 11 (error) ERR value is not an integer or out of range #\u003c==不可以在进行整型原子递增 为key设置新值并且返回原值 对字符串,另一个操作是GETSET命令,行如其名:他为key设置新值并且返回原值。这有什么用处呢?例如:你的系统每当有新用户访问时就用INCR命令操作一个Redis key。你希望每小时对这个信息收集一次。你就可以GETSET这个key并给其赋值0并读取原值。\ngetset：设置key的字符串值，并返回旧值\nbash 1 2 3 4 127.0.0.1:6379\u003e getset k1 test:getset:demo \"test\" 127.0.0.1:6379\u003e get k1 \"test:getset:demo\" setbit getbit bitcount binop 这是偏移位上的二进制值\nbash 1 2 3 4 5 6 (error) ERR bit offset is not an integer or out of range 127.0.0.1:6379\u003e setbit s 4294967296 1 (error) ERR bit offset is not an integer or out of range 127.0.0.1:6379\u003e setbit s 4294967295 1 #\u003c==最大范围为232-1 512M key的最大值 (integer) 0 (1.46s) List类型 要说清楚列表数据类型,最好先讲一点儿理论背景,在信息技术界List这个词常常被使用不当.例如\"Python Lists\"就名不副实(名为Linked Lists),但他们实际上是数组(同样的数据类型在Ruby中叫数组)。\n列表就是有序元素的序列:10,20,1,2,3就是一个列表。但用数组实现的List和用Linked List实现的List,在属性方面大不相同。\nRedis lists基于Linked Lists实现。这意味着即使在一个list中有数百万个元素,在头部或尾部添加一个元素的操作,其时间复杂度也是常数级别的。用LPUSH命令在十个元素的list头部添加新元素,和在千万元素list头部添加新元素的速度相同。\n那么,坏消息是什么?在数组实现的list中利用索引访问元素的速度极快,而同样的操作在linked list实现的list上没有那么快。\nRedis Lists用linked list实现的原因是:对于数据库系统来说,至关重要的特性是:能非常快的在很大的列表上添加元素.另一个重要因素是,正如你将要看到的:Redis lists能在常数时何取得常数长度。\n创建list并插入数据 LPUSH命令可向list的左边(头部)添加一个新元素,而RPUSH命令可向list的右边(尾部)添加一个新元素。最后LRANGE命令可从list中取出一定范围的元素。\nlpush:向list头部插入数据，如果list不存在则自动创建\nbash 1 2 3 4 127.0.0.1:6379\u003e lpush list lisi #\u003c== 头部插入一个数据 (integer) 1 127.0.0.1:6379\u003e lpush list zhangsan (integer) 2 llen:查看list列表元素个数\nbash 1 2 127.0.0.1:6379\u003e llen list\t#\u003c==获得列表元素个数 (integer) 2 lrange:查看列表所有元素\nbash 1 2 3 4 5 127.0.0.1:6379\u003e lrange list 0 3 #\u003c== 打印列表的1,3元素 1) \"zhangsan\" 2) \"lisi\" 3) \"test1\" 127.0.0.1:6379\u003e lrange list 0 -1#\u003c== 打印列表的所有元素 ⚠ 注意：RANGE带有两个索引,范围内第一个和最后一个元素。这两个索引都可以负来告知redis从尾部开始计数,因此-1表示最后一个元素,-2表示list中的倒数第二个元素,以此类推。 lindex:返回指定元素在列表中的下标\nbash 1 2 3 4 5 127.0.0.1:6379\u003e rpush a 1 2 3 4 5 (integer) 5 127.0.0.1:6379\u003e lindex a 1 \"2\" 127.0.0.1:6379\u003e lindex a 1 linsert在指定元素前后插入数据\nbash 1 2 3 4 5 6 7 8 9 127.0.0.1:6379\u003e rpush arr 1 2 3 (integer) 3 127.0.0.1:6379\u003e linsert arr after 2 5 (integer) 4 127.0.0.1:6379\u003e lrange arr 0 -1 1) \"1\" 2) \"2\" 3) \"5\" 4) \"3\" list应用场景 正如你可以从上面的例子中猜到的,list可被用来实现聊天系统。还可以作为不同进程间传递消息的队列。关键是,你可以每次都以原先添加的顺序访问数据。这不需要任何SQL ORDER BY操作,将会非常快,也会很容易扩展到百万级别元素的规模。\n例如在评级系统中,比如社会化新闻网站reddit.com,你可以把每个新提交的链接添加到一个list,用LRANGE可简单的对结果分页。\n在博客引擎实现中,你可为每篇日志设置一个list,在该list中推入进博客评论,等等。\n向Redis list压入ID而不是实际的数据,\n在上面的例子里,我们将“对象”(此例中是简单消息)直接压入Redis list,但通常不应这么做,由于对象可能被多次引4:例如在一个lis:中维护其时间顺序,在一个集合中保存它的类别,只要有必要,它还会出现在其他list中,等等。\n让我们回到reddit.com的例子,将用户提交的链接(新闻)添加到list中,有更可靠的方法如下所示\nbash 1 2 3 4 5 6 7 8 127.0.0.1:6379\u003e incr next.news.id (integer) 1 127.0.0.1:6379\u003e set new:1:title \"redis is simple\" OK 127.0.0.1:6379\u003e set news:1:url \"http://www.baidu.com\" OK 127.0.0.1:6379\u003e lpush submitted.news 1 (integer) 1 OK我们自增一个key,很容易得到一个独一无二的自增ID,然后通过此ID创建对象入为对象的每个字段设置一个key。最后将新对象的submitted.news lists。\nrpop 从尾部删除一个元素 rpush 向尾部插入一个数据 lpop 从头部删除一个元素\n删除list内元素 lrem:删除count的绝对值个value后结束 count \u003e 0从头开始删,\u003c0从尾部开始删\nbash 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 127.0.0.1:6379\u003e rpush aa a a b c a a (integer) 6 127.0.0.1:6379\u003e lrem aa 1 a (integer) 1 127.0.0.1:6379\u003e LRANGE aa 0 -1 1) \"a\" 2) \"b\" 3) \"c\" 4) \"a\" 5) \"a\" 127.0.0.1:6379\u003e lrem aa -2 a (integer) 2 127.0.0.1:6379\u003e LRANGE aa 0 -1 1) \"a\" 2) \"b\" 3) \"c\" ltrim:剪切key对应的链接,切[start,stop]一段,并把该段重新赋给key\nbash 1 2 3 4 5 6 7 127.0.0.1:6379\u003e rpush a 1 2 3 4 5 (integer) 5 127.0.0.1:6379\u003e ltrim a 2 3 OK 127.0.0.1:6379\u003e lrange a 0 -1 1) \"3\" 2) \"4\" rpoplpush:将arr尾部的元素弹出到tmp头部\n作用：接收返回值,并做业务处理。如果成功,rpop tmp清除任务；如不成功,下次从tmp表里取任务\nbash 1 2 3 4 5 6 7 8 127.0.0.1:6379\u003e rpoplpush arr tmp \"3\" 127.0.0.1:6379\u003e lrange arr 0 -1 1) \"1\" 2) \"2\" 3) \"5\" 127.0.0.1:6379\u003e lrange tmp 0 -1 1) \"3\" set集合 Redis集合是未排序的集合,其元素是二进制安全的字符串。sadd命令可以向集合添加一个新元素。和sets相关的操作也有许多,比如检测某个元素是否存在,以及实现交集,并集,差集等等。\n创建并向集合插入新元素 sadd：向集合内添加一个或多个元素\nbash 1 2 127.0.0.1:6379\u003e sadd set a b c d #\u003c==向集合key中增加元素 (integer) 4 smembers：查看集合内所有元素\nbash 1 2 3 4 5 127.0.0.1:6379\u003e smembers set #\u003c==返回集合中的所有元素 1) \"d\" 2) \"c\" 3) \"b\" 4) \"a\" 删除集合中元素 sadd：从集合内删除一个或多个指定元素\nbash 1 2 3 4 5 6 127.0.0.1:6379\u003e srem set a #\u003c==删除集合中名为a的元素 (integer) 1 127.0.0.1:6379\u003e smembers set 1) \"d\" 2) \"c\" 3) \"b\" 查看集合内元素 sismember：检查集合中是否存在某个元素\nbash 1 2 3 4 127.0.0.1:6379\u003e sismember set a (integer) 0 127.0.0.1:6379\u003e sismember set b (integer) 1 srandmember：返回元素中指定个数的随机元素\n语法 srandmember key [count]\nbash 1 2 3 127.0.0.1:6379\u003e srandmember set 2 1) \"d\" 2) \"b\" scard返回元素中的个数\nbash 1 2 127.0.0.1:6379\u003e scard set (integer) 3 移动集合内元素 smove：将source里的member移动到destination集合中\n语法：SMOVE source destination member\nbash 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 127.0.0.1:6379\u003e keys * (empty list or set) 127.0.0.1:6379\u003e sadd set a b c d e (integer) 5 127.0.0.1:6379\u003e smove set tmp e (integer) 1 127.0.0.1:6379\u003e keys * 1) \"set\" 2) \"tmp\" 127.0.0.1:6379\u003e smembers tmp 1) \"e\" 127.0.0.1:6379\u003e smembers set 1) \"c\" 2) \"b\" 3) \"a\" 4) \"d\" “b”是这个集合的成员,而“b”不是。集合特别适合表现对象之间的关系。例如用Redis集合可以很容易实现标签功能。\n下面是一个简单的方案:对每个想加标签的对象,用一个标签ID集合与之关联,并且对每个已有的标签,一组对象ID与之关联。\n例如假设我们的新闻ID=1000被加了三个tag 1,2,5就可以设置下面两个集合\nbash 1 2 3 4 5 6 7 8 9 10 127.0.0.1:6379\u003e sadd news:1000:tags 1 (integer) 1 127.0.0.1:6379\u003e sadd news:1000:tags 2 (integer) 1 127.0.0.1:6379\u003e sadd news:1000:tags 5 (integer) 1 127.0.0.1:6379\u003e smembers news:1000:tags 1) \"1\" 2) \"2\" 3) \"5\" 而有些看上去并不简单的操作仍然能使用相应的redis命令轻松实现。例如我们也许想获得一份同时拥有标签1,2,10和27的对象列表。这可以用SINTER命令来做,他可以在不同集合之间取出交集。\ntags:1:obj tags:2:obj tags:5:obj tags:27:obj\nbash 1 2 3 4 5 6 7 8 9 10 11 127.0.0.1:6379\u003e smembers test1 1) \"1\" 2) \"2\" 3) \"3\" 127.0.0.1:6379\u003e smembers test4 1) \"1\" 2) \"2\" 3) \"9\" 127.0.0.1:6379\u003e sinter test1 test4 1) \"1\" 2) \"2\" 集合计算 创建一个集合\nbash 1 2 3 4 5 6 127.0.0.1:6379\u003e sadd A 1 2 3 4 5 (integer) 5 127.0.0.1:6379\u003e sadd B 1 3 4 5 (integer) 4 127.0.0.1:6379\u003e sadd C 1 2 6 7 8 9 (integer) 6 sinter：取出指定集合内的交集\nbash 1 2 3 4 5 6 7 127.0.0.1:6379\u003e sinter A B #\u003c==取出A B两个集合中的交集 1) \"1\" 2) \"3\" 3) \"4\" 4) \"5\" 127.0.0.1:6379\u003e sinter A B C 1)\"1\" sinterstore：将多个集合的交集放入另一个集合内\nbash 1 2 3 4 5 6 7 127.0.0.1:6379\u003e sinterstore tmp A B #\u003c== 将A B集合中的交集放置在tmp集合中 2)(integer) 4 3)127.0.0.1:6379\u003e smembers tmp 4)1) \"1\" 5)2) \"3\" 6)3) \"4\" 7)4) \"5\" sunion获得多个集合的并集\nbash 1 2 3 4 5 6 127.0.0.1:6379\u003e sunion A B 1) \"1\" 2) \"2\" 3) \"3\" 4) \"4\" 5) \"5\" sdiff获得多个集合的差\nbash 1 2 127.0.0.1:6379\u003e sdiff A B 1) \"2\" 有序集合 集合是使用频率很高的数据类型,但是…对许多问题来说他们也有点儿太不讲顺序了；因此Redis1.2引入了有序集合。他和集合非常相似,也是二进制安全的字符串集合,但是这次带有关联的score,以及一个类似lrange的操作可以返回有序元素,此操作只能作用于有序集合,它就是,zrange命令。\n基本上有序集合从某种程度上说是SQL世界的索引在Redis中的等价物。例如在上面提到的reddit.com例子中,并祥有提到如何根据用户投票和时间因素将新闻组合生成首页。我们将看到有序集合如何解决这个问题,但最好先从更简单的事情开始,阐明这个高级数据类型是如何工作的.让我们添加几个黑客,并将他们的生日作为\"score\"。\n添加并查看有序集合 添加一个或多个成员到一个集合,如果这个成员存在,则更新其排序分数\n语法：ZADD key [NX|XX] [CH] [INCR] score member [score member …]\n选项详解\n参数 解释 XX 仅更新已经存在的元素。不要添加元素。 NX 不要更新现有的元素。始终添加新元素。 CH 从添加的新元素的数量修改返回值,改变元素的总数（CH是更改的缩写）。已更改的元素是添加的新元素,已经存在的元素已更新。所以在命令行中指定的具有与过去相同的分数的元素不计算在内。注意：通常,ZADD的返回值仅计算添加的新元素的数量。 INCR 当指定此选项时,ZADD的行为就像ZINCRBY。在此模式下只能指定一个记分元素对。 创建一个集合\nbash 1 2 3 4 5 6 7 8 9 10 127.0.0.1:6379\u003e zadd hacker 1953 zhangfei 1963 zhaoyun 1989 wangping 1992 zhugeliang 1945 liubei (integer) 5 127.0.0.1:6379\u003e zadd hacker 100 zhugeliang (integer) 0 127.0.0.1:6379\u003e zrange hacker 0 -1 1) \"zhugeliang\" 2) \"liubei\" 3) \"zhangfei\" 4) \"zhaoyun\" 5) \"wangping\" 查看某个元素在集合内的位置\nbash 1 2 127.0.0.1:6379\u003e zscore code_lag py \"4\" 对有序集合采说,按生日排序返回这些数据易如反掌,因为他们已经是有序的。有序集合是通过一个dual-ported数据结构实现的,它包含一个精简的有序列表和一个hash table,因此添加一个元素的时间复杂度是O(log(N))。这还行,但当我们需要访问有序的元素时,Redis不必再做任何事情,它已经是有序的了。\n对集合的值排序 通过索引查看一个有序集合的范围\nbash 1 2 3 4 5 6 7 8 9 10 11 127.0.0.1:6379\u003e zrange hacker 0 -1 withscores #\u003c==打印score 1) \"liubei\" 2) \"1945\" 3) \"zhangfei\" 4) \"1953\" 5) \"zhaoyun\" 6) \"1988\" 7) \"wangping\" 8) \"1989\" 9) \"zhugeliang\" 10) \"1992\" 通过指定索引范围查看有序集合列表（倒序）\nbash 1 2 3 4 5 6 7 8 9 10 11 127.0.0.1:6379\u003e zrevrange hacker 0 -1 withscores 1) \"zhugeliang\" 2) \"1992\" 3) \"wangping\" 4) \"1989\" 5) \"zhaoyun\" 6) \"1988\" 7) \"zhangfei\" 8) \"1953\" 9) \"liubei\" 10)\"1945\" 查看集合中的元素个数 返回有序集合中元素的个数\nbash 1 2 127.0.0.1:6379\u003e zcard hacker (integer) 8 返回min,max包括极值\nbash 1 2 3 4 127.0.0.1:6379\u003e zcount hacker 1950 2000 (integer) 7 127.0.0.1:6379\u003e zcount hacker (1950 (2000 #\u003c==不包括极值的用法 (integer) 4 查找集合区间的元素 zrangebysocre：返回有序集合key的分数min与max之间的所有元素（等于min或max）。这些元素被认为是从低到高的顺序排列。min和max可以是-inf(无穷)和+inf(正无穷)，可以不需要知道的有序集合最高或最低score来获得元素。\n获取1950年之前（两个极值也包含）出生的人\nbash 1 2 3 4 5 127.0.0.1:6379\u003e zrangebyscore hacker -inf 1950 withscores 1) \"liubei\" 2) \"1945\" 3) \"jiangwie\" 4) \"1950\" 返回1950,1970区间内的值\nbash 1 2 3 4 5 127.0.0.1:6379\u003e zrangebyscore hacker 1950 1970 withscores 1) \"jiangwie\" 2) \"1950\" 3) \"zhangfei\" 4) \"1953\" 使用)返回 1950,2000区间内的值\nbash 1 2 3 4 5 6 7 8 9 127.0.0.1:6379\u003e zrangebyscore hacker (1950 (2000 withscores 1) \"zhangfei\" 2) \"1953\" 3) \"zhaoyun\" 4) \"1988\" 5) \"wangping\" 6) \"1989\" 7) \"zhugeliang\" 8) \"1992\" 使用limit返回指定区间内的值\nbash 1 2 3 4 5 6 7 127.0.0.1:6379\u003e zrangebyscore hacker -inf +inf withscores limit 0 3 1) \"liubei\" 2) \"1945\" 3) \"jiangwie\" 4) \"1950\" 5) \"zhangfei\" 6) \"1953\" zremrangebyscore这个名字虽然不算好,但他却非常有用,还会返回已删除的元素数量。\n回到Reddit的例子，现在我们有个基于有序集合的像样方案来生成首页。用一个有序集合来包含最近几天的新闻(用zremrangebyscore不时的删除旧新闻).用一个后台任务从有序集合中获取所有元素,根据用户投票和新闻时间计算score,然后用新闻ID和scores关联生成reddit.home.page有序集合.要显示首页,我们只需闪电般的调用ZRANGE不时的从reddit.home.page有序集合中删除过旧的新闻也是为了让我们的系统总是工作在有限的新闻集合之上。 更新有序集合的scores.\n结束这篇指南之前还有最后一个小贴士.有序集合scores可以在任何时候更新。只要用ZADD对有序集合内的元素操作就会更新它的score(和位置),时间复杂度是O(log(N)),因此即使大量更新,有序集合也是合适的。其中N是排序集合中的元素数，M是返回元素的数量。如果M是常数（例如，总是用LIMIT来询问前10个元素)，可以考虑O(log=(N))。\n计算交并集 计算由numkeys指定个数的key的的交集，并将结果存储在其中destination\nbash 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 127.0.0.1:6379\u003e zadd k1 1 a 2 b 3 c (integer) 3 #\u003c==a b c相当于数组的key 1 2 3相当于数组的值 127.0.0.1:6379\u003e zadd k2 10 a 20 b 30 c (integer) 3 127.0.0.1:6379\u003e zinterstore tmp 1 k1 k2 (error) ERR syntax error #\u003c==指定numkeys的数量和传参数量不一致会提示语法错误 127.0.0.1:6379\u003e zinterstore tmp 2 k1 k2 (integer) 3 127.0.0.1:6379\u003e zrange tmp 0 -1 withscores 1) \"a\" #\u003c==可以看出默认的聚合方法是sum 2) \"11\" 3) \"b\" 4) \"22\" 5) \"c\" 6) \"33\" 127.0.0.1:6379\u003e zinterstore tmp 2 k1 k2 weights 2 1 aggregate sum (integer) 3 #\u003c==指定权重计算两个之间key之间的交集 127.0.0.1:6379\u003e zrange tmp 0 -1 withscores 1) \"a\" 2) \"12\" #\u003c==k1 a=1权重为2 就等于2x1+10=12 3) \"b\" 4) \"24\" 5) \"c\" 6) \"36\" hash hash能够存储一个key对多个属性的数据 如：user.username user.password\n设置key中的域与值 hset：将key中的field域设置为value，如果field域存在则覆盖原value，不存在则添加\nbash 1 2 3 4 5 6 127.0.0.1:6379\u003e hset user1 name zhangsan (integer) 1 127.0.0.1:6379\u003e hset user1 age 12 (integer) 1 127.0.0.1:6379\u003e hset user1 gender male (integer) 1 hmset：给key设置多个field域与值\nbash 1 2 127.0.0.1:6379\u003e hmset user2 name lisi age 11 gender female OK 获得key中的域和值 hget：返回key中一个域的值\nbash 1 2 127.0.0.1:6379\u003e hget user1 name \"zhangsan\" hgetall：返回key中所有域和值\nbash 1 2 3 4 5 6 7 127.0.0.1:6379\u003e hgetall user1 1) \"name\" 2) \"zhangsan\" 3) \"age\" 4) \"12\" 5) \"gender\" 6) \"male\" hmget：返回key中多个值\nbash 1 2 3 127.0.0.1:6379\u003e hmget user1 name age 1) \"zhangsan\" 2) \"12\" hkeys：返回key中的所有域\nbash 1 2 3 4 127.0.0.1:6379\u003e hkeys user1 1) \"age\" 2) \"gender\" 3) hvals：返回key中的所有域的值\nbash 1 2 3 127.0.0.1:6379\u003e hvals user1 1) \"12\" 2) \"male\" 删除key hdel：删除key中一个或多个域\nbash 1 2 3 4 5 6 7 127.0.0.1:6379\u003e hdel user1 name (integer) 1 127.0.0.1:6379\u003e hgetall user1 1) \"age\" 2) \"12\" 3) \"gender\" 4) \"male\" 查看域信息 hlen：返回key中域的个数\nbash 1 2 127.0.0.1:6379\u003e hlen user1 (integer) 2 hexists：查看key中是否存在某个域\nbash 1 2 3 4 127.0.0.1:6379\u003e hexists user1 name (integer) 0 127.0.0.1:6379\u003e hexists user1 age (integer) 1 hstrlen：返回key中域的值的长度\nbash 1 2 127.0.0.1:6379\u003e HSTRLEN user2 gender (integer) 6 hash的原子操作 hincrby：对域中的值增长value个(单位整型)\n语法：hincrby key field increment\nbash 1 2 3 4 5 6 127.0.0.1:6379\u003e hget user1 age \"14\" 127.0.0.1:6379\u003e hincrby user1 age 2 (integer) 16 127.0.0.1:6379\u003e hget user1 age \"16\" hincrbyfloat：对域中的值增长value(单位浮点型)\nbash 1 2 3 4 5 6 127.0.0.1:6379\u003e hincrbyfloat user1 age 0.3 \"16.3\" 127.0.0.1:6379\u003e hget user1 age \"16.3\" 127.0.0.1:6379\u003e hincrbyfloat user1 age -2 #\u003c==减少用负数即可 \"14.3\" bitMap 可实现用很小的内存实现高效的存储。\nHyperLogLog 超小内存唯一值计数。 12k来实现唯一值得计数\nGEO 基于地理信息位置定位\n","wordCount":"2044","inLanguage":"zh","datePublished":"2016-11-23T00:00:00Z","dateModified":"2022-12-14T23:00:36+08:00","author":{"@type":"Person","name":"cylon"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.oomkill.com/2016/11/redis-datatype/"},"publisher":{"@type":"Organization","name":"Cylon's Collection","logo":{"@type":"ImageObject","url":"https://www.oomkill.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.oomkill.com/><img src=https://www.oomkill.com/favicon.ico alt aria-label=logo height=20>Cylon's Collection</a><div class=logo-switches><button id=theme-toggle><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.oomkill.com/archives><span>归档</span></a></li><li><a href=https://www.oomkill.com/tags><span>标签</span></a></li><li><a href=https://www.oomkill.com/search><span>搜索</span></a></li><li><a href=https://www.oomkill.com/about accesskey=/><span>关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">redis数据类型</h1><div class=post-meta><span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg><span>2016-11-23</span></span>&nbsp;·&nbsp;<span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select:text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z" style="user-select:text"/><polyline points="14 2 14 8 20 8" style="user-select:text"/><line x1="16" y1="13" x2="8" y2="13" style="user-select:text"/><line x1="16" y1="17" x2="8" y2="17" style="user-select:text"/><polyline points="10 9 9 9 8 9" style="user-select:text"/></svg><span>2044 字</span></span>&nbsp;·&nbsp;<span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><span>10 分钟</span></span>
<span class=pe-post-meta-item>&nbsp;·&nbsp;<svg t="1714036239378" fill="currentcolor" class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="6659" width="256" height="256"><path d="M690 78.2c-18.6-18.8-49-19-67.8-.4s-19 49-.4 67.8l255.4 258.6c67.8 68.6 67.8 178.8.0 247.4L653.4 878.2c-18.6 18.8-18.4 49.2.4 67.8s49.2 18.4 67.8-.4l224-226.4c104.8-106 104.8-276.4.0-382.4L690 78.2zM485.4 101.4c-24-24-56.6-37.4-90.6-37.4H96C43 64 0 107 0 160v299c0 34 13.4 66.6 37.4 90.6l336 336c50 50 131 50 181 0l267-267c50-50 50-131 0-181l-336-336zM96 160h299c8.4.0 16.6 3.4 22.6 9.4l336 336c12.4 12.4 12.4 32.8.0 45.2l-267 267c-12.4 12.4-32.8 12.4-45.2.0l-336-336c-6-6-9.4-14.2-9.4-22.6V160zm192 128a64 64 0 10-128 0 64 64 0 10128 0z" p-id="6660"/></svg></span><ul class=pe-post-meta-item><a href=https://www.oomkill.com/tags/databases/>#Databases</a></ul>&nbsp;·&nbsp;<span id=busuanzi_container_page_pv>本文阅读量 <span id=busuanzi_value_page_pv></span> 次</span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details><summary><span class=details>目录</span></summary><div class=inner><ul><li><a href=#keyvalue%e4%bb%8b%e7%bb%8d aria-label=key/value介绍>key/value介绍</a><li><a href=#%e9%80%9a%e7%94%a8%e6%93%8d%e4%bd%9c aria-label=通用操作>通用操作</a><ul><li><a href=#%e6%89%be%e5%88%b0%e5%85%a8%e9%83%a8%e7%bb%99%e5%ae%9a%e6%a8%a1%e5%bc%8f%e7%9a%84%e5%8c%b9%e9%85%8d%e5%88%b0%e7%9a%84key aria-label=找到全部给定模式的匹配到的key>找到全部给定模式的匹配到的key</a><li><a href=#randomkey%e8%bf%94%e5%9b%9e%e9%9a%8f%e6%9c%bakey aria-label=randomkey返回随机key>randomkey返回随机key</a><li><a href=#exists%e6%a3%80%e6%9f%a5key%e6%98%af%e5%90%a6%e5%ad%98%e5%9c%a8 aria-label=exists检查key是否存在>exists检查key是否存在</a><li><a href=#type-%e6%9f%a5%e7%9c%8bkey%e7%b1%bb%e5%9e%8b aria-label="type 查看key类型">type 查看key类型</a><li><a href=#%e4%bf%ae%e6%94%b9key%e5%90%8d%e7%a7%b0 aria-label=修改key名称>修改key名称</a><li><a href=#%e5%b0%86%e5%bd%93%e5%89%8d%e6%95%b0%e6%8d%ae%e5%ba%93%e7%9a%84-key-%e7%a7%bb%e5%8a%a8%e5%88%b0%e7%bb%99%e5%ae%9a%e7%9a%84%e6%95%b0%e6%8d%ae%e5%ba%93db%e5%bd%93%e4%b8%ad aria-label="将当前数据库的 key 移动到给定的数据库db当中">将当前数据库的 key 移动到给定的数据库db当中</a><li><a href=#dbsize%e8%bf%94%e5%9b%9e%e5%bd%93%e5%89%8d%e9%80%89%e6%8b%a9%e7%9a%84%e6%95%b0%e6%8d%ae%e5%ba%93%e7%9a%84key%e6%95%b0%e9%87%8f aria-label=dbsize返回当前选择的数据库的key数量>dbsize返回当前选择的数据库的key数量</a><li><a href=#shutdown-%e5%90%8c%e6%ad%a5%e4%bf%9d%e5%ad%98%e6%95%b0%e6%8d%ae%e5%88%b0%e7%a3%81%e7%9b%98%e5%b9%b6%e7%bb%93%e6%9d%9fredis%e8%bf%9b%e7%a8%8b aria-label="shutdown 同步保存数据到磁盘，并结束Redis进程">shutdown 同步保存数据到磁盘，并结束Redis进程</a><li><a href=#%e5%bc%82%e6%ad%a5%e6%93%8d%e4%bd%9credis aria-label=异步操作Redis>异步操作Redis</a></ul><li><a href=#string%e5%ad%97%e7%ac%a6%e4%b8%b2%e7%b1%bb%e5%9e%8b aria-label=String字符串类型>String字符串类型</a><ul><li><a href=#%e5%b8%b8%e8%a7%84%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%93%8d%e4%bd%9c aria-label=常规字符串操作>常规字符串操作</a><li><a href=#string%e7%b1%bb%e5%9e%8b%e5%8f%af%e4%bb%a5%e7%94%a8%e6%9d%a5%e5%ad%98%e5%82%a8%e6%95%b0%e5%ad%97 aria-label=String类型可以用来存储数字>String类型可以用来存储数字</a><li><a href=#%e4%b8%bakey%e8%ae%be%e7%bd%ae%e6%96%b0%e5%80%bc%e5%b9%b6%e4%b8%94%e8%bf%94%e5%9b%9e%e5%8e%9f%e5%80%bc aria-label=为key设置新值并且返回原值>为key设置新值并且返回原值</a><li><a href=#setbit-getbit-bitcount-binop aria-label="setbit getbit bitcount binop">setbit getbit bitcount binop</a></ul><li><a href=#list%e7%b1%bb%e5%9e%8b aria-label=List类型>List类型</a><ul><li><a href=#%e5%88%9b%e5%bb%balist%e5%b9%b6%e6%8f%92%e5%85%a5%e6%95%b0%e6%8d%ae aria-label=创建list并插入数据>创建list并插入数据</a><li><a href=#list%e5%ba%94%e7%94%a8%e5%9c%ba%e6%99%af aria-label=list应用场景>list应用场景</a><li><a href=#%e5%88%a0%e9%99%a4list%e5%86%85%e5%85%83%e7%b4%a0 aria-label=删除list内元素>删除list内元素</a></ul><li><a href=#set%e9%9b%86%e5%90%88 aria-label=set集合>set集合</a><ul><li><a href=#%e5%88%9b%e5%bb%ba%e5%b9%b6%e5%90%91%e9%9b%86%e5%90%88%e6%8f%92%e5%85%a5%e6%96%b0%e5%85%83%e7%b4%a0 aria-label=创建并向集合插入新元素>创建并向集合插入新元素</a><li><a href=#%e5%88%a0%e9%99%a4%e9%9b%86%e5%90%88%e4%b8%ad%e5%85%83%e7%b4%a0 aria-label=删除集合中元素>删除集合中元素</a><li><a href=#%e6%9f%a5%e7%9c%8b%e9%9b%86%e5%90%88%e5%86%85%e5%85%83%e7%b4%a0 aria-label=查看集合内元素>查看集合内元素</a><li><a href=#%e7%a7%bb%e5%8a%a8%e9%9b%86%e5%90%88%e5%86%85%e5%85%83%e7%b4%a0 aria-label=移动集合内元素>移动集合内元素</a><li><a href=#%e9%9b%86%e5%90%88%e8%ae%a1%e7%ae%97 aria-label=集合计算>集合计算</a></ul><li><a href=#%e6%9c%89%e5%ba%8f%e9%9b%86%e5%90%88 aria-label=有序集合>有序集合</a><ul><li><a href=#%e6%b7%bb%e5%8a%a0%e5%b9%b6%e6%9f%a5%e7%9c%8b%e6%9c%89%e5%ba%8f%e9%9b%86%e5%90%88 aria-label=添加并查看有序集合>添加并查看有序集合</a><li><a href=#%e5%af%b9%e9%9b%86%e5%90%88%e7%9a%84%e5%80%bc%e6%8e%92%e5%ba%8f aria-label=对集合的值排序>对集合的值排序</a><li><a href=#%e6%9f%a5%e7%9c%8b%e9%9b%86%e5%90%88%e4%b8%ad%e7%9a%84%e5%85%83%e7%b4%a0%e4%b8%aa%e6%95%b0 aria-label=查看集合中的元素个数>查看集合中的元素个数</a><li><a href=#%e6%9f%a5%e6%89%be%e9%9b%86%e5%90%88%e5%8c%ba%e9%97%b4%e7%9a%84%e5%85%83%e7%b4%a0 aria-label=查找集合区间的元素>查找集合区间的元素</a><li><a href=#%e8%ae%a1%e7%ae%97%e4%ba%a4%e5%b9%b6%e9%9b%86 aria-label=计算交并集>计算交并集</a></ul><li><a href=#hash aria-label=hash>hash</a><ul><li><a href=#%e8%ae%be%e7%bd%aekey%e4%b8%ad%e7%9a%84%e5%9f%9f%e4%b8%8e%e5%80%bc aria-label=设置key中的域与值>设置key中的域与值</a><li><a href=#%e8%8e%b7%e5%be%97key%e4%b8%ad%e7%9a%84%e5%9f%9f%e5%92%8c%e5%80%bc aria-label=获得key中的域和值>获得key中的域和值</a><li><a href=#%e5%88%a0%e9%99%a4key aria-label=删除key>删除key</a><li><a href=#%e6%9f%a5%e7%9c%8b%e5%9f%9f%e4%bf%a1%e6%81%af aria-label=查看域信息>查看域信息</a><li><a href=#hash%e7%9a%84%e5%8e%9f%e5%ad%90%e6%93%8d%e4%bd%9c aria-label=hash的原子操作>hash的原子操作</a></li></div></details></div></aside><script src=/js/pe-toc.min.445eb1bfc5e85dd13b9519fcc2a806522e9629b6224a2974052789ba00ab78af.js integrity="sha256-RF6xv8XoXdE7lRn8wqgGUi6WKbYiSil0BSeJugCreK8="></script><div class=post-content><h2 id=keyvalue介绍>key/value介绍<a hidden class=anchor aria-hidden=true href=#keyvalue介绍>#</a></h2><p>Redis key值是二进制安全的，这意味着可以用任何二进制序列作为key值，从形如“0foo”的简单字符串到一个JPG文件的内容都可以。空字符串也是有效key值。</p><p><em><strong>关于key的几条规则</strong></em>：</p><p>太长的键值，例如1024字节的键值，不仅因为消耗内存，而且在数据中查找这类键值的计算成本很高。</p><p>太短的键值，如果你要用 <font color=#f8070d size=3><code>u:1000:pwd</code></font>来代替<font color=#f8070d size=3><code>user:1000:password</code></font>，这没有什么问题，但后者更易阅读，并且由此增加的空间消耗相对于key object和value object本身来说很小.当然，没人阻止您一定要用更短的键值节省一丁点空间。</p><p><font style=background:#bafe01 size=2>最好坚持一种模式;</font>。例如：<font color=#f8070d size=2><code>object-type:id:field</code></font>就是个不错的注意，像这样<font color=#f8070d size=2><code>user:1000:password</code></font>。我喜欢对多单词的字段名中加上一个点，就像这样：<font color=#f8070d size=2><code>comment.1234.renlv_to</code></font></p><p>key建议：<font color=#f8070d size=3><code>object-type:id:field</code></font> <font style=background:#bafe01 size=2>长度10-20</font></p><p>value建议：<font style=background:#bafe01 size=2>string不要超过2K set sortedset元素不要超过5000</font></p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ redis-cli <span class=nb>set</span> user_list:user_id:5 zhangsan
</span></span><span class=line><span class=cl>OK
</span></span><span class=line><span class=cl>$ redis-cli get user_list:user_id:5
</span></span><span class=line><span class=cl><span class=s2>&#34;zhangsan&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><h2 id=通用操作>通用操作<a hidden class=anchor aria-hidden=true href=#通用操作>#</a></h2><h3 id=找到全部给定模式的匹配到的key>找到全部给定模式的匹配到的key<a hidden class=anchor aria-hidden=true href=#找到全部给定模式的匹配到的key>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; keys * <span class=c1>#&lt;==打印全部key</span>
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;name&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;site&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; keys na<span class=o>[</span>ma<span class=o>]</span>e <span class=c1>#&lt;==返回正则匹配到的key</span>
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;name&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; keys nam?
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;name&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=randomkey返回随机key>randomkey返回随机key<a hidden class=anchor aria-hidden=true href=#randomkey返回随机key>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; randomkey
</span></span><span class=line><span class=cl><span class=s2>&#34;name&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; randomkey
</span></span><span class=line><span class=cl><span class=s2>&#34;site&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=exists检查key是否存在>exists检查key是否存在<a hidden class=anchor aria-hidden=true href=#exists检查key是否存在>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; exists site
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; exists sites
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>0</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=type-查看key类型>type 查看key类型<a hidden class=anchor aria-hidden=true href=#type-查看key类型>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>type</span> <span class=nb>set</span>
</span></span><span class=line><span class=cl><span class=nb>set</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>type</span> site
</span></span><span class=line><span class=cl>string</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=修改key名称>修改key名称<a hidden class=anchor aria-hidden=true href=#修改key名称>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; rename site web 
</span></span><span class=line><span class=cl>OK
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; keys *
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;set&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;web&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;name&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;test&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>renamnx rename not exists,当要修改的新名称存在,会用改名后的覆盖存在的那个key</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>set</span> rename_test <span class=nb>test</span>
</span></span><span class=line><span class=cl>OK
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>set</span> rename_test1 test1
</span></span><span class=line><span class=cl>OK
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>set</span> tmp tmp
</span></span><span class=line><span class=cl>OK
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; rename rename_test tmp
</span></span><span class=line><span class=cl>OK
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; keys *
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;tmp&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;rename_test1&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; get tmp
</span></span><span class=line><span class=cl><span class=s2>&#34;test&#34;</span> <span class=c1>#&lt;==可以看到tmp把rename_test给覆盖了</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=将当前数据库的-key-移动到给定的数据库db当中>将当前数据库的 key 移动到给定的数据库db当中<a hidden class=anchor aria-hidden=true href=#将当前数据库的-key-移动到给定的数据库db当中>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=k>select</span> <span class=m>2</span>
</span></span><span class=line><span class=cl>OK
</span></span><span class=line><span class=cl>127.0.0.1:6379<span class=o>[</span>2<span class=o>]</span>&gt; keys *
</span></span><span class=line><span class=cl><span class=o>(</span>empty list or <span class=nb>set</span><span class=o>)</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379<span class=o>[</span>2<span class=o>]</span>&gt; <span class=k>select</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>OK
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; move web <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=k>select</span> <span class=m>2</span>
</span></span><span class=line><span class=cl>OK
</span></span><span class=line><span class=cl>127.0.0.1:6379<span class=o>[</span>2<span class=o>]</span>&gt; keys *
</span></span><span class=line><span class=cl>1<span class=o>)</span><span class=s2>&#34;web&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=dbsize返回当前选择的数据库的key数量>dbsize返回当前选择的数据库的key数量<a hidden class=anchor aria-hidden=true href=#dbsize返回当前选择的数据库的key数量>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; dbsize
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=shutdown-同步保存数据到磁盘并结束redis进程>shutdown 同步保存数据到磁盘，并结束Redis进程<a hidden class=anchor aria-hidden=true href=#shutdown-同步保存数据到磁盘并结束redis进程>#</a></h3><p>语法：shutdown [NOSAVE|SAVE]</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>redis-cli shutdown save
</span></span><span class=line><span class=cl>12632:M <span class=m>22</span> Apr 16:42:23.492 * Saving the final RDB snapshot before exiting.
</span></span><span class=line><span class=cl>12632:M <span class=m>22</span> Apr 16:42:23.528 * DB saved on disk
</span></span><span class=line><span class=cl>12632:M <span class=m>22</span> Apr 16:42:23.528 * Removing the pid file.
</span></span><span class=line><span class=cl>12632:M <span class=m>22</span> Apr 16:42:23.529 <span class=c1># Redis is now ready to exit, bye bye...</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=异步操作redis>异步操作Redis<a hidden class=anchor aria-hidden=true href=#异步操作redis>#</a></h3><p>bgrewriteaof (异步重写aof日志文件)
作用减少aof文件大小
BGSAVE(异步保存数据到磁盘)</p><h2 id=string字符串类型>String字符串类型<a hidden class=anchor aria-hidden=true href=#string字符串类型>#</a></h2><p>这是最简单的Redis类型。如果你只用这种类型,Redis就是一个可以持久化的memcached服务器(注:memcache的数据仅保存在内存中,服务器重启后,数据将丢失)。</p><h3 id=常规字符串操作>常规字符串操作<a hidden class=anchor aria-hidden=true href=#常规字符串操作>#</a></h3><p>在Redis中，常用set设置一对key/value键值，然后用get来获取字符串的值。value值可以是任何类型的字符串(包括二进制数据)，例如你可以在一个键下保存一个jpg图片。但值的长度不能超过1GB。</p><blockquote><p><strong>set：设置一个建的字符串值</strong></p></blockquote><p>语法：set key value [EX seconds] [PX milliseconds] [NX|XX]</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>set</span> k1 test:key:123
</span></span><span class=line><span class=cl>OK  
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; ttl k1
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> -1 <span class=c1>#&lt;==set默认生命周期为永久有效</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>set</span> k1 test_key NX <span class=c1>#&lt;==设置一个key,如果不存在就创建。</span>
</span></span><span class=line><span class=cl><span class=o>(</span>nil<span class=o>)</span> <span class=c1>#&lt;==因k1存在故没有创建</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>set</span> k2 test_key NX
</span></span><span class=line><span class=cl>OK	<span class=c1>#&lt;==名为k2的key不存在成功创建</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>set</span> k2 <span class=nb>test</span> EX <span class=m>100</span> <span class=c1>#&lt;==设置key的生命周期 px毫秒 ex秒</span>
</span></span><span class=line><span class=cl>OK 
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; ttl k2
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>97</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>mset：设置多个key value</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; mset key zhangsan ex <span class=m>100</span> key1 lisi 
</span></span><span class=line><span class=cl>OK
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; keys *
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;key1&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;ex&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;key&#34;</span> <span class=c1>#&lt;==通过结果可得知 mset不支持判断是否存在与设置生命周期</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>setrange：从指定偏移量开始重写字符串的一部分</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>set</span> key test:123
</span></span><span class=line><span class=cl>OK
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; setrange key <span class=m>5</span> abc
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>8</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; get key
</span></span><span class=line><span class=cl><span class=s2>&#34;test:abc&#34;</span>  <span class=c1>#&lt;==不存在的偏移量用\x00填充</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>append：将值附加到key中</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>set</span> <span class=nb>test</span> a
</span></span><span class=line><span class=cl>OK
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; APPEND <span class=nb>test</span> bc
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>3</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; get <span class=nb>test</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;abc&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>getrange：Get a substring of the string stored at a key</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>set</span> k test:getrange
</span></span><span class=line><span class=cl>OK
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; getrange k <span class=m>0</span> <span class=m>3</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;test&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; getrange k <span class=m>0</span> <span class=m>100</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;test:getrange&#34;</span> <span class=c1>#&lt;==如果指定值大于字符串长度返回到字符串结尾处</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; getrange k <span class=m>100</span> <span class=m>1000</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;</span> <span class=c1>#&lt;==如果开始位置大于字符串总长度,返回空字符串</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=string类型可以用来存储数字>String类型可以用来存储数字<a hidden class=anchor aria-hidden=true href=#string类型可以用来存储数字>#</a></h3><p>虽然字符串是Redis的基本值类型,但你仍然能通过它完成一些有趣的操作。例如：原子递增。</p><p>INCR命令将字符串值解析成整型,将其加1,最后将结果保存为新的字符串值,类似的命令有INCRBY, DECR and DECRBYC实际上他们在内部就是同一个命令,只是看上去有点儿不同。</p><p>incr是原子操作意味着什么呢?就是说即使多个客户端对同一个key发出INCR命令,也决不会导致竟争的情况.例如如下情况永远不可能发生:「客户端1和客户端2同时读出“10",他们俩都对其加到11,然后将新值设置为11。最终的值一定是12,read-increment-set操作完成时,其他客户端不会在同一时间执行任何命令。</p><blockquote><p><strong>incr:将键的整数值递增1</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>set</span> num <span class=m>1</span>
</span></span><span class=line><span class=cl>OK
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; incr num
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>2</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>decr:将键的整数值递减1</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; decr num
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; decr num
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> -1 <span class=c1>#&lt;==与memcached不同的是,redis会被减少为负数</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>incrby:将键增加一个指定定量</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; incrby num <span class=m>10</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>9</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>incrbyfloat: 将键增加一个指定定量的浮点值</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; incrbyfloat num 
</span></span><span class=line><span class=cl><span class=s2>&#34;9.1&#34;</span> <span class=c1>#&lt;==操作后值变为浮点型</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; incrby num <span class=m>11</span> 
</span></span><span class=line><span class=cl><span class=o>(</span>error<span class=o>)</span> ERR value is not an integer or out of range <span class=c1>#&lt;==不可以在进行整型原子递增</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=为key设置新值并且返回原值>为key设置新值并且返回原值<a hidden class=anchor aria-hidden=true href=#为key设置新值并且返回原值>#</a></h3><p>对字符串,另一个操作是GETSET命令,行如其名:他为key设置新值并且返回原值。这有什么用处呢?例如:你的系统每当有新用户访问时就用INCR命令操作一个Redis key。你希望每小时对这个信息收集一次。你就可以GETSET这个key并给其赋值0并读取原值。</p><blockquote><p><strong>getset：设置key的字符串值，并返回旧值</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; getset k1 test:getset:demo
</span></span><span class=line><span class=cl><span class=s2>&#34;test&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; get k1
</span></span><span class=line><span class=cl><span class=s2>&#34;test:getset:demo&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=setbit-getbit-bitcount-binop>setbit getbit bitcount binop<a hidden class=anchor aria-hidden=true href=#setbit-getbit-bitcount-binop>#</a></h3><blockquote><p><strong>这是偏移位上的二进制值</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>(</span>error<span class=o>)</span> ERR bit offset is not an integer or out of range
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; setbit s <span class=m>4294967296</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=o>(</span>error<span class=o>)</span> ERR bit offset is not an integer or out of range
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; setbit s <span class=m>4294967295</span> <span class=m>1</span> <span class=c1>#&lt;==最大范围为232-1 512M key的最大值</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=o>(</span>1.46s<span class=o>)</span></span></span></code></pre></td></tr></table></div></div></div></div><h2 id=list类型>List类型<a hidden class=anchor aria-hidden=true href=#list类型>#</a></h2><p>要说清楚列表数据类型,最好先讲一点儿理论背景,在信息技术界List这个词常常被使用不当.例如"Python Lists"就名不副实(名为Linked Lists),<font style=background:#bafe01 size=2>但他们实际上是数组</font>(同样的数据类型在Ruby中叫数组)。</p><p>列表就是有<font style=background:#bafe01 size=2>序元素的序列</font>:10,20,1,2,3就是一个列表。但用数组实现的List和用Linked List实现的List,在属性方面大不相同。</p><p>Redis lists基于Linked Lists实现。这意味着即使在一个list中有数百万个元素,在头部或尾部添加一个元素的操作,其时间复杂度也是常数级别的。用LPUSH命令在十个元素的list头部添加新元素,和在千万元素list头部添加新元素的速度相同。</p><p>那么,坏消息是什么?在数组实现的list中利用索引访问元素的速度极快,而同样的操作在linked list实现的list上没有那么快。</p><p>Redis Lists用linked list实现的原因是:对于数据库系统来说,至关重要的特性是:能非常快的在很大的列表上添加元素.另一个重要因素是,正如你将要看到的:Redis lists能在常数时何取得常数长度。</p><h3 id=创建list并插入数据>创建list并插入数据<a hidden class=anchor aria-hidden=true href=#创建list并插入数据>#</a></h3><p>LPUSH命令可向list的左边(头部)添加一个新元素,而RPUSH命令可向list的右边(尾部)添加一个新元素。最后LRANGE命令可从list中取出一定范围的元素。</p><blockquote><p><strong>lpush:向list头部插入数据，如果list不存在则自动创建</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; lpush list lisi <span class=c1>#&lt;== 头部插入一个数据</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; lpush list zhangsan
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>2</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>llen:查看list列表元素个数</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; llen list	<span class=c1>#&lt;==获得列表元素个数</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>2</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>lrange:查看列表所有元素</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; lrange list <span class=m>0</span> <span class=m>3</span> <span class=c1>#&lt;== 打印列表的1,3元素</span>
</span></span><span class=line><span class=cl> 1<span class=o>)</span> <span class=s2>&#34;zhangsan&#34;</span>
</span></span><span class=line><span class=cl> 2<span class=o>)</span> <span class=s2>&#34;lisi&#34;</span>
</span></span><span class=line><span class=cl> 3<span class=o>)</span> <span class=s2>&#34;test1&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; lrange list <span class=m>0</span> -1#&lt;<span class=o>==</span> 打印列表的所有元素</span></span></code></pre></td></tr></table></div></div></div></div><hr><p><strong><font color=#0215cd size=2><font color=#f8070d size=2>⚠</font> 注意：RANGE带有两个索引,范围内第一个和最后一个元素。这两个索引都可以负来告知redis从尾部开始计数,因此-1表示最后一个元素,-2表示list中的倒数第二个元素,以此类推。</font></strong></p><hr><blockquote><p><strong>lindex:返回指定元素在列表中的下标</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; rpush a <span class=m>1</span> <span class=m>2</span> <span class=m>3</span> <span class=m>4</span> <span class=m>5</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>5</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; lindex a <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; lindex a <span class=m>1</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>linsert在指定元素前后插入数据</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; rpush arr <span class=m>1</span> <span class=m>2</span> <span class=m>3</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>3</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; linsert arr after <span class=m>2</span> <span class=m>5</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>4</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; lrange arr <span class=m>0</span> -1
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;5&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;3&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=list应用场景>list应用场景<a hidden class=anchor aria-hidden=true href=#list应用场景>#</a></h3><p>正如你可以从上面的例子中猜到的,list可被用来实现聊天系统。还可以作为不同进程间传递消息的队列。关键是,你可以每次都以原先添加的顺序访问数据。这不需要任何SQL ORDER BY操作,将会非常快,也会很容易扩展到百万级别元素的规模。</p><p>例如在评级系统中,比如社会化新闻网站reddit.com,你可以把每个新提交的链接添加到一个list,用LRANGE可简单的对结果分页。</p><p>在博客引擎实现中,你可为每篇日志设置一个list,在该list中推入进博客评论,等等。</p><p>向Redis list压入ID而不是实际的数据,</p><p>在上面的例子里,我们将“对象”(此例中是简单消息)直接压入Redis list,但通常不应这么做,由于对象可能被多次引4:例如在一个lis:中维护其时间顺序,在一个集合中保存它的类别,只要有必要,它还会出现在其他list中,等等。</p><p>让我们回到reddit.com的例子,将用户提交的链接(新闻)添加到list中,有更可靠的方法如下所示</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; incr next.news.id
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>set</span> new:1:title <span class=s2>&#34;redis is simple&#34;</span>
</span></span><span class=line><span class=cl>OK
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>set</span> news:1:url <span class=s2>&#34;http://www.baidu.com&#34;</span>
</span></span><span class=line><span class=cl>OK
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; lpush submitted.news <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span></span></span></code></pre></td></tr></table></div></div></div></div><p>OK我们自增一个key,很容易得到一个独一无二的自增ID,然后通过此ID创建对象入为对象的每个字段设置一个key。最后将新对象的submitted.news lists。</p><blockquote><blockquote><p>rpop 从尾部删除一个元素
rpush 向尾部插入一个数据
lpop 从头部删除一个元素</p></blockquote></blockquote><h3 id=删除list内元素>删除list内元素<a hidden class=anchor aria-hidden=true href=#删除list内元素>#</a></h3><blockquote><p><strong>lrem:删除count的绝对值个value后结束<font style=background:#bafe01 size=2> count > 0从头开始删,&lt;0从尾部开始删</font></strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; rpush aa a a b c a a
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>6</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; lrem aa <span class=m>1</span> a
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; LRANGE aa <span class=m>0</span> -1
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;a&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;b&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;c&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;a&#34;</span>
</span></span><span class=line><span class=cl>5<span class=o>)</span> <span class=s2>&#34;a&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; lrem aa -2 a
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>2</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; LRANGE aa <span class=m>0</span> -1
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;a&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;b&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;c&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>ltrim:剪切key对应的链接,切[start,stop]一段,并把该段重新赋给key</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; rpush a <span class=m>1</span> <span class=m>2</span> <span class=m>3</span> <span class=m>4</span> <span class=m>5</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>5</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; ltrim a <span class=m>2</span> <span class=m>3</span>
</span></span><span class=line><span class=cl>OK
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; lrange a <span class=m>0</span> -1
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;3&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;4&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>rpoplpush:将arr尾部的元素弹出到tmp头部</strong></p></blockquote><p>作用：接收返回值,并做业务处理。如果成功,rpop tmp清除任务；如不成功,下次从tmp表里取任务</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; rpoplpush arr tmp
</span></span><span class=line><span class=cl><span class=s2>&#34;3&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; lrange arr <span class=m>0</span> -1
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;5&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; lrange tmp <span class=m>0</span> -1
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;3&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><h2 id=set集合>set集合<a hidden class=anchor aria-hidden=true href=#set集合>#</a></h2><p>Redis集合是未排序的集合,其元素是二进制安全的字符串。sadd命令可以向集合添加一个新元素。和sets相关的操作也有许多,比如检测某个元素是否存在,以及实现交集,并集,差集等等。</p><h3 id=创建并向集合插入新元素>创建并向集合插入新元素<a hidden class=anchor aria-hidden=true href=#创建并向集合插入新元素>#</a></h3><blockquote><p><strong>sadd：向集合内添加一个或多个元素</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; sadd <span class=nb>set</span> a b c d <span class=c1>#&lt;==向集合key中增加元素</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>4</span> </span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>smembers：查看集合内所有元素</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; smembers <span class=nb>set</span> <span class=c1>#&lt;==返回集合中的所有元素</span>
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;d&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;c&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;b&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;a&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=删除集合中元素>删除集合中元素<a hidden class=anchor aria-hidden=true href=#删除集合中元素>#</a></h3><blockquote><p><strong>sadd：从集合内删除一个或多个指定元素</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; srem <span class=nb>set</span> a <span class=c1>#&lt;==删除集合中名为a的元素</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; smembers <span class=nb>set</span>
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;d&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;c&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;b&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=查看集合内元素>查看集合内元素<a hidden class=anchor aria-hidden=true href=#查看集合内元素>#</a></h3><blockquote><p><strong>sismember：检查集合中是否存在某个元素</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; sismember <span class=nb>set</span> a
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; sismember <span class=nb>set</span> b
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>srandmember：返回元素中指定个数的随机元素</strong></p></blockquote><p>语法 srandmember key [count]</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; srandmember <span class=nb>set</span>  <span class=m>2</span>
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;d&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;b&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>scard返回元素中的个数</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; scard <span class=nb>set</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>3</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=移动集合内元素>移动集合内元素<a hidden class=anchor aria-hidden=true href=#移动集合内元素>#</a></h3><blockquote><p><strong>smove：将source里的member移动到destination集合中</strong></p></blockquote><p>语法：SMOVE source destination member</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; keys *
</span></span><span class=line><span class=cl><span class=o>(</span>empty list or <span class=nb>set</span><span class=o>)</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; sadd <span class=nb>set</span> a b c d e
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>5</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; smove <span class=nb>set</span> tmp e
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; keys *
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;set&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;tmp&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; smembers tmp
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;e&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; smembers <span class=nb>set</span>
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;c&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;b&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;a&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;d&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><p>“b”是这个集合的成员,而“b”不是。集合特别适合表现对象之间的关系。例如<font style=background:#bafe01 size=2>用Redis集合可以很容易实现标签功能</font>。</p><p>下面是一个简单的方案:对每个想加标签的对象,用一个标签ID集合与之关联,并且对每个已有的标签,一组对象ID与之关联。</p><p>例如假设我们的新闻ID=1000被加了三个tag 1,2,5就可以设置下面两个集合</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; sadd news:1000:tags <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; sadd news:1000:tags <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; sadd news:1000:tags <span class=m>5</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; smembers news:1000:tags
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;5&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><p>而有些看上去并不简单的操作仍然能使用相应的redis命令轻松实现。例如我们也许想获得一份同时拥有标签1,2,10和27的对象列表。这可以用SINTER命令来做,他可以在不同集合之间取出交集。</p><p>tags:1:obj tags:2:obj tags:5:obj tags:27:obj</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; smembers test1
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;3&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; smembers test4
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;9&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; sinter test1 test4
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;2&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=集合计算>集合计算<a hidden class=anchor aria-hidden=true href=#集合计算>#</a></h3><p><em><strong>创建一个集合</strong></em></p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; sadd A <span class=m>1</span> <span class=m>2</span> <span class=m>3</span> <span class=m>4</span> <span class=m>5</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>5</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; sadd B <span class=m>1</span> <span class=m>3</span> <span class=m>4</span> <span class=m>5</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>4</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; sadd C <span class=m>1</span> <span class=m>2</span> <span class=m>6</span> <span class=m>7</span> <span class=m>8</span> <span class=m>9</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>6</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>sinter：取出指定集合内的交集</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; sinter A B  <span class=c1>#&lt;==取出A B两个集合中的交集</span>
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;1&#34;</span> 
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;3&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;4&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;5&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; sinter A B C
</span></span><span class=line><span class=cl>1<span class=o>)</span><span class=s2>&#34;1&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>sinterstore：将多个集合的交集放入另一个集合内</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; sinterstore tmp A B  <span class=c1>#&lt;== 将A B集合中的交集放置在tmp集合中</span>
</span></span><span class=line><span class=cl>2<span class=o>)(</span>integer<span class=o>)</span> <span class=m>4</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span>127.0.0.1:6379&gt; smembers tmp
</span></span><span class=line><span class=cl>4<span class=o>)</span>1<span class=o>)</span> <span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>5<span class=o>)</span>2<span class=o>)</span> <span class=s2>&#34;3&#34;</span>
</span></span><span class=line><span class=cl>6<span class=o>)</span>3<span class=o>)</span> <span class=s2>&#34;4&#34;</span>
</span></span><span class=line><span class=cl>7<span class=o>)</span>4<span class=o>)</span> <span class=s2>&#34;5&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>sunion获得多个集合的并集</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; sunion A B
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;3&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;4&#34;</span>
</span></span><span class=line><span class=cl>5<span class=o>)</span> <span class=s2>&#34;5&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>sdiff获得多个集合的差</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; sdiff A B
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;2&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><h2 id=有序集合>有序集合<a hidden class=anchor aria-hidden=true href=#有序集合>#</a></h2><p>集合是使用频率很高的数据类型,但是…对许多问题来说他们也有点儿太不讲顺序了；因此Redis1.2引入了有序集合。他和集合非常相似,也是二进制安全的字符串集合,但是这次带有关联的score,以及一个类似lrange的操作可以返回有序元素,此操作只能作用于有序集合,它就是,zrange命令。</p><p>基本上有序集合从某种程度上说是SQL世界的索引在Redis中的等价物。例如在上面提到的reddit.com例子中,并祥有提到如何根据用户投票和时间因素将新闻组合生成首页。我们将看到有序集合如何解决这个问题,但最好先从更简单的事情开始,阐明这个高级数据类型是如何工作的.让我们添加几个黑客,并将他们的生日作为"score"。</p><h3 id=添加并查看有序集合>添加并查看有序集合<a hidden class=anchor aria-hidden=true href=#添加并查看有序集合>#</a></h3><blockquote><p><strong>添加一个或多个成员到一个集合,如果这个成员存在,则更新其排序分数</strong></p></blockquote><p>语法：ZADD key [NX|XX] [CH] [INCR] score member [score member &mldr;]</p><p><em><strong>选项详解</strong></em></p><table><thead><tr><th style=text-align:center>参数</th><th style=text-align:left>解释</th></tr></thead><tbody><tr><td style=text-align:center>XX</td><td style=text-align:left>仅更新已经存在的元素。不要添加元素。</td></tr><tr><td style=text-align:center>NX</td><td style=text-align:left>不要更新现有的元素。始终添加新元素。</td></tr><tr><td style=text-align:center>CH</td><td style=text-align:left>从添加的新元素的数量修改返回值,改变元素的总数（CH是更改的缩写）。已更改的元素是添加的新元素,已经存在的元素已更新。所以在命令行中指定的具有与过去相同的分数的元素不计算在内。注意：通常,ZADD的返回值仅计算添加的新元素的数量。</td></tr><tr><td style=text-align:center>INCR</td><td style=text-align:left>当指定此选项时,ZADD的行为就像ZINCRBY。在此模式下只能指定一个记分元素对。</td></tr></tbody></table><p><strong>创建一个集合</strong></p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; zadd hacker <span class=m>1953</span> zhangfei <span class=m>1963</span> zhaoyun <span class=m>1989</span> wangping <span class=m>1992</span> zhugeliang <span class=m>1945</span> liubei
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>5</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; zadd hacker <span class=m>100</span> zhugeliang
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; zrange hacker <span class=m>0</span> -1
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;zhugeliang&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;liubei&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;zhangfei&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;zhaoyun&#34;</span>
</span></span><span class=line><span class=cl>5<span class=o>)</span> <span class=s2>&#34;wangping&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>查看某个元素在集合内的位置</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; zscore code_lag py
</span></span><span class=line><span class=cl><span class=s2>&#34;4&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><p>对有序集合采说,按生日排序返回这些数据易如反掌,因为他们已经是有序的。有序集合是通过一个dual-ported数据结构实现的,它包含一个精简的有序列表和一个hash table,因此添加一个元素的时间复杂度是O(log(N))。这还行,但当我们需要访问有序的元素时,Redis不必再做任何事情,它已经是有序的了。</p><h3 id=对集合的值排序>对集合的值排序<a hidden class=anchor aria-hidden=true href=#对集合的值排序>#</a></h3><blockquote><p><strong>通过索引查看一个有序集合的范围</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; zrange hacker <span class=m>0</span> -1 withscores  <span class=c1>#&lt;==打印score</span>
</span></span><span class=line><span class=cl> 1<span class=o>)</span> <span class=s2>&#34;liubei&#34;</span>
</span></span><span class=line><span class=cl> 2<span class=o>)</span> <span class=s2>&#34;1945&#34;</span>
</span></span><span class=line><span class=cl> 3<span class=o>)</span> <span class=s2>&#34;zhangfei&#34;</span>
</span></span><span class=line><span class=cl> 4<span class=o>)</span> <span class=s2>&#34;1953&#34;</span>
</span></span><span class=line><span class=cl> 5<span class=o>)</span> <span class=s2>&#34;zhaoyun&#34;</span>
</span></span><span class=line><span class=cl> 6<span class=o>)</span> <span class=s2>&#34;1988&#34;</span>
</span></span><span class=line><span class=cl> 7<span class=o>)</span> <span class=s2>&#34;wangping&#34;</span>
</span></span><span class=line><span class=cl> 8<span class=o>)</span> <span class=s2>&#34;1989&#34;</span>
</span></span><span class=line><span class=cl> 9<span class=o>)</span> <span class=s2>&#34;zhugeliang&#34;</span>
</span></span><span class=line><span class=cl>10<span class=o>)</span> <span class=s2>&#34;1992&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>通过指定索引范围查看有序集合列表（倒序）</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; zrevrange hacker <span class=m>0</span> -1 withscores
</span></span><span class=line><span class=cl> 1<span class=o>)</span> <span class=s2>&#34;zhugeliang&#34;</span>
</span></span><span class=line><span class=cl> 2<span class=o>)</span> <span class=s2>&#34;1992&#34;</span>
</span></span><span class=line><span class=cl> 3<span class=o>)</span> <span class=s2>&#34;wangping&#34;</span>
</span></span><span class=line><span class=cl> 4<span class=o>)</span> <span class=s2>&#34;1989&#34;</span>
</span></span><span class=line><span class=cl> 5<span class=o>)</span> <span class=s2>&#34;zhaoyun&#34;</span>
</span></span><span class=line><span class=cl> 6<span class=o>)</span> <span class=s2>&#34;1988&#34;</span>
</span></span><span class=line><span class=cl> 7<span class=o>)</span> <span class=s2>&#34;zhangfei&#34;</span>
</span></span><span class=line><span class=cl> 8<span class=o>)</span> <span class=s2>&#34;1953&#34;</span>
</span></span><span class=line><span class=cl> 9<span class=o>)</span> <span class=s2>&#34;liubei&#34;</span>
</span></span><span class=line><span class=cl>10<span class=o>)</span><span class=s2>&#34;1945&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=查看集合中的元素个数>查看集合中的元素个数<a hidden class=anchor aria-hidden=true href=#查看集合中的元素个数>#</a></h3><blockquote><p><strong>返回有序集合中元素的个数</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; zcard hacker   
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>8</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>返回min,max包括极值</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; zcount hacker <span class=m>1950</span> <span class=m>2000</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>7</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; zcount hacker <span class=o>(</span><span class=m>1950</span> <span class=o>(</span><span class=m>2000</span> <span class=c1>#&lt;==不包括极值的用法</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>4</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=查找集合区间的元素>查找集合区间的元素<a hidden class=anchor aria-hidden=true href=#查找集合区间的元素>#</a></h3><p>zrangebysocre：返回有序集合key的分数min与max之间的所有元素（等于min或max）。这些元素被认为是从低到高的顺序排列。min和max可以是-inf(无穷)和+inf(正无穷)，可以不需要知道的有序集合最高或最低score来获得元素。</p><blockquote><p><strong>获取1950年之前（两个极值也包含）出生的人</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; zrangebyscore hacker -inf <span class=m>1950</span> withscores
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;liubei&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;1945&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;jiangwie&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;1950&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>返回1950,1970区间内的值</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; zrangebyscore hacker <span class=m>1950</span> <span class=m>1970</span> withscores
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;jiangwie&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;1950&#34;</span> 
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;zhangfei&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;1953&#34;</span> </span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>使用)返回 1950,2000区间内的值</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; zrangebyscore hacker <span class=o>(</span><span class=m>1950</span> <span class=o>(</span><span class=m>2000</span> withscores
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;zhangfei&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;1953&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;zhaoyun&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;1988&#34;</span>
</span></span><span class=line><span class=cl>5<span class=o>)</span> <span class=s2>&#34;wangping&#34;</span>
</span></span><span class=line><span class=cl>6<span class=o>)</span> <span class=s2>&#34;1989&#34;</span>
</span></span><span class=line><span class=cl>7<span class=o>)</span> <span class=s2>&#34;zhugeliang&#34;</span>
</span></span><span class=line><span class=cl>8<span class=o>)</span> <span class=s2>&#34;1992&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>使用limit返回指定区间内的值</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; zrangebyscore hacker -inf +inf withscores limit <span class=m>0</span> <span class=m>3</span>
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;liubei&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;1945&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;jiangwie&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;1950&#34;</span>
</span></span><span class=line><span class=cl>5<span class=o>)</span> <span class=s2>&#34;zhangfei&#34;</span>
</span></span><span class=line><span class=cl>6<span class=o>)</span> <span class=s2>&#34;1953&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><p>zremrangebyscore这个名字虽然不算好,但他却非常有用,还会返回已删除的元素数量。</p><p>回到Reddit的例子，现在我们有个基于有序集合的像样方案来生成首页。用一个有序集合来包含最近几天的新闻(用zremrangebyscore不时的删除旧新闻).用一个后台任务从有序集合中获取所有元素,根据用户投票和新闻时间计算score,然后用新闻ID和scores关联生成reddit.home.page有序集合.要显示首页,我们只需闪电般的调用ZRANGE不时的从reddit.home.page有序集合中删除过旧的新闻也是为了让我们的系统总是工作在有限的新闻集合之上。
更新有序集合的scores.</p><p>结束这篇指南之前还有最后一个小贴士.有序集合scores可以在任何时候更新。只要用ZADD对有序集合内的元素操作就会更新它的score(和位置),时间复杂度是O(log(N)),因此即使大量更新,有序集合也是合适的。<font style=background:#bafe01 size=2>其中N是排序集合中的元素数，M是返回元素的数量。如果M是常数（例如，总是用LIMIT来询问前10个元素)，可以考虑O(log=(N))。</font></p><h3 id=计算交并集>计算交并集<a hidden class=anchor aria-hidden=true href=#计算交并集>#</a></h3><blockquote><p><strong>计算由numkeys指定个数的key的的交集，并将结果存储在其中destination</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; zadd k1 <span class=m>1</span> a <span class=m>2</span> b <span class=m>3</span> c
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>3</span>  <span class=c1>#&lt;==a b c相当于数组的key 1 2 3相当于数组的值</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; zadd k2 <span class=m>10</span> a <span class=m>20</span> b <span class=m>30</span> c
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>3</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; zinterstore tmp <span class=m>1</span> k1 k2
</span></span><span class=line><span class=cl><span class=o>(</span>error<span class=o>)</span> ERR syntax error <span class=c1>#&lt;==指定numkeys的数量和传参数量不一致会提示语法错误</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; zinterstore tmp <span class=m>2</span> k1 k2
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; zrange tmp <span class=m>0</span> -1 withscores
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;a&#34;</span> <span class=c1>#&lt;==可以看出默认的聚合方法是sum</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;11&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;b&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;22&#34;</span>
</span></span><span class=line><span class=cl>5<span class=o>)</span> <span class=s2>&#34;c&#34;</span>
</span></span><span class=line><span class=cl>6<span class=o>)</span> <span class=s2>&#34;33&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; zinterstore tmp <span class=m>2</span> k1 k2 weights <span class=m>2</span> <span class=m>1</span> aggregate sum
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>3</span>  <span class=c1>#&lt;==指定权重计算两个之间key之间的交集</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; zrange tmp <span class=m>0</span> -1 withscores
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;a&#34;</span> 
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;12&#34;</span> <span class=c1>#&lt;==k1 a=1权重为2 就等于2x1+10=12 </span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;b&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;24&#34;</span>
</span></span><span class=line><span class=cl>5<span class=o>)</span> <span class=s2>&#34;c&#34;</span>
</span></span><span class=line><span class=cl>6<span class=o>)</span> <span class=s2>&#34;36&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><h2 id=hash>hash<a hidden class=anchor aria-hidden=true href=#hash>#</a></h2><p>hash能够<font style=background:#bafe01 size=2>存储一个key对多个属性的数据</font> 如：<font color=#f8070d size=3><code>user.username user.password</code></font></p><h3 id=设置key中的域与值>设置key中的域与值<a hidden class=anchor aria-hidden=true href=#设置key中的域与值>#</a></h3><blockquote><p><strong>hset：将key中的field域设置为value，如果field域存在则覆盖原value，不存在则添加</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; hset user1 name zhangsan
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; hset user1 age <span class=m>12</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; hset user1 gender male
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>hmset：给key设置多个field域与值</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; hmset user2 name lisi age <span class=m>11</span> gender female
</span></span><span class=line><span class=cl>OK</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=获得key中的域和值>获得key中的域和值<a hidden class=anchor aria-hidden=true href=#获得key中的域和值>#</a></h3><blockquote><p><strong>hget：返回key中一个域的值</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; hget user1 name
</span></span><span class=line><span class=cl><span class=s2>&#34;zhangsan&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>hgetall：返回key中所有域和值</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; hgetall user1
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;name&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;zhangsan&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;age&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;12&#34;</span>
</span></span><span class=line><span class=cl>5<span class=o>)</span> <span class=s2>&#34;gender&#34;</span>
</span></span><span class=line><span class=cl>6<span class=o>)</span> <span class=s2>&#34;male&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>hmget：返回key中多个值</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; hmget user1 name age
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;zhangsan&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;12&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>hkeys：返回key中的所有域</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; hkeys user1
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;age&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;gender&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> </span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>hvals：返回key中的所有域的值</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; hvals user1
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;12&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;male&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=删除key>删除key<a hidden class=anchor aria-hidden=true href=#删除key>#</a></h3><blockquote><p><strong>hdel：删除key中一个或多个域</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; hdel user1 name
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; hgetall user1
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;age&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;12&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;gender&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;male&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=查看域信息>查看域信息<a hidden class=anchor aria-hidden=true href=#查看域信息>#</a></h3><blockquote><p><strong>hlen：返回key中域的个数</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; hlen user1
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>2</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>hexists：查看key中是否存在某个域</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; hexists user1 name
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; hexists user1 age
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>1</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>hstrlen：返回key中域的值的长度</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; HSTRLEN user2 gender
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>6</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=hash的原子操作>hash的原子操作<a hidden class=anchor aria-hidden=true href=#hash的原子操作>#</a></h3><blockquote><p><strong>hincrby：对域中的值增长value个(单位整型)</strong></p><blockquote><p>语法：hincrby key field increment</p></blockquote></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; hget user1 age
</span></span><span class=line><span class=cl><span class=s2>&#34;14&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; hincrby user1 age <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=o>(</span>integer<span class=o>)</span> <span class=m>16</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; hget user1 age
</span></span><span class=line><span class=cl><span class=s2>&#34;16&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><blockquote><p><strong>hincrbyfloat：对域中的值增长value(单位浮点型)</strong></p></blockquote><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>127.0.0.1:6379&gt; hincrbyfloat user1 age 0.3
</span></span><span class=line><span class=cl><span class=s2>&#34;16.3&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; hget user1 age
</span></span><span class=line><span class=cl><span class=s2>&#34;16.3&#34;</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; hincrbyfloat user1 age -2 <span class=c1>#&lt;==减少用负数即可</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;14.3&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><p>bitMap 可实现用很小的内存实现高效的存储。</p><p>HyperLogLog 超小内存唯一值计数。 12k来实现唯一值得计数</p><p>GEO 基于地理信息位置定位</p></div><div class=pe-copyright><hr><blockquote><p>本文为原创内容，版权归作者所有。如需转载，请在文章中声明本文标题及链接。</p><p>文章标题：redis数据类型</p><p>文章链接：<a href=https://www.oomkill.com/2016/11/redis-datatype/ target=_blank>https://www.oomkill.com/2016/11/redis-datatype/</a></p><p>许可协议：<a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></p></blockquote></div><div class=comments-separator></div><h3 class=relatedContentTitle>相关阅读</h3><ul class=relatedContent><li><a href=/2016/11/redis-install/><span>Redis安装</span></a></li><li><a href=/2016/11/redis-replication/><span>redis主从复制工作原理</span></a></li><li><a href=/2016/11/redis-subscribe-and-transaction/><span>redis事务与发布订阅</span></a></li><li><a href=/2016/11/redis-security/><span>redis安全相关配置</span></a></li><li><a href=/2016/11/redis-persist/><span>redis数据持久化</span></a></li></ul><div class=comments-separator></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.oomkill.com/tags/databases/>Databases</a></li></ul><nav class=paginav><a class=prev href=https://www.oomkill.com/2016/11/redis-persist/><span class=title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left" style="user-select:text"><line x1="19" y1="12" x2="5" y2="12" style="user-select:text"/><polyline points="12 19 5 12 12 5" style="user-select:text"/></polyline></svg>&nbsp;</span>
<span>redis数据持久化</span>
</a><a class=next href=https://www.oomkill.com/2016/11/redis-replication/><span class=title></span>
<span>redis主从复制工作原理&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select:text"><line x1="5" y1="12" x2="19" y2="12" style="user-select:text"/><polyline points="12 5 19 12 12 19" style="user-select:text"/></svg></span></a></nav></footer><div class=pe-comments-decoration><p class=pe-comments-title></p><p class=pe-comments-subtitle></p></div><div id=pe-comments></div><script src=/js/pe-go-comment.min.86a214102576ba5f9b7bdc29eed8d58dd56e34aef80b3c65c73ea9cc88443696.js integrity="sha256-hqIUECV2ul+be9wp7tjVjdVuNK74Czxlxz6pzIhENpY="></script><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const s={src:"https://giscus.app/client.js","data-repo":"cylonchau/cylonchau.github.io","data-repo-id":"R_kgDOIRlNSQ","data-category":"Announcements","data-category-id":"DIC_kwDOIRlNSc4CXy1U","data-mapping":"pathname","data-term":"posts/redis datatype","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":getStoredTheme(),"data-lang":"zh-TW","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(s).forEach(([t,n])=>e.setAttribute(t,n)),document.querySelector("#pe-comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme);const n=document.querySelector("#theme-toggle-float");n&&n.addEventListener("click",setGiscusTheme)})</script></article></main><footer class=footer><span>&copy; 2024 <a href=https://www.oomkill.com/>Cylon's Collection</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> on
<a href=https://pages.github.com/ rel=noopener target=_blank>GitHub Pages</a> & Theme
        <a href=https://github.com/tofuwine/PaperMod-PE rel=noopener target=_blank>PaperMod-PE</a></span><div class=busuanzi-footer style="font-family:helvetica neue,Helvetica,Arial,sans-serif;text-align:center;padding:4px 0;color:#999"><span id=busuanzi_container_site_pv style=margin-right:8px;font-size:.85em>本站总访问量<span id=busuanzi_value_site_pv style=font-weight:500>0</span>次
</span><span id=busuanzi_container_site_uv style=font-size:.85em>本站访客数<span id=busuanzi_value_site_uv style=font-weight:500>0</span>人次</span></div></footer><div class=pe-right-sidebar><a href=javascript:void(0); id=theme-toggle-float class=pe-float-btn><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</a><a href=#top class=pe-float-btn id=top-link><span id=pe-read-progress></span></a></div><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>