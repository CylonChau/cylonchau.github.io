<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>理解ldap - 什么是ldap | Cylon's Collection</title>
<meta name=keywords content="ldap,linux,ldap概述"><meta name=description content="什么是目录服务？ ==目录是一类为了浏览和搜索数据而设计的特殊的数据库==，例如：为人所熟知的微软公 司的活动目录（active directory）就是目录数据库的一种，目录服务是按照==树状形式==存储信息的，目录包含基于属性的描述性信息，并且支持高级的过滤功能。
http://www.openldap.org/doc/admin24/intro.html 一般来说，目录不支持大多数事务型数据库所支持的高吞吐量和复杂的更新操作。目录进行更新操作，可以说是要么全部，要么都不的原子操作。目录服务适合的业务应用在于提供大量的查询和搜索操作，而不是大量的写入操作。Ldap可以说是活动目录在linux系统上的一个开源实现。
为了保证目录数据的可用性和可靠性，在确保使用目录服务提供快速查询和搜索操作的同时，目录服务还提供了==主从服务器同步目录数据信息的能力==，这相当于传统的MySQL数据库的主从同步功能一样，可以最大限度的确保基于目录业务的服务持续可用性与提供并发查询能力，微软公司的活动目录（active directory）就有主域和备份域的说法。
广义的目录服务概念，可以用多种不同的方式来提供目录服务。不同的目录所允许存储的信息是不同的，在信息如何被引用、查询、更新以及防止未经授权的访问等问题上，不同的目录服务的处理方式也有诸多的不同。
例如：一些目录服务是本地的，只提供受限的服务（比如，单机上的finger服务）。另一些服务是大范围的（global），提供广阔得多的服务（比如面向整个因特网），大范围的服务通常是分布式的，这也就意味着数据是分布在多台机器上的，这些机器一起来提供目录服务，典型的大范围服务定义一个统一的名称空间（namespace）来给出一个相同的数据视图（data view），而不管你相对于数据所在的位置。DNS是一个典型的大范围分布式目录服务的例子。
http://www.openldap.org/faq/data/cache/595.html 什么是ldap？ 目录服务有两个国际标准，分别是X.500和LDAP。X.500是ITU定义的目录标准，而LDAP是基于TCP/IP的目录访问协议，是Intemet上目录服务的通用访问协议。
LDAP是 Lightweight Directory Access Protocol（轻量级目录访问协议）的缩写。正如它的名字所表明的那样，它是一个轻量级的目录访问协议，特指基于X.500的目录访问协议的简化版本。LDAP运行在 TCP/IP 或者其他的面向连接的传输服务之上。LDAP完整的技术规范由RFC2251“The Lightweight Directory Access Protocol（v3）”和其他几个在RFC3377中定义的文档组成。
LDAP是轻量目录访问协议（Lielhtweiglht Directory Access Protocol）的缩写。 LDAP标准实际上是在X.500标准基础上产生的一个简化版本。 什么是X.500？ X.500由ITU-T和ISO定义，它实际上不是一个协议，而是由一个==协议族==组成，包括了从X.501到X.525等一系列非常完整的目录服务协议。
从技术上来说，LDAP是一个到X.500目录服务的目录访问协议，X.500是一个OSI目录服务。最初，LDAP客户端通过网关访问X.500目录服务。网关在客户端和网关之间运行LDAP，而X.500目录访问协议（Directory Access Protocol，DAP），位于这个网关和X.500服务器之间。
LDAP是一个重量级的协议，在整个OSI协议栈上进行操作，而且需要占用大量的计算资源。而LDAP被设计为在TCP/IP层上操作，以小得多的代价实现了大多数LDAP的功能。
虽然LDAP仍旧可以通过网关访问X.500目录服务器，但是现在通常都是在X.500服务器上直接实现LDAP。
单独的LDAP守护程序openldap slapd，可以被看做是一个轻量级的X.500目录服务器。也就是说，它没有实现X.500完整的DAP协议。作为一个轻量级的目录服务器，slapd实现的仅仅是X.500模型的一个子集。
LDAP中的常用名词缩写及含义。
LDAP基本概念中的常用名词缩写及含义
关 键字 英文全称 含 义 dc Domain Component 城名的部分，其格式是将完整的城名分成几部分，如域名为exaple.com变成dc=exaple,dc=com uid User Id 用户ID，如 “oldboy”。 ou Organization Unit 组织单位，类似于Limux文件系统中的子目录，它是一个容器对象，组织单位可以包含其他各种对象（包括其他组织单元），如“tech，rongjunfeng，bingge” cn Common Name 公共名称，如 “Thowas Johansson” sn Surnase 姓，如 “Johansson” dn Distinguished Name 唯一辨别名，类似于Linux文件系统中的绝对路径，每个对象都有一个唯一的名称，如uid=tos,ou=market,dc=example,dc=com，在一个目录树中 总是唯一的。 rdn Relative dn 相对辨别名，类似于文件系统中的相对路径，它是与目录树结构无关的部分，如uid=tom或cn=Thoeas Johansscn。 c Country 国家，如“CN”或“US”等 o organizatione 组织名，如“Example，Inc."><meta name=author content="cylon"><link rel=canonical href=https://www.oomkill.com/2019/08/ch1-understanding-ldap/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://www.oomkill.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.oomkill.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.oomkill.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.oomkill.com/favicon.ico><link rel=mask-icon href=https://www.oomkill.com/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://www.oomkill.com/2019/08/ch1-understanding-ldap/><noscript><style>#theme-toggle,#top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link crossorigin=anonymous href=/assets/css/pe.min.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/pe.min.js></script><link rel=stylesheet href=https://cdn.staticfile.net/font-awesome/6.5.1/css/all.min.css><link rel=stylesheet href=https://cdn.staticfile.net/font-awesome/6.5.1/css/v4-shims.min.css><script defer src=https://cdn.staticfile.net/jquery/3.5.1/jquery.min.js></script><link rel=stylesheet href=https://cdn.staticfile.net/fancybox/3.5.7/jquery.fancybox.min.css><script defer src=https://cdn.staticfile.net/fancybox/3.5.7/jquery.fancybox.min.js></script><script id=MathJax-script async src=https://cdn.staticfile.net/mathjax/3.2.2/es5/tex-chtml.js></script><script>MathJax={tex:{displayMath:[["$$","$$"]],inlineMath:[["\\$","\\$"]]}}</script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><meta name=referrer content="no-referrer-when-downgrade"><meta property="og:title" content="理解ldap - 什么是ldap"><meta property="og:description" content="什么是目录服务？ ==目录是一类为了浏览和搜索数据而设计的特殊的数据库==，例如：为人所熟知的微软公 司的活动目录（active directory）就是目录数据库的一种，目录服务是按照==树状形式==存储信息的，目录包含基于属性的描述性信息，并且支持高级的过滤功能。
http://www.openldap.org/doc/admin24/intro.html 一般来说，目录不支持大多数事务型数据库所支持的高吞吐量和复杂的更新操作。目录进行更新操作，可以说是要么全部，要么都不的原子操作。目录服务适合的业务应用在于提供大量的查询和搜索操作，而不是大量的写入操作。Ldap可以说是活动目录在linux系统上的一个开源实现。
为了保证目录数据的可用性和可靠性，在确保使用目录服务提供快速查询和搜索操作的同时，目录服务还提供了==主从服务器同步目录数据信息的能力==，这相当于传统的MySQL数据库的主从同步功能一样，可以最大限度的确保基于目录业务的服务持续可用性与提供并发查询能力，微软公司的活动目录（active directory）就有主域和备份域的说法。
广义的目录服务概念，可以用多种不同的方式来提供目录服务。不同的目录所允许存储的信息是不同的，在信息如何被引用、查询、更新以及防止未经授权的访问等问题上，不同的目录服务的处理方式也有诸多的不同。
例如：一些目录服务是本地的，只提供受限的服务（比如，单机上的finger服务）。另一些服务是大范围的（global），提供广阔得多的服务（比如面向整个因特网），大范围的服务通常是分布式的，这也就意味着数据是分布在多台机器上的，这些机器一起来提供目录服务，典型的大范围服务定义一个统一的名称空间（namespace）来给出一个相同的数据视图（data view），而不管你相对于数据所在的位置。DNS是一个典型的大范围分布式目录服务的例子。
http://www.openldap.org/faq/data/cache/595.html 什么是ldap？ 目录服务有两个国际标准，分别是X.500和LDAP。X.500是ITU定义的目录标准，而LDAP是基于TCP/IP的目录访问协议，是Intemet上目录服务的通用访问协议。
LDAP是 Lightweight Directory Access Protocol（轻量级目录访问协议）的缩写。正如它的名字所表明的那样，它是一个轻量级的目录访问协议，特指基于X.500的目录访问协议的简化版本。LDAP运行在 TCP/IP 或者其他的面向连接的传输服务之上。LDAP完整的技术规范由RFC2251“The Lightweight Directory Access Protocol（v3）”和其他几个在RFC3377中定义的文档组成。
LDAP是轻量目录访问协议（Lielhtweiglht Directory Access Protocol）的缩写。 LDAP标准实际上是在X.500标准基础上产生的一个简化版本。 什么是X.500？ X.500由ITU-T和ISO定义，它实际上不是一个协议，而是由一个==协议族==组成，包括了从X.501到X.525等一系列非常完整的目录服务协议。
从技术上来说，LDAP是一个到X.500目录服务的目录访问协议，X.500是一个OSI目录服务。最初，LDAP客户端通过网关访问X.500目录服务。网关在客户端和网关之间运行LDAP，而X.500目录访问协议（Directory Access Protocol，DAP），位于这个网关和X.500服务器之间。
LDAP是一个重量级的协议，在整个OSI协议栈上进行操作，而且需要占用大量的计算资源。而LDAP被设计为在TCP/IP层上操作，以小得多的代价实现了大多数LDAP的功能。
虽然LDAP仍旧可以通过网关访问X.500目录服务器，但是现在通常都是在X.500服务器上直接实现LDAP。
单独的LDAP守护程序openldap slapd，可以被看做是一个轻量级的X.500目录服务器。也就是说，它没有实现X.500完整的DAP协议。作为一个轻量级的目录服务器，slapd实现的仅仅是X.500模型的一个子集。
LDAP中的常用名词缩写及含义。
LDAP基本概念中的常用名词缩写及含义
关 键字 英文全称 含 义 dc Domain Component 城名的部分，其格式是将完整的城名分成几部分，如域名为exaple.com变成dc=exaple,dc=com uid User Id 用户ID，如 “oldboy”。 ou Organization Unit 组织单位，类似于Limux文件系统中的子目录，它是一个容器对象，组织单位可以包含其他各种对象（包括其他组织单元），如“tech，rongjunfeng，bingge” cn Common Name 公共名称，如 “Thowas Johansson” sn Surnase 姓，如 “Johansson” dn Distinguished Name 唯一辨别名，类似于Linux文件系统中的绝对路径，每个对象都有一个唯一的名称，如uid=tos,ou=market,dc=example,dc=com，在一个目录树中 总是唯一的。 rdn Relative dn 相对辨别名，类似于文件系统中的相对路径，它是与目录树结构无关的部分，如uid=tom或cn=Thoeas Johansscn。 c Country 国家，如“CN”或“US”等 o organizatione 组织名，如“Example，Inc."><meta property="og:type" content="article"><meta property="og:url" content="https://www.oomkill.com/2019/08/ch1-understanding-ldap/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-08-23T00:00:00+00:00"><meta property="article:modified_time" content="2022-11-28T23:00:36+08:00"><meta property="og:site_name" content="Cylon's Collection"><meta name=twitter:card content="summary"><meta name=twitter:title content="理解ldap - 什么是ldap"><meta name=twitter:description content="什么是目录服务？ ==目录是一类为了浏览和搜索数据而设计的特殊的数据库==，例如：为人所熟知的微软公 司的活动目录（active directory）就是目录数据库的一种，目录服务是按照==树状形式==存储信息的，目录包含基于属性的描述性信息，并且支持高级的过滤功能。
http://www.openldap.org/doc/admin24/intro.html 一般来说，目录不支持大多数事务型数据库所支持的高吞吐量和复杂的更新操作。目录进行更新操作，可以说是要么全部，要么都不的原子操作。目录服务适合的业务应用在于提供大量的查询和搜索操作，而不是大量的写入操作。Ldap可以说是活动目录在linux系统上的一个开源实现。
为了保证目录数据的可用性和可靠性，在确保使用目录服务提供快速查询和搜索操作的同时，目录服务还提供了==主从服务器同步目录数据信息的能力==，这相当于传统的MySQL数据库的主从同步功能一样，可以最大限度的确保基于目录业务的服务持续可用性与提供并发查询能力，微软公司的活动目录（active directory）就有主域和备份域的说法。
广义的目录服务概念，可以用多种不同的方式来提供目录服务。不同的目录所允许存储的信息是不同的，在信息如何被引用、查询、更新以及防止未经授权的访问等问题上，不同的目录服务的处理方式也有诸多的不同。
例如：一些目录服务是本地的，只提供受限的服务（比如，单机上的finger服务）。另一些服务是大范围的（global），提供广阔得多的服务（比如面向整个因特网），大范围的服务通常是分布式的，这也就意味着数据是分布在多台机器上的，这些机器一起来提供目录服务，典型的大范围服务定义一个统一的名称空间（namespace）来给出一个相同的数据视图（data view），而不管你相对于数据所在的位置。DNS是一个典型的大范围分布式目录服务的例子。
http://www.openldap.org/faq/data/cache/595.html 什么是ldap？ 目录服务有两个国际标准，分别是X.500和LDAP。X.500是ITU定义的目录标准，而LDAP是基于TCP/IP的目录访问协议，是Intemet上目录服务的通用访问协议。
LDAP是 Lightweight Directory Access Protocol（轻量级目录访问协议）的缩写。正如它的名字所表明的那样，它是一个轻量级的目录访问协议，特指基于X.500的目录访问协议的简化版本。LDAP运行在 TCP/IP 或者其他的面向连接的传输服务之上。LDAP完整的技术规范由RFC2251“The Lightweight Directory Access Protocol（v3）”和其他几个在RFC3377中定义的文档组成。
LDAP是轻量目录访问协议（Lielhtweiglht Directory Access Protocol）的缩写。 LDAP标准实际上是在X.500标准基础上产生的一个简化版本。 什么是X.500？ X.500由ITU-T和ISO定义，它实际上不是一个协议，而是由一个==协议族==组成，包括了从X.501到X.525等一系列非常完整的目录服务协议。
从技术上来说，LDAP是一个到X.500目录服务的目录访问协议，X.500是一个OSI目录服务。最初，LDAP客户端通过网关访问X.500目录服务。网关在客户端和网关之间运行LDAP，而X.500目录访问协议（Directory Access Protocol，DAP），位于这个网关和X.500服务器之间。
LDAP是一个重量级的协议，在整个OSI协议栈上进行操作，而且需要占用大量的计算资源。而LDAP被设计为在TCP/IP层上操作，以小得多的代价实现了大多数LDAP的功能。
虽然LDAP仍旧可以通过网关访问X.500目录服务器，但是现在通常都是在X.500服务器上直接实现LDAP。
单独的LDAP守护程序openldap slapd，可以被看做是一个轻量级的X.500目录服务器。也就是说，它没有实现X.500完整的DAP协议。作为一个轻量级的目录服务器，slapd实现的仅仅是X.500模型的一个子集。
LDAP中的常用名词缩写及含义。
LDAP基本概念中的常用名词缩写及含义
关 键字 英文全称 含 义 dc Domain Component 城名的部分，其格式是将完整的城名分成几部分，如域名为exaple.com变成dc=exaple,dc=com uid User Id 用户ID，如 “oldboy”。 ou Organization Unit 组织单位，类似于Limux文件系统中的子目录，它是一个容器对象，组织单位可以包含其他各种对象（包括其他组织单元），如“tech，rongjunfeng，bingge” cn Common Name 公共名称，如 “Thowas Johansson” sn Surnase 姓，如 “Johansson” dn Distinguished Name 唯一辨别名，类似于Linux文件系统中的绝对路径，每个对象都有一个唯一的名称，如uid=tos,ou=market,dc=example,dc=com，在一个目录树中 总是唯一的。 rdn Relative dn 相对辨别名，类似于文件系统中的相对路径，它是与目录树结构无关的部分，如uid=tom或cn=Thoeas Johansscn。 c Country 国家，如“CN”或“US”等 o organizatione 组织名，如“Example，Inc."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.oomkill.com/posts/"},{"@type":"ListItem","position":2,"name":"理解ldap - 什么是ldap","item":"https://www.oomkill.com/2019/08/ch1-understanding-ldap/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"理解ldap - 什么是ldap","name":"理解ldap - 什么是ldap","description":"什么是目录服务？ ==目录是一类为了浏览和搜索数据而设计的特殊的数据库==，例如：为人所熟知的微软公 司的活动目录（active directory）就是目录数据库的一种，目录服务是按照==树状形式==存储信息的，目录包含基于属性的描述性信息，并且支持高级的过滤功能。\nhttp://www.openldap.org/doc/admin24/intro.html 一般来说，目录不支持大多数事务型数据库所支持的高吞吐量和复杂的更新操作。目录进行更新操作，可以说是要么全部，要么都不的原子操作。目录服务适合的业务应用在于提供大量的查询和搜索操作，而不是大量的写入操作。Ldap可以说是活动目录在linux系统上的一个开源实现。\n为了保证目录数据的可用性和可靠性，在确保使用目录服务提供快速查询和搜索操作的同时，目录服务还提供了==主从服务器同步目录数据信息的能力==，这相当于传统的MySQL数据库的主从同步功能一样，可以最大限度的确保基于目录业务的服务持续可用性与提供并发查询能力，微软公司的活动目录（active directory）就有主域和备份域的说法。\n广义的目录服务概念，可以用多种不同的方式来提供目录服务。不同的目录所允许存储的信息是不同的，在信息如何被引用、查询、更新以及防止未经授权的访问等问题上，不同的目录服务的处理方式也有诸多的不同。\n例如：一些目录服务是本地的，只提供受限的服务（比如，单机上的finger服务）。另一些服务是大范围的（global），提供广阔得多的服务（比如面向整个因特网），大范围的服务通常是分布式的，这也就意味着数据是分布在多台机器上的，这些机器一起来提供目录服务，典型的大范围服务定义一个统一的名称空间（namespace）来给出一个相同的数据视图（data view），而不管你相对于数据所在的位置。DNS是一个典型的大范围分布式目录服务的例子。\nhttp://www.openldap.org/faq/data/cache/595.html 什么是ldap？ 目录服务有两个国际标准，分别是X.500和LDAP。X.500是ITU定义的目录标准，而LDAP是基于TCP/IP的目录访问协议，是Intemet上目录服务的通用访问协议。\nLDAP是 Lightweight Directory Access Protocol（轻量级目录访问协议）的缩写。正如它的名字所表明的那样，它是一个轻量级的目录访问协议，特指基于X.500的目录访问协议的简化版本。LDAP运行在 TCP/IP 或者其他的面向连接的传输服务之上。LDAP完整的技术规范由RFC2251“The Lightweight Directory Access Protocol（v3）”和其他几个在RFC3377中定义的文档组成。\nLDAP是轻量目录访问协议（Lielhtweiglht Directory Access Protocol）的缩写。 LDAP标准实际上是在X.500标准基础上产生的一个简化版本。 什么是X.500？ X.500由ITU-T和ISO定义，它实际上不是一个协议，而是由一个==协议族==组成，包括了从X.501到X.525等一系列非常完整的目录服务协议。\n从技术上来说，LDAP是一个到X.500目录服务的目录访问协议，X.500是一个OSI目录服务。最初，LDAP客户端通过网关访问X.500目录服务。网关在客户端和网关之间运行LDAP，而X.500目录访问协议（Directory Access Protocol，DAP），位于这个网关和X.500服务器之间。\nLDAP是一个重量级的协议，在整个OSI协议栈上进行操作，而且需要占用大量的计算资源。而LDAP被设计为在TCP/IP层上操作，以小得多的代价实现了大多数LDAP的功能。\n虽然LDAP仍旧可以通过网关访问X.500目录服务器，但是现在通常都是在X.500服务器上直接实现LDAP。\n单独的LDAP守护程序openldap slapd，可以被看做是一个轻量级的X.500目录服务器。也就是说，它没有实现X.500完整的DAP协议。作为一个轻量级的目录服务器，slapd实现的仅仅是X.500模型的一个子集。\nLDAP中的常用名词缩写及含义。\nLDAP基本概念中的常用名词缩写及含义\n关 键字 英文全称 含 义 dc Domain Component 城名的部分，其格式是将完整的城名分成几部分，如域名为exaple.com变成dc=exaple,dc=com uid User Id 用户ID，如 “oldboy”。 ou Organization Unit 组织单位，类似于Limux文件系统中的子目录，它是一个容器对象，组织单位可以包含其他各种对象（包括其他组织单元），如“tech，rongjunfeng，bingge” cn Common Name 公共名称，如 “Thowas Johansson” sn Surnase 姓，如 “Johansson” dn Distinguished Name 唯一辨别名，类似于Linux文件系统中的绝对路径，每个对象都有一个唯一的名称，如uid=tos,ou=market,dc=example,dc=com，在一个目录树中 总是唯一的。 rdn Relative dn 相对辨别名，类似于文件系统中的相对路径，它是与目录树结构无关的部分，如uid=tom或cn=Thoeas Johansscn。 c Country 国家，如“CN”或“US”等 o organizatione 组织名，如“Example，Inc.","keywords":["ldap","linux","ldap概述"],"articleBody":"什么是目录服务？ ==目录是一类为了浏览和搜索数据而设计的特殊的数据库==，例如：为人所熟知的微软公 司的活动目录（active directory）就是目录数据库的一种，目录服务是按照==树状形式==存储信息的，目录包含基于属性的描述性信息，并且支持高级的过滤功能。\nhttp://www.openldap.org/doc/admin24/intro.html 一般来说，目录不支持大多数事务型数据库所支持的高吞吐量和复杂的更新操作。目录进行更新操作，可以说是要么全部，要么都不的原子操作。目录服务适合的业务应用在于提供大量的查询和搜索操作，而不是大量的写入操作。Ldap可以说是活动目录在linux系统上的一个开源实现。\n为了保证目录数据的可用性和可靠性，在确保使用目录服务提供快速查询和搜索操作的同时，目录服务还提供了==主从服务器同步目录数据信息的能力==，这相当于传统的MySQL数据库的主从同步功能一样，可以最大限度的确保基于目录业务的服务持续可用性与提供并发查询能力，微软公司的活动目录（active directory）就有主域和备份域的说法。\n广义的目录服务概念，可以用多种不同的方式来提供目录服务。不同的目录所允许存储的信息是不同的，在信息如何被引用、查询、更新以及防止未经授权的访问等问题上，不同的目录服务的处理方式也有诸多的不同。\n例如：一些目录服务是本地的，只提供受限的服务（比如，单机上的finger服务）。另一些服务是大范围的（global），提供广阔得多的服务（比如面向整个因特网），大范围的服务通常是分布式的，这也就意味着数据是分布在多台机器上的，这些机器一起来提供目录服务，典型的大范围服务定义一个统一的名称空间（namespace）来给出一个相同的数据视图（data view），而不管你相对于数据所在的位置。DNS是一个典型的大范围分布式目录服务的例子。\nhttp://www.openldap.org/faq/data/cache/595.html 什么是ldap？ 目录服务有两个国际标准，分别是X.500和LDAP。X.500是ITU定义的目录标准，而LDAP是基于TCP/IP的目录访问协议，是Intemet上目录服务的通用访问协议。\nLDAP是 Lightweight Directory Access Protocol（轻量级目录访问协议）的缩写。正如它的名字所表明的那样，它是一个轻量级的目录访问协议，特指基于X.500的目录访问协议的简化版本。LDAP运行在 TCP/IP 或者其他的面向连接的传输服务之上。LDAP完整的技术规范由RFC2251“The Lightweight Directory Access Protocol（v3）”和其他几个在RFC3377中定义的文档组成。\nLDAP是轻量目录访问协议（Lielhtweiglht Directory Access Protocol）的缩写。 LDAP标准实际上是在X.500标准基础上产生的一个简化版本。 什么是X.500？ X.500由ITU-T和ISO定义，它实际上不是一个协议，而是由一个==协议族==组成，包括了从X.501到X.525等一系列非常完整的目录服务协议。\n从技术上来说，LDAP是一个到X.500目录服务的目录访问协议，X.500是一个OSI目录服务。最初，LDAP客户端通过网关访问X.500目录服务。网关在客户端和网关之间运行LDAP，而X.500目录访问协议（Directory Access Protocol，DAP），位于这个网关和X.500服务器之间。\nLDAP是一个重量级的协议，在整个OSI协议栈上进行操作，而且需要占用大量的计算资源。而LDAP被设计为在TCP/IP层上操作，以小得多的代价实现了大多数LDAP的功能。\n虽然LDAP仍旧可以通过网关访问X.500目录服务器，但是现在通常都是在X.500服务器上直接实现LDAP。\n单独的LDAP守护程序openldap slapd，可以被看做是一个轻量级的X.500目录服务器。也就是说，它没有实现X.500完整的DAP协议。作为一个轻量级的目录服务器，slapd实现的仅仅是X.500模型的一个子集。\nLDAP中的常用名词缩写及含义。\nLDAP基本概念中的常用名词缩写及含义\n关 键字 英文全称 含 义 dc Domain Component 城名的部分，其格式是将完整的城名分成几部分，如域名为exaple.com变成dc=exaple,dc=com uid User Id 用户ID，如 “oldboy”。 ou Organization Unit 组织单位，类似于Limux文件系统中的子目录，它是一个容器对象，组织单位可以包含其他各种对象（包括其他组织单元），如“tech，rongjunfeng，bingge” cn Common Name 公共名称，如 “Thowas Johansson” sn Surnase 姓，如 “Johansson” dn Distinguished Name 唯一辨别名，类似于Linux文件系统中的绝对路径，每个对象都有一个唯一的名称，如uid=tos,ou=market,dc=example,dc=com，在一个目录树中 总是唯一的。 rdn Relative dn 相对辨别名，类似于文件系统中的相对路径，它是与目录树结构无关的部分，如uid=tom或cn=Thoeas Johansscn。 c Country 国家，如“CN”或“US”等 o organizatione 组织名，如“Example，Inc.”。 LDAP目录服务的特点 LDAP（openldap）目录服务具有下列特点：\nLDAP是一个跨平台的、标准的协议，近几年来得到了业界广泛的认可。 LDAP的结构用树型结构来表示，而不是用表格。因此不用SQL语句维护了。 LDAP提供了静态数据的快速查询方式，但在更新数据方面并不擅长。 LDAP服务可以使用基于“推”或“拉”的复制信息技术，用简单的或基于安全证书的安全认证，复制部分或全部数据，既保证了数据的安全性，又提高了数据的访问效率： LDAP是一个安全的协议，LDAPv3支持SASL（Simple Authentication and Security Layer）、SSL（Secure Socket Layer）和TLS（Transport Layer Security），使用认证来确保事务的安全，另外，LDAP提供了不同层次的访问控制，以限制不同用户的访问权限。 LDAP支持异类数据存储，LDAP存储的数据可以是文本资料、二进制图片等。 Client/Server 模型：Server端用于存储树，Client端提供操作目录信息树的工具，通过这些工具，可以将数据库的内容以文本格式（LDAP数据交换格式，LDIF）呈现在我们的面前。 LDAP是一种开放Internet 标准，LDAP协议是跨平台的的Interent协议，它是基于X.500标准的，与X.500不同，LDAP支持TCP/IP（即可以分布式部署）。 LDAP的目录结构 LDAP目录服务是通过目录数据库来存储网络信息来提供目录服务的。为了方便用户迅速查找和定位信息，目录数据库是以目录信息树（Directory Infornation Tree，缩写为DIT）为存储方式的树型存储结构，目录信息树及其相关概念构成了LDAP协议的信息模型。\n在LDAP中，目录是按照树型结构组织一一目录信息树（Directory Information Tree简写DIT），DIT是一个主要进行读操作的数据库。 DIT由条目（Entry）组成，条目相当于关系数据库中的表的记录： 条目是具有分辨名DN（Distinguished Name）的属性-值对（Attribute-value，简称AV） 的集合。\n在UNIX文件系统中，最项层是根目录（root），LDAP目录通常也用ROOT做根，通常称为BaseDN。\n因为历史（X.500）的原因，LDAP目录用OU（Organization Unit）从逻辑上把数据分开来。Ou也是一种条目–==容器条目==。Ou下面即是真正的用户条目。\n什么是dn?\nDN，Distinguished Name，即分辨名。\n在LDAP中，一个条目的分辨名叫做“DN”，DN是该条目在整个树中的唯一名称标识，DN相当于关系数据席表中的关键字（Primary Key）；它是一个识别属性，通常用于检索。\nDN的两种设置\n基于cn（姓名），cn=test,ou=auth,dc=cylon,dc=org，最常见的cn是从 /etc/group 转来的条目。.\n基于uid（User ID），uid=test,ou=auth,dc=cylon,dc=org 最常见的uid是 /etc/passwd 转来的条目。\nBase DN\nLDAP目录树的最顶部就是根，也就是Base DN.\nLDIF格式\nLDIF格式是用于LDAP数据导入、导出的格式。LDIF是LDAP数据库信息的一种文本格式。BDB。\n什么样的信息可以存储在目录当中？\nLDAP的信息模型是基于条目的（entry）。一个条目就是一些具有全局唯一的标识名（Distinguished Name，简写做==DN==）的属性的集合。DN用于无二义性的指代一个唯一的条目，条目的每一个属性都有一个类型（type），一个或者多个值（value），类型（type）往往是特定字符串的简写，比如用 cn 指代 commpn name，或者 mail 指代电子邮件地址。值（value）的语法依赖于类型（type），比如，类型为cn的属性可能包含值Babs Jensen。 类型为mail的属性可能包含值 babs@example.com 。类型为jpegPhoto的属性可能包含二进制格式的JPEG图象。\n下面是LDAP中条目信息的例子；就相当于数据库表中的两行记录：\nLDAP允许你通过使用一种叫做 objectClass的特殊属性来控制哪些属性是条目所必须的，哪些属性是条目可选的，objectClass 属性的值是由条目所必须遵从的方案（schema） 来建义的。\n通过下面命令可以取出上面的内容。\nsh 1 ldapsearch -LLL -w oldboy -x -H ldap://10.0.0.20 -D \"cn=admin,dc=cylon,dc=org\" -b \"dc=cylon,dc=org\" uid=\"*\" 信息在目录中是如何组织的？\n在LDAP中，条目是按树状的层次结构组织的，传统上，这个结构往往是地理界限或者组织界限的反映。代表国家的条目位于整个目录树的顶层。之下的条目则代表各个州以及国家性的组织，再下面的条目则代表着组织单位、个人打印机、文件，或者你所能想到的其他东西，图1.1显示了按照传统命名方式组织的LDAP目录信息树。\n图1.1：LDAP目录树（传统命名方式） 目录树也可以按照因特网域名结构组织。因为它允许按照DNS对目录服务进行定位，这种命名方式正变得越来越受欢迎。图1.2显示了按照域名进行组织的一个LDAP目录树的例子。\nhttp://www.openldap.org/doc/admin24/intro.html root -\u003e 顶级域 -\u003e 二级 -\u003e ou -\u003e uid\n图1-2：LDAP目录树（域名命名方式） 例：dn:cn=testlb,ou=People,ou=accounts,dc=cylon,dc=org\n另外，LDAP允许你通过使用一种叫做objectClass的特殊属性来控制哪些属性是条目所必须的，哪些属性是条目可选的。objectClass属性的值是由条目所必须遵从的方案 （schema）来定义的。.\n（3）信息是如何械引用的？\n一个条目是通过它的标识名来引用的。而标识名是由相对标识名（Relative Distinguished Name或者RDN）和它的父条目名连在一起构成的。比如，在因特网命名的例子中，Barbara Jensen条目有相对标识名 uid=babs 和标识名为：uid=babs,ou=People,de=example,dc=com 。\nLDIF数据文件介绍 目录数据文件内容讲解\nLDIF（LDAP Data Interchangep-omat）轻量级目录交换格式）一种ASCII文件格式，用来交换数据并使得在LDAP服务器间交换数据成为可能。\nLDIF文件最常用的功能就是向目录导入或修改信息，这些信息的格式需要按照LDAP中架构（schema）格式组织，如果不符合其要求的格式就会出现错误。\nLDIF文件的特点：\n通过空行来分割一个条目或定义。 以#开始的行为注释。 所有属性的赋值方法为：\"属性: 属性值\" 例如，dn:dn=cylon,dc=org 属性可以被重复赋值。例如objectclass就可以有多个，每个属性独立一行。 每行的结尾不允许有空格。 在LDAP的每条记录中必须包含一个objectclass属性，且其需要赋子至少一个值。objectclass属性有等级之分，属性相当于变量，它可以被自定义赋值，值不能相同。\n目录数据展现的树形结构圆。以上ldif数据文件表现个内容为如下树形结构：ldap C/S工具呈现的。\nLDAP是想样工作的？ LDAP目录服务是基于 C/S模式的。一个或者多个LDAP服务器包含着组成整个目录信息树（DIT）的数据，客户端连接到服务器并且发出一个请求（request），然后服务器要么以一个回答（answer）子以回应，要么给出一个指针，客户可以通过此指针获取到所需的数据（通常，该指针是指向另一个LDAP服务器），无论客户端连到哪个LDAP服务器，它看到的都是同一个目录视图（view）.这是LDAP这类全局目录服务的一个重要特征。\nLDAP的几个重要配置模式 LDAP服务的几个重要功能：\n★★★基本的目录查询服务。 目录查询代理服务。 异机复制数据（即主从同步）。 本地基本的目录查询服务 在这种配置模式下，你的slapd只为你的本地域提供目录服务。它不会以任何方式与别的目录服务器交互。这种配置模式如图1所示。\n本地配置模式 带有指针（Referrals）的本地目录服务。 即目录查询代理服务，类似DNS的转发服务器。\n在这种配置模式下，你为你的本地域运行一个LDAP服务器，并且将它配置成为当客户的请求超出你的本地域的处理能力的时候能够返回一个指针，该指针指向一个具备处理客户请求能力的更高级的服务器的地址。你可以自己运行这一服务，也可以使用别人已提供给你的一个。这种配置模式如图2所示。：\n如果你想运行本地目录服务并且参与全属的目录，那么运行这种模式。例如：openldap作为微软活动目录的代理查询服务。\ntext 1 referral 该指令指定了一个指针，当服务器的slapd找不到一个本地的数据库来处理一个请求的时候，它把该指针回传给客户。\n示例：\ntext 1 referral ldap://root.openldap.org 这将把非本地的请求“推”到OpenLDAP的根服务器上。“聪明的” LDAP客户会向反馈回来的指针所指的服务器重新发出请求。但是得注意大多数客户仅仅知道怎么样处理简单的LDAP的URL，其中包含主机部分和可选的DN部分。\n同多复制的目录服务。 slarpd守护程序是用来将主slapd上的改变传播到一个或多个从属的slapd上。一个master-slave 类型的配置示例如图3所示。\n这种配置模式可以和前面的两种配置模式之一合起来使用，在前面的两种情况中，单独的slapd不能提供足够的可用性和可靠性。\n简单易用的同步复制目录方案。 利用inotify+ldap客户端命令方案，或者通过定时任务加上ldap客户端命令方案！举MYSQL同步的例子说明！\n分布式的目录服务。 在这种配置模式下，本地的服务被分制成为多个更小的服务，每一个都可能被复制，并且通过上级（superior）或者下级（subordinate）指针（referral）粘合起来。在实际工作中，使用主从同步集群比较多一些，跨机房就是通过openvpn同步。\nldap企业架构逻辑图案例：ldap+haproxy/nginx/hearbeat集群高可用，验证的时候不跨机房。\nLDAP服务的应用领域 LDAP目录服务，适合那些需要从不同的地点读取信息，但是不需要经常更新的业务信息最为有用。\nLDAP的应用主要涉及以下几种类型。I\n信息安全类：数字证书管理、授权管理、单点登录。 科学计算类：DCE（Distributed Computing Environment，分布式计算环境）、UDDI（Universal Description，Discovery and Integration，统一描述、发现和集成协议）。 网络资源管理类：MAIL系统、DNS系统、网络用户管理、电话号码簿。 电子政务资源管理类：内网组织信息服务、电子政务目录体系、人口基础库、法人基础库。 在工作中，常用ldap作为公司入职后的所有员工账号等的基础信息库，例如：邮件账号，电脑登陆账号、办公平台账号、共享服务账号、SVN账号、VPN账号、服务器的账号，无线网登陆账号等的公共账号登陆信息库。可以理解为企业的活动目录一样，另外，LDAP也可以和微软活动目录打通。\n画一个内网AD域，和机房的LDAP服务打通的架构图！\nLDAP服务的常见开源产品 Openldap是LDAP最好的开源实现，在其Openldap许可证下发行，并且已经被包含在众多流行的linux发行版中\n官方网站为 openldap.org\n官方man手册 http://www.openldap.org/software/man.cgi\nopenldap UI ldap的客户端管理接口有很多，有b/s结构的web的，也有c/s结构的，我们以b/s结构的 ldap-account-manager-3.7.tar.gz 软件为例进行讲解\nB/S 架构的 LDAP Account Manager C/S 架构的 LDAP Admin LDAP Account Manager LAM是php服务需要安装lamp环境\nbash 1 2 3 4 5 6 7 8 9 10 11 12 13 yum install -y\\ nginx \\ php \\ php-ldap \\ php-gd \\ php-fpm rpm -qa \\ nginx \\ php \\ php-ldap \\ php-gd \\ php-fpm 下载解压配置ldap客户端软件 下载地址：https://www.ldap-account-manager.org/lamcms/releases\ntext 1 2 3 4 5 6 7 8 cp config.cfg_sample config.cfg cp lam.conf_sample lam.conf sed -i 's@cn=Manager@cn=admin@g' lam.conf sed -i 's@dc=my-domain@dc=cylon@g' lam.conf sed -i 's@dc=com@dc=org@g' lam.conf diff lam.conf_sample lam.conf 提示： 此处改的地方很多\n配置nginx text 1 chown nginx.nginx /var/www/html/ldap -R text 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 worker_processes 1; events { worker_connections 1024; } http { include mime.types; default_type application/octet-stream; sendfile on; keepalive_timeout 65; server { listen 80; server_name localhost; location / { root /var/www/html; index index.html index.htm; } error_page 500 502 503 504 /50x.html; location = /50x.html { root html; } location ~ \\.php$ { fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; } } } LAM使用 步骤1：打开浏览器或者在前面的访问基础上刷新：http:/10.0.0.20/ldap，正常会出现界面如下图所示：\n步骤2：点击右上角的“LAMconfiguration”链接进行配置。\n步骤3：点击上图中的 “Edit general settings” 链接进行配置\n由于系统的密码为字母 “lam”，太简单了，我们先把密码改掉，其他的配置，我们根据需求以后可以再改，注意：这里是系统设置的权限密码，非页面上登录的密码。\n步骤5：上文点OK后就会到重新登录的界面进行登录，如下图：\n提示：\n请牢记，这是 ==ldap管理员用户admin及密码==，非前面设置的系统内部配置密码，ldap 管理员用户admin及密码是在配置openldap中生成的\n步骤6：初始化ldap数据库的域。\n步骤7：命令查看下刚才的操作帮我们建立了什么？。\ntext 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 $ ldapsearch -LLL -w 123 -x -H ldap://10.0.0.20 -D \"cn=admin,dc=cylon,dc=org\" -b \"dc=cylon,dc=org\" \"(uid=chau)\" dn: uid=chau,ou=People,dc=cylon,dc=org objectClass: posixAccount objectClass: inetOrgPerson objectClass: organizationalPerson objectClass: person homeDirectory: /home/chau loginShell: /bin/bash cn: cylon chau uidNumber: 10006 gidNumber: 10000 userPassword:: e1NTSEF9c0YzZzBSbnFBU1NoWEVBWEFSS1lPdG41WjZRR1pxNCs= sn: chau givenName: cylon uid: chau 步骤8：继续添加ldap账号和组。\ntext 1 2 3 4 5 dn: cn=tech,ou=group,dc=cylon,dc=org objectClass: posixGroup description:: 5oqA5pyv6Y0o gidNumber: 10001 cn: tech 添加用户\ntext 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 $ ldapsearch -LLL -w 123 -x -H ldap://10.0.0.20 -D \"cn=admin,dc=cylon,dc=org\" -b \"dc=cylon,dc=org\" \"(uid=cylon)\" dn: uid=cylon,ou=People,dc=cylon,dc=org objectClass: posixAccount objectClass: inetOrgPerson objectClass: organizationalPerson objectClass: person homeDirectory: /home/chau loginShell: /bin/bash cn: cylon chau uidNumber: 10006 userPassword:: e1NTSEF9c0YzZzBSbnFBU1NoWEVBWEFSS1lPdG41WjZRR1pxNCs= sn: chau givenName: cylon uid: cylon gidNumber: 10001 通过web接口管理ldap的配置完成！也已经初始化了用户组及用户\nphpldapadmin sh 1 2 3 4 5 6 7 8 9 10 11 yum install -y \\ php \\ php-fpm \\ php-ldap \\ php-gd \\ php-mbstring \\ php-pear \\ php-bcmath \\ php-xml \\ phpldapadmin \\ nginx nginx 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 worker_processes 1; events { worker_connections 1024; } http { include mime.types; default_type application/octet-stream; sendfile on; keepalive_timeout 65; server { listen 80; server_name localhost; root /usr/share/phpldapadmin/htdocs; location / { index index.html index.htm index.php; } error_page 500 502 503 504 /50x.html; location = /50x.html { root html; } location ~ \\.php$ { fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; } } } ","wordCount":"739","inLanguage":"zh","datePublished":"2019-08-23T00:00:00Z","dateModified":"2022-11-28T23:00:36+08:00","author":{"@type":"Person","name":"cylon"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.oomkill.com/2019/08/ch1-understanding-ldap/"},"publisher":{"@type":"Organization","name":"Cylon's Collection","logo":{"@type":"ImageObject","url":"https://www.oomkill.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.oomkill.com/><img src=https://www.oomkill.com/favicon.ico alt aria-label=logo height=20>Cylon's Collection</a><div class=logo-switches><button id=theme-toggle><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.oomkill.com/archives><span>归档</span></a></li><li><a href=https://www.oomkill.com/tags><span>标签</span></a></li><li><a href=https://www.oomkill.com/search><span>搜索</span></a></li><li><a href=https://www.oomkill.com/about accesskey=/><span>关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">理解ldap - 什么是ldap</h1><div class=post-meta><span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg><span>2019-08-23</span></span>&nbsp;·&nbsp;<span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select:text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z" style="user-select:text"/><polyline points="14 2 14 8 20 8" style="user-select:text"/><line x1="16" y1="13" x2="8" y2="13" style="user-select:text"/><line x1="16" y1="17" x2="8" y2="17" style="user-select:text"/><polyline points="10 9 9 9 8 9" style="user-select:text"/></svg><span>739 字</span></span>&nbsp;·&nbsp;<span class=pe-post-meta-item><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><span>4 分钟</span></span>
<span class=pe-post-meta-item>&nbsp;·&nbsp;<svg t="1714036239378" fill="currentcolor" class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="6659" width="256" height="256"><path d="M690 78.2c-18.6-18.8-49-19-67.8-.4s-19 49-.4 67.8l255.4 258.6c67.8 68.6 67.8 178.8.0 247.4L653.4 878.2c-18.6 18.8-18.4 49.2.4 67.8s49.2 18.4 67.8-.4l224-226.4c104.8-106 104.8-276.4.0-382.4L690 78.2zM485.4 101.4c-24-24-56.6-37.4-90.6-37.4H96C43 64 0 107 0 160v299c0 34 13.4 66.6 37.4 90.6l336 336c50 50 131 50 181 0l267-267c50-50 50-131 0-181l-336-336zM96 160h299c8.4.0 16.6 3.4 22.6 9.4l336 336c12.4 12.4 12.4 32.8.0 45.2l-267 267c-12.4 12.4-32.8 12.4-45.2.0l-336-336c-6-6-9.4-14.2-9.4-22.6V160zm192 128a64 64 0 10-128 0 64 64 0 10128 0z" p-id="6660"/></svg></span><ul class=pe-post-meta-item><a href=https://www.oomkill.com/tags/ldap/>#Ldap</a>
<a href=https://www.oomkill.com/tags/linux/>#Linux</a></ul>&nbsp;·&nbsp;<span id=busuanzi_container_page_pv>本文阅读量 <span id=busuanzi_value_page_pv></span> 次</span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details><summary><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e4%bb%80%e4%b9%88%e6%98%af%e7%9b%ae%e5%bd%95%e6%9c%8d%e5%8a%a1 aria-label=什么是目录服务？>什么是目录服务？</a><li><a href=#%e4%bb%80%e4%b9%88%e6%98%afldap aria-label=什么是ldap？>什么是ldap？</a><li><a href=#%e4%bb%80%e4%b9%88%e6%98%afx500 aria-label=什么是X.500？>什么是X.500？</a><li><a href=#ldap%e7%9b%ae%e5%bd%95%e6%9c%8d%e5%8a%a1%e7%9a%84%e7%89%b9%e7%82%b9 aria-label=LDAP目录服务的特点>LDAP目录服务的特点</a><li><a href=#ldap%e7%9a%84%e7%9b%ae%e5%bd%95%e7%bb%93%e6%9e%84 aria-label=LDAP的目录结构>LDAP的目录结构</a><ul><li><a href=#ldif%e6%95%b0%e6%8d%ae%e6%96%87%e4%bb%b6%e4%bb%8b%e7%bb%8d aria-label=LDIF数据文件介绍>LDIF数据文件介绍</a></ul><li><a href=#ldap%e6%98%af%e6%83%b3%e6%a0%b7%e5%b7%a5%e4%bd%9c%e7%9a%84 aria-label=LDAP是想样工作的？>LDAP是想样工作的？</a><li><a href=#ldap%e7%9a%84%e5%87%a0%e4%b8%aa%e9%87%8d%e8%a6%81%e9%85%8d%e7%bd%ae%e6%a8%a1%e5%bc%8f aria-label=LDAP的几个重要配置模式>LDAP的几个重要配置模式</a><ul><li><a href=#%e6%9c%ac%e5%9c%b0%e5%9f%ba%e6%9c%ac%e7%9a%84%e7%9b%ae%e5%bd%95%e6%9f%a5%e8%af%a2%e6%9c%8d%e5%8a%a1 aria-label=本地基本的目录查询服务>本地基本的目录查询服务</a><li><a href=#%e5%b8%a6%e6%9c%89%e6%8c%87%e9%92%88referrals%e7%9a%84%e6%9c%ac%e5%9c%b0%e7%9b%ae%e5%bd%95%e6%9c%8d%e5%8a%a1 aria-label=带有指针（Referrals）的本地目录服务。>带有指针（Referrals）的本地目录服务。</a><li><a href=#%e5%90%8c%e5%a4%9a%e5%a4%8d%e5%88%b6%e7%9a%84%e7%9b%ae%e5%bd%95%e6%9c%8d%e5%8a%a1 aria-label=同多复制的目录服务。>同多复制的目录服务。</a><li><a href=#%e7%ae%80%e5%8d%95%e6%98%93%e7%94%a8%e7%9a%84%e5%90%8c%e6%ad%a5%e5%a4%8d%e5%88%b6%e7%9b%ae%e5%bd%95%e6%96%b9%e6%a1%88 aria-label=简单易用的同步复制目录方案。>简单易用的同步复制目录方案。</a><li><a href=#%e5%88%86%e5%b8%83%e5%bc%8f%e7%9a%84%e7%9b%ae%e5%bd%95%e6%9c%8d%e5%8a%a1 aria-label=分布式的目录服务。>分布式的目录服务。</a></ul><li><a href=#ldap%e6%9c%8d%e5%8a%a1%e7%9a%84%e5%ba%94%e7%94%a8%e9%a2%86%e5%9f%9f aria-label=LDAP服务的应用领域>LDAP服务的应用领域</a><li><a href=#ldap%e6%9c%8d%e5%8a%a1%e7%9a%84%e5%b8%b8%e8%a7%81%e5%bc%80%e6%ba%90%e4%ba%a7%e5%93%81 aria-label=LDAP服务的常见开源产品>LDAP服务的常见开源产品</a><li><a href=#openldap-ui aria-label="openldap UI">openldap UI</a><ul><li><a href=#ldap-account-manager aria-label="LDAP Account Manager">LDAP Account Manager</a><li><a href=#%e4%b8%8b%e8%bd%bd%e8%a7%a3%e5%8e%8b%e9%85%8d%e7%bd%aeldap%e5%ae%a2%e6%88%b7%e7%ab%af%e8%bd%af%e4%bb%b6 aria-label=下载解压配置ldap客户端软件>下载解压配置ldap客户端软件</a><li><a href=#%e9%85%8d%e7%bd%aenginx aria-label=配置nginx>配置nginx</a><li><a href=#lam%e4%bd%bf%e7%94%a8 aria-label=LAM使用>LAM使用</a><li><a href=#phpldapadmin aria-label=phpldapadmin>phpldapadmin</a></li></div></details></div></aside><script src=/js/pe-toc.min.445eb1bfc5e85dd13b9519fcc2a806522e9629b6224a2974052789ba00ab78af.js integrity="sha256-RF6xv8XoXdE7lRn8wqgGUi6WKbYiSil0BSeJugCreK8="></script><div class=post-content><h2 id=什么是目录服务>什么是目录服务？<a hidden class=anchor aria-hidden=true href=#什么是目录服务>#</a></h2><p>==目录是一类为了浏览和搜索数据而设计的特殊的数据库==，例如：为人所熟知的微软公
司的活动目录（active directory）就是目录数据库的一种，目录服务是按照==树状形式==存储信息的，目录包含基于属性的描述性信息，并且支持高级的过滤功能。</p><ul><li><a href=http://www.openldap.org/doc/admin24/intro.html target=_blank rel="noopener nofollow noreferrer">http://www.openldap.org/doc/admin24/intro.html</a></li></ul><p>一般来说，目录不支持大多数事务型数据库所支持的<strong>高吞吐量</strong>和复杂的更新操作。目录进行更新操作，可以说是要么全部，要么都不的原子操作。目录服务适合的业务应用在于提供大量的<strong>查询和搜索</strong>操作，而不是大量的写入操作。Ldap可以说是活动目录在linux系统上的一个开源实现。</p><p>为了保证目录数据的可用性和可靠性，在确保使用目录服务提供快速查询和搜索操作的同时，目录服务还提供了==主从服务器同步目录数据信息的能力==，这相当于传统的MySQL数据库的主从同步功能一样，可以最大限度的确保基于目录业务的服务持续可用性与提供并发查询能力，微软公司的活动目录（active directory）就有主域和备份域的说法。</p><p>广义的目录服务概念，可以用多种不同的方式来提供目录服务。不同的目录所允许存储的信息是不同的，在信息如何被引用、查询、更新以及防止未经授权的访问等问题上，不同的目录服务的处理方式也有诸多的不同。</p><p>例如：一些目录服务是本地的，只提供受限的服务（比如，单机上的finger服务）。另一些服务是大范围的（global），提供广阔得多的服务（比如面向整个因特网），大范围的服务通常是分布式的，这也就意味着数据是分布在多台机器上的，这些机器一起来提供目录服务，典型的大范围服务定义一个统一的名称空间（namespace）来给出一个相同的数据视图（data view），而不管你相对于数据所在的位置。DNS是一个典型的大范围分布式目录服务的例子。</p><ul><li><a href=http://www.openldap.org/faq/data/cache/595.html target=_blank rel="noopener nofollow noreferrer">http://www.openldap.org/faq/data/cache/595.html</a></li></ul><h2 id=什么是ldap>什么是ldap？<a hidden class=anchor aria-hidden=true href=#什么是ldap>#</a></h2><p>目录服务有两个国际标准，分别是<code>X.500</code>和<code>LDAP</code>。X.500是ITU定义的目录标准，而LDAP是基于TCP/IP的目录访问协议，是Intemet上目录服务的通用访问协议。</p><p>LDAP是 <code>Lightweight Directory Access Protocol</code>（轻量级目录访问协议）的缩写。正如它的名字所表明的那样，它是一个轻量级的目录访问协议，特指基于X.500的目录访问协议的简化版本。LDAP运行在 <code>TCP/IP</code> 或者其他的面向连接的传输服务之上。LDAP完整的技术规范由RFC2251“The Lightweight Directory Access Protocol（v3）”和其他几个在RFC3377中定义的文档组成。</p><ul><li>LDAP是轻量目录访问协议（Lielhtweiglht Directory Access Protocol）的缩写。</li><li>LDAP标准实际上是在X.500标准基础上产生的一个简化版本。</li></ul><h2 id=什么是x500>什么是X.500？<a hidden class=anchor aria-hidden=true href=#什么是x500>#</a></h2><p>X.500由ITU-T和ISO定义，它实际上不是一个协议，而是由一个==协议族==组成，包括了从X.501到X.525等一系列非常完整的目录服务协议。</p><p>从技术上来说，LDAP是一个到X.500目录服务的目录访问协议，X.500是一个OSI目录服务。最初，LDAP客户端通过网关访问X.500目录服务。网关在客户端和网关之间运行LDAP，而X.500目录访问协议（Directory Access Protocol，DAP），位于这个网关和X.500服务器之间。</p><p><div class=pe-fancybox><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/8778><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/8778#center alt=image onerror='this.onerror=null,this.src="/placeholder.svg",this.className="pe-image-placeholder"'></a></div></p><p>LDAP是一个重量级的协议，在整个OSI协议栈上进行操作，而且需要占用大量的计算资源。而LDAP被设计为在TCP/IP层上操作，以小得多的代价实现了大多数LDAP的功能。</p><p>虽然LDAP仍旧可以通过网关访问X.500目录服务器，但是现在通常都是在X.500服务器上直接实现LDAP。</p><p>单独的LDAP守护程序openldap slapd，可以被看做是一个轻量级的X.500目录服务器。也就是说，它没有实现X.500完整的DAP协议。作为一个轻量级的目录服务器，slapd实现的仅仅是X.500模型的一个子集。</p><p>LDAP中的常用名词缩写及含义。</p><p>LDAP基本概念中的常用名词缩写及含义</p><table><thead><tr><th>关 键字</th><th>  英文全称</th><th>含 义</th></tr></thead><tbody><tr><td>dc</td><td>Domain Component</td><td>城名的部分，其格式是将完整的城名分成几部分，如域名为exaple.com变成<code>dc=exaple,dc=com</code></td></tr><tr><td>uid</td><td>User Id</td><td>用户ID，如 “oldboy”。</td></tr><tr><td>ou</td><td>Organization Unit</td><td>组织单位，类似于Limux文件系统中的子目录，它是一个容器对象，组织单位可以包含其他各种对象（包括其他组织单元），如“tech，rongjunfeng，bingge”</td></tr><tr><td>cn</td><td>Common Name</td><td>公共名称，如 “Thowas Johansson”</td></tr><tr><td>sn</td><td>Surnase</td><td>姓，如 “Johansson”</td></tr><tr><td>dn</td><td>Distinguished Name</td><td>唯一辨别名，类似于Linux文件系统中的绝对路径，每个对象都有一个唯一的名称，如<code>uid=tos,ou=market,dc=example,dc=com</code>，在一个目录树中 总是唯一的。</td></tr><tr><td>rdn</td><td>Relative dn</td><td>相对辨别名，类似于文件系统中的相对路径，它是与目录树结构无关的部分，如<code>uid=tom</code>或<code>cn=Thoeas Johansscn</code>。</td></tr><tr><td>c</td><td>Country</td><td>国家，如“CN”或“US”等</td></tr><tr><td>o</td><td>organizatione</td><td>组织名，如“Example，Inc.”。</td></tr></tbody></table><h2 id=ldap目录服务的特点>LDAP目录服务的特点<a hidden class=anchor aria-hidden=true href=#ldap目录服务的特点>#</a></h2><p>LDAP（openldap）目录服务具有下列特点：</p><ul><li>LDAP是一个跨平台的、标准的协议，近几年来得到了业界广泛的认可。</li><li>LDAP的结构用树型结构来表示，而不是用表格。因此不用SQL语句维护了。</li><li>LDAP提供了静态数据的快速查询方式，但在更新数据方面并不擅长。</li><li>LDAP服务可以使用基于“推”或“拉”的复制信息技术，用简单的或基于安全证书的安全认证，复制部分或全部数据，既保证了数据的安全性，又提高了数据的访问效率：</li><li>LDAP是一个安全的协议，LDAPv3支持SASL（Simple Authentication and Security Layer）、SSL（Secure Socket Layer）和TLS（Transport Layer Security），使用认证来确保事务的安全，另外，LDAP提供了不同层次的访问控制，以限制不同用户的访问权限。</li><li>LDAP支持异类数据存储，LDAP存储的数据可以是文本资料、二进制图片等。</li><li>Client/Server 模型：Server端用于存储树，Client端提供操作目录信息树的工具，通过这些工具，可以将数据库的内容以文本格式（LDAP数据交换格式，LDIF）呈现在我们的面前。</li><li>LDAP是一种开放Internet 标准，LDAP协议是跨平台的的Interent协议，它是基于X.500标准的，与X.500不同，LDAP支持TCP/IP（即可以分布式部署）。</li></ul><h2 id=ldap的目录结构>LDAP的目录结构<a hidden class=anchor aria-hidden=true href=#ldap的目录结构>#</a></h2><p>LDAP目录服务是通过目录数据库来存储网络信息来提供目录服务的。为了方便用户迅速查找和定位信息，目录数据库是以目录信息树（Directory Infornation Tree，缩写为DIT）为存储方式的树型存储结构，目录信息树及其相关概念构成了LDAP协议的信息模型。</p><ul><li>在LDAP中，目录是按照树型结构组织一一目录信息树（Directory Information Tree简写DIT），DIT是一个主要进行读操作的数据库。</li><li>DIT由条目（Entry）组成，条目相当于关系数据库中的表的记录：</li></ul><p>条目是具有分辨名DN（Distinguished Name）的属性-值对（Attribute-value，简称AV）
的集合。</p><p>在UNIX文件系统中，最项层是根目录（root），LDAP目录通常也用ROOT做根，通常称为<code>BaseDN</code>。</p><p>因为历史（X.500）的原因，LDAP目录用OU（Organization Unit）从逻辑上把数据分开来。Ou也是一种条目&ndash;==容器条目==。Ou下面即是真正的用户条目。</p><blockquote><p><strong>什么是dn?</strong></p></blockquote><p>DN，Distinguished Name，即分辨名。</p><p>在LDAP中，一个条目的分辨名叫做“DN”，DN是该条目在整个树中的唯一名称标识，DN相当于关系数据席表中的关键字（Primary Key）；它是一个识别属性，通常用于检索。</p><blockquote><p><strong>DN的两种设置</strong></p></blockquote><p>基于cn（姓名），<code>cn=test,ou=auth,dc=cylon,dc=org</code>，最常见的cn是从 <code>/etc/group</code> 转来的条目。.</p><p>基于uid（User ID），<code>uid=test,ou=auth,dc=cylon,dc=org</code> 最常见的uid是 <code>/etc/passwd</code> 转来的条目。</p><blockquote><p><strong>Base DN</strong></p></blockquote><p>LDAP目录树的最顶部就是根，也就是Base DN.</p><blockquote><p><strong>LDIF格式</strong></p></blockquote><p>LDIF格式是用于LDAP数据导入、导出的格式。LDIF是LDAP数据库信息的一种文本格式。BDB。</p><blockquote><p><strong>什么样的信息可以存储在目录当中？</strong></p></blockquote><p>LDAP的信息模型是基于条目的（entry）。一个条目就是一些具有全局唯一的标识名（Distinguished Name，简写做==DN==）的属性的集合。DN用于无二义性的指代一个唯一的条目，条目的每一个属性都有一个类型（type），一个或者多个值（value），类型（type）往往是特定字符串的简写，比如用 <code>cn</code> 指代 <code>commpn name</code>，或者 <code>mail</code> 指代电子邮件地址。值（value）的语法依赖于类型（type），比如，类型为cn的属性可能包含值Babs Jensen。
类型为mail的属性可能包含值 <code>babs@example.com</code> 。类型为jpegPhoto的属性可能包含二进制格式的JPEG图象。</p><p>下面是LDAP中条目信息的例子；就相当于数据库表中的两行记录：</p><p>LDAP允许你通过使用一种叫做 <code>objectClass</code>的特殊属性来控制哪些属性是条目所必须的，哪些属性是条目可选的，<code>objectClass</code> 属性的值是由条目所必须遵从的方案（schema）
来建义的。</p><p>通过下面命令可以取出上面的内容。</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>sh</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>ldapsearch -LLL -w oldboy -x -H ldap://10.0.0.20 -D <span class=s2>&#34;cn=admin,dc=cylon,dc=org&#34;</span> -b <span class=s2>&#34;dc=cylon,dc=org&#34;</span> <span class=nv>uid</span><span class=o>=</span><span class=s2>&#34;*&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div><p>信息在目录中是如何组织的？</p><p>在LDAP中，条目是按树状的层次结构组织的，传统上，这个结构往往是地理界限或者组织界限的反映。代表国家的条目位于整个目录树的顶层。之下的条目则代表各个州以及国家性的组织，再下面的条目则代表着组织单位、个人打印机、文件，或者你所能想到的其他东西，图1.1显示了按照传统命名方式组织的LDAP目录信息树。</p><p><div class=pe-fancybox><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/intro_tree.png><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/intro_tree.png#center alt=image onerror='this.onerror=null,this.src="/placeholder.svg",this.className="pe-image-placeholder"'></a></div></p><center>图1.1：LDAP目录树（传统命名方式）</center><p>目录树也可以按照因特网域名结构组织。因为它允许按照DNS对目录服务进行定位，这种命名方式正变得越来越受欢迎。图1.2显示了按照域名进行组织的一个LDAP目录树的例子。</p><p><div class=pe-fancybox><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/intro_dctree.png><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/intro_dctree.png#center alt=image onerror='this.onerror=null,this.src="/placeholder.svg",this.className="pe-image-placeholder"'></a></div></p><ul><li><a href=http://www.openldap.org/doc/admin24/intro.html target=_blank rel="noopener nofollow noreferrer">http://www.openldap.org/doc/admin24/intro.html</a></li></ul><p>root -> 顶级域 -> 二级 -> ou -> uid</p><p><div class=pe-fancybox><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567525992883.png><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567525992883.png#center alt=image onerror='this.onerror=null,this.src="/placeholder.svg",this.className="pe-image-placeholder"'></a></div></p><center>图1-2：LDAP目录树（域名命名方式）</center><p>例：<code>dn:cn=testlb,ou=People,ou=accounts,dc=cylon,dc=org</code></p><p>另外，LDAP允许你通过使用一种叫做objectClass的特殊属性来控制哪些属性是条目所必须的，哪些属性是条目可选的。objectClass属性的值是由条目所必须遵从的方案
（schema）来定义的。.</p><p>（3）信息是如何械引用的？</p><p>一个条目是通过它的标识名来引用的。而标识名是由相对标识名（Relative Distinguished Name或者RDN）和它的父条目名连在一起构成的。比如，在因特网命名的例子中，Barbara Jensen条目有相对标识名 <code>uid=babs</code> 和标识名为：<code>uid=babs,ou=People,de=example,dc=com</code> 。</p><h3 id=ldif数据文件介绍>LDIF数据文件介绍<a hidden class=anchor aria-hidden=true href=#ldif数据文件介绍>#</a></h3><p>目录数据文件内容讲解</p><p>LDIF（LDAP Data Interchangep-omat）轻量级目录交换格式）一种ASCII文件格式，用来交换数据并使得在LDAP服务器间交换数据成为可能。</p><p>LDIF文件最常用的功能就是向目录导入或修改信息，这些信息的格式需要按照LDAP中架构（schema）格式组织，如果不符合其要求的格式就会出现错误。</p><p>LDIF文件的特点：</p><ul><li>通过空行来分割一个条目或定义。</li><li>以<code>#</code>开始的行为注释。</li><li>所有属性的赋值方法为：<code>"属性: 属性值"</code> 例如，dn:<code>dn=cylon,dc=org</code></li><li>属性可以被重复赋值。例如objectclass就可以有多个，每个属性独立一行。</li><li>每行的结尾不允许有空格。</li></ul><p>在LDAP的每条记录中必须包含一个objectclass属性，且其需要赋子至少一个值。objectclass属性有等级之分，属性相当于变量，它可以被自定义赋值，值不能相同。</p><p>目录数据展现的树形结构圆。以上ldif数据文件表现个内容为如下树形结构：ldap C/S工具呈现的。</p><h2 id=ldap是想样工作的>LDAP是想样工作的？<a hidden class=anchor aria-hidden=true href=#ldap是想样工作的>#</a></h2><p>LDAP目录服务是基于 C/S模式的。一个或者多个LDAP服务器包含着组成整个目录信息树（DIT）的数据，客户端连接到服务器并且发出一个请求（request），然后服务器要么以一个回答（answer）子以回应，要么给出一个指针，客户可以通过此指针获取到所需的数据（通常，该指针是指向另一个LDAP服务器），无论客户端连到哪个LDAP服务器，它看到的都是同一个目录视图（view）.这是LDAP这类全局目录服务的一个重要特征。</p><h2 id=ldap的几个重要配置模式>LDAP的几个重要配置模式<a hidden class=anchor aria-hidden=true href=#ldap的几个重要配置模式>#</a></h2><p>LDAP服务的几个重要功能：</p><ul><li>★★★基本的目录查询服务。</li><li>目录查询代理服务。</li><li>异机复制数据（即主从同步）。</li></ul><h3 id=本地基本的目录查询服务>本地基本的目录查询服务<a hidden class=anchor aria-hidden=true href=#本地基本的目录查询服务>#</a></h3><p>在这种配置模式下，你的slapd只为你的本地域提供目录服务。它不会以任何方式与别的目录服务器交互。这种配置模式如图1所示。</p><p><div class=pe-fancybox><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567525992658.png><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567525992658.png#center alt=image onerror='this.onerror=null,this.src="/placeholder.svg",this.className="pe-image-placeholder"'></a></div></p><center>本地配置模式</center><h3 id=带有指针referrals的本地目录服务>带有指针（Referrals）的本地目录服务。<a hidden class=anchor aria-hidden=true href=#带有指针referrals的本地目录服务>#</a></h3><p>即目录查询代理服务，类似DNS的转发服务器。</p><p>在这种配置模式下，你为你的本地域运行一个LDAP服务器，并且将它配置成为当客户的请求超出你的本地域的处理能力的时候能够返回一个指针，该指针指向一个具备处理客户请求能力的更高级的服务器的地址。你可以自己运行这一服务，也可以使用别人已提供给你的一个。这种配置模式如图2所示。：</p><p><div class=pe-fancybox><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567525992983.png><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567525992983.png#center alt=image onerror='this.onerror=null,this.src="/placeholder.svg",this.className="pe-image-placeholder"'></a></div></p><p>如果你想运行本地目录服务并且参与全属的目录，那么运行这种模式。例如：openldap作为微软活动目录的代理查询服务。</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>text</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>referral &lt;URI&gt;</span></span></code></pre></td></tr></table></div></div></div></div><p>该指令指定了一个指针，当服务器的slapd找不到一个本地的数据库来处理一个请求的时候，它把该指针回传给客户。</p><p>示例：</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>text</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>referral ldap://root.openldap.org</span></span></code></pre></td></tr></table></div></div></div></div><p>这将把非本地的请求“推”到OpenLDAP的根服务器上。“聪明的” LDAP客户会向反馈回来的指针所指的服务器重新发出请求。但是得注意大多数客户仅仅知道怎么样处理简单的LDAP的URL，其中包含主机部分和可选的DN部分。</p><h3 id=同多复制的目录服务>同多复制的目录服务。<a hidden class=anchor aria-hidden=true href=#同多复制的目录服务>#</a></h3><p>slarpd守护程序是用来将主slapd上的改变传播到一个或多个从属的slapd上。一个master-slave 类型的配置示例如图3所示。</p><p><div class=pe-fancybox><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/9100><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/9100#center alt=image onerror='this.onerror=null,this.src="/placeholder.svg",this.className="pe-image-placeholder"'></a></div></p><p>这种配置模式可以和前面的两种配置模式之一合起来使用，在前面的两种情况中，单独的slapd不能提供足够的可用性和可靠性。</p><h3 id=简单易用的同步复制目录方案>简单易用的同步复制目录方案。<a hidden class=anchor aria-hidden=true href=#简单易用的同步复制目录方案>#</a></h3><p>利用inotify+ldap客户端命令方案，或者通过定时任务加上ldap客户端命令方案！举MYSQL同步的例子说明！</p><p><div class=pe-fancybox><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567525992939.png><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567525992939.png#center alt=image onerror='this.onerror=null,this.src="/placeholder.svg",this.className="pe-image-placeholder"'></a></div></p><h3 id=分布式的目录服务>分布式的目录服务。<a hidden class=anchor aria-hidden=true href=#分布式的目录服务>#</a></h3><p>在这种配置模式下，本地的服务被分制成为多个更小的服务，每一个都可能被复制，并且通过上级（superior）或者下级（subordinate）指针（referral）粘合起来。在实际工作中，使用主从同步集群比较多一些，跨机房就是通过openvpn同步。</p><p>ldap企业架构逻辑图案例：ldap+haproxy/nginx/hearbeat集群高可用，验证的时候不跨机房。</p><p><div class=pe-fancybox><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567525993061.png><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567525993061.png#center alt=image onerror='this.onerror=null,this.src="/placeholder.svg",this.className="pe-image-placeholder"'></a></div></p><h2 id=ldap服务的应用领域>LDAP服务的应用领域<a hidden class=anchor aria-hidden=true href=#ldap服务的应用领域>#</a></h2><p>LDAP目录服务，适合那些需要从不同的地点读取信息，但是不需要经常更新的业务信息最为有用。</p><p>LDAP的应用主要涉及以下几种类型。I</p><ul><li>信息安全类：数字证书管理、授权管理、单点登录。</li><li>科学计算类：DCE（Distributed Computing Environment，分布式计算环境）、UDDI（Universal Description，Discovery and Integration，统一描述、发现和集成协议）。</li><li>网络资源管理类：MAIL系统、DNS系统、网络用户管理、电话号码簿。</li><li>电子政务资源管理类：内网组织信息服务、电子政务目录体系、人口基础库、法人基础库。</li></ul><p>在工作中，常用ldap作为<strong>公司入职后的所有员工账号等的基础信息库</strong>，例如：邮件账号，电脑登陆账号、办公平台账号、共享服务账号、SVN账号、VPN账号、服务器的账号，无线网登陆账号等的公共账号登陆信息库。可以理解为企业的活动目录一样，另外，LDAP也可以和微软活动目录打通。</p><p>画一个内网AD域，和机房的LDAP服务打通的架构图！</p><h2 id=ldap服务的常见开源产品>LDAP服务的常见开源产品<a hidden class=anchor aria-hidden=true href=#ldap服务的常见开源产品>#</a></h2><p>Openldap是LDAP最好的开源实现，在其Openldap许可证下发行，并且已经被包含在众多流行的linux发行版中</p><p>官方网站为 <a href=http://www.openldap.org target=_blank rel="noopener nofollow noreferrer">openldap.org</a></p><p>官方man手册 <a href=http://www.openldap.org/software/man.cgi target=_blank rel="noopener nofollow noreferrer">http://www.openldap.org/software/man.cgi</a></p><h2 id=openldap-ui>openldap UI<a hidden class=anchor aria-hidden=true href=#openldap-ui>#</a></h2><p>ldap的客户端管理接口有很多，有b/s结构的web的，也有c/s结构的，我们以b/s结构的 <code>ldap-account-manager-3.7.tar.gz</code> 软件为例进行讲解</p><ul><li>B/S 架构的 <a href=https://www.ldap-account-manager.org/lamcms/ target=_blank rel="noopener nofollow noreferrer">LDAP Account Manager</a></li><li>C/S 架构的 <a href=http://www.ldapadmin.org/index.html target=_blank rel="noopener nofollow noreferrer">LDAP Admin</a></li></ul><h3 id=ldap-account-manager>LDAP Account Manager<a hidden class=anchor aria-hidden=true href=#ldap-account-manager>#</a></h3><p>LAM是php服务需要安装lamp环境</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>bash</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>yum install -y<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	nginx <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	php <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	php-ldap <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	php-gd <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	php-fpm
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>rpm -qa <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	nginx <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	php <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	php-ldap <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	php-gd <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	php-fpm</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=下载解压配置ldap客户端软件>下载解压配置ldap客户端软件<a hidden class=anchor aria-hidden=true href=#下载解压配置ldap客户端软件>#</a></h3><p>下载地址：https://www.ldap-account-manager.org/lamcms/releases</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>text</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>cp config.cfg_sample config.cfg
</span></span><span class=line><span class=cl>cp lam.conf_sample lam.conf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sed -i &#39;s@cn=Manager@cn=admin@g&#39; lam.conf
</span></span><span class=line><span class=cl>sed -i &#39;s@dc=my-domain@dc=cylon@g&#39; lam.conf
</span></span><span class=line><span class=cl>sed -i &#39;s@dc=com@dc=org@g&#39; lam.conf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>diff lam.conf_sample lam.conf</span></span></code></pre></td></tr></table></div></div></div></div><hr><blockquote><p><strong>提示</strong>： 此处改的地方很多</p></blockquote><hr><h3 id=配置nginx>配置nginx<a hidden class=anchor aria-hidden=true href=#配置nginx>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>text</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>chown nginx.nginx /var/www/html/ldap -R </span></span></code></pre></td></tr></table></div></div></div></div><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>text</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>worker_processes  1;
</span></span><span class=line><span class=cl>events {
</span></span><span class=line><span class=cl>    worker_connections  1024;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>http {
</span></span><span class=line><span class=cl>    include       mime.types;
</span></span><span class=line><span class=cl>    default_type  application/octet-stream;
</span></span><span class=line><span class=cl>    sendfile        on;
</span></span><span class=line><span class=cl>    keepalive_timeout  65;
</span></span><span class=line><span class=cl>    server {
</span></span><span class=line><span class=cl>        listen       80;
</span></span><span class=line><span class=cl>        server_name  localhost;
</span></span><span class=line><span class=cl>        location / {
</span></span><span class=line><span class=cl>            root   /var/www/html;
</span></span><span class=line><span class=cl>            index  index.html index.htm;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>        error_page   500 502 503 504  /50x.html;
</span></span><span class=line><span class=cl>        location = /50x.html {
</span></span><span class=line><span class=cl>            root   html;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>		location ~ \.php$ {
</span></span><span class=line><span class=cl>            fastcgi_pass   127.0.0.1:9000;
</span></span><span class=line><span class=cl>            fastcgi_index  index.php;
</span></span><span class=line><span class=cl>            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
</span></span><span class=line><span class=cl>            include        fastcgi_params;
</span></span><span class=line><span class=cl>		}
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=lam使用>LAM使用<a hidden class=anchor aria-hidden=true href=#lam使用>#</a></h3><p><strong>步骤1</strong>：打开浏览器或者在前面的访问基础上刷新：http:/10.0.0.20/ldap，正常会出现界面如下图所示：</p><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567527251834.png alt=image style=zoom:80%><p><strong>步骤2</strong>：点击右上角的“LAMconfiguration”链接进行配置。</p><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/image-20221023180610798.png alt=image-20221023180610798 style=zoom:67%><p><strong>步骤3</strong>：点击上图中的 “Edit general settings” 链接进行配置</p><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567527251647.png alt=image style=zoom:67%>
<img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567527251610.png alt=image><p>由于系统的密码为字母 “lam”，太简单了，我们先把密码改掉，其他的配置，我们根据需求以后可以再改，注意：这里是系统设置的权限密码，非页面上登录的密码。</p><p><strong>步骤5</strong>：上文点OK后就会到重新登录的界面进行登录，如下图：</p><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567527251845.png alt=image style=zoom:80%><hr><blockquote><p><strong>提示</strong>：</p><p>请牢记，这是 ==ldap管理员用户admin及密码==，非前面设置的系统内部配置密码，ldap 管理员用户admin及密码是在配置openldap中生成的</p></blockquote><hr><p><strong>步骤6</strong>：初始化ldap数据库的域。</p><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567527251713.png alt=image style=zoom:80%><p><strong>步骤7</strong>：命令查看下刚才的操作帮我们建立了什么？。</p><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>text</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ ldapsearch -LLL -w 123 -x -H ldap://10.0.0.20 -D &#34;cn=admin,dc=cylon,dc=org&#34; -b &#34;dc=cylon,dc=org&#34; &#34;(uid=chau)&#34; 
</span></span><span class=line><span class=cl>dn: uid=chau,ou=People,dc=cylon,dc=org
</span></span><span class=line><span class=cl>objectClass: posixAccount
</span></span><span class=line><span class=cl>objectClass: inetOrgPerson
</span></span><span class=line><span class=cl>objectClass: organizationalPerson
</span></span><span class=line><span class=cl>objectClass: person
</span></span><span class=line><span class=cl>homeDirectory: /home/chau
</span></span><span class=line><span class=cl>loginShell: /bin/bash
</span></span><span class=line><span class=cl>cn: cylon chau
</span></span><span class=line><span class=cl>uidNumber: 10006
</span></span><span class=line><span class=cl>gidNumber: 10000
</span></span><span class=line><span class=cl>userPassword:: e1NTSEF9c0YzZzBSbnFBU1NoWEVBWEFSS1lPdG41WjZRR1pxNCs=
</span></span><span class=line><span class=cl>sn: chau
</span></span><span class=line><span class=cl>givenName: cylon
</span></span><span class=line><span class=cl>uid: chau</span></span></code></pre></td></tr></table></div></div></div></div><p><strong>步骤8</strong>：继续添加ldap账号和组。</p><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567527251790.png alt=image style=zoom:80%><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>text</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>dn: cn=tech,ou=group,dc=cylon,dc=org
</span></span><span class=line><span class=cl>objectClass: posixGroup
</span></span><span class=line><span class=cl>description:: 5oqA5pyv6Y0o
</span></span><span class=line><span class=cl>gidNumber: 10001
</span></span><span class=line><span class=cl>cn: tech</span></span></code></pre></td></tr></table></div></div></div></div><p>添加用户</p><img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567527251960.png alt=image style=zoom:80%>
<img src=https://cdn.jsdelivr.net/gh/cylonchau/blogs@img/img/clipboard-1567527252022.png alt=image style=zoom:80%><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>text</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ ldapsearch -LLL -w 123 -x -H ldap://10.0.0.20 -D &#34;cn=admin,dc=cylon,dc=org&#34; -b &#34;dc=cylon,dc=org&#34; &#34;(uid=cylon)&#34;
</span></span><span class=line><span class=cl>dn: uid=cylon,ou=People,dc=cylon,dc=org
</span></span><span class=line><span class=cl>objectClass: posixAccount
</span></span><span class=line><span class=cl>objectClass: inetOrgPerson
</span></span><span class=line><span class=cl>objectClass: organizationalPerson
</span></span><span class=line><span class=cl>objectClass: person
</span></span><span class=line><span class=cl>homeDirectory: /home/chau
</span></span><span class=line><span class=cl>loginShell: /bin/bash
</span></span><span class=line><span class=cl>cn: cylon chau
</span></span><span class=line><span class=cl>uidNumber: 10006
</span></span><span class=line><span class=cl>userPassword:: e1NTSEF9c0YzZzBSbnFBU1NoWEVBWEFSS1lPdG41WjZRR1pxNCs=
</span></span><span class=line><span class=cl>sn: chau
</span></span><span class=line><span class=cl>givenName: cylon
</span></span><span class=line><span class=cl>uid: cylon
</span></span><span class=line><span class=cl>gidNumber: 10001</span></span></code></pre></td></tr></table></div></div></div></div><p>通过web接口管理ldap的配置完成！也已经初始化了用户组及用户</p><h3 id=phpldapadmin>phpldapadmin<a hidden class=anchor aria-hidden=true href=#phpldapadmin>#</a></h3><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>sh</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>yum install -y <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    php <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    php-fpm <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    php-ldap <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    php-gd <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    php-mbstring <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    php-pear <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    php-bcmath <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    php-xml <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    phpldapadmin <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    nginx</span></span></code></pre></td></tr></table></div></div></div></div><div class="pe-code-block-wrap pe-code-details open scrollable"><div class="pe-code-block-header pe-code-details-summary"><div class=pe-code-block-header-left><i class="arrow fas fa-chevron-right fa-fw pe-code-details-icon" aria-hidden=true></i>
<span>nginx</span></div><div class=pe-code-block-header-center><span></span></div><div class=pe-code-block-header-right><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i>
<button class=pe-code-copy-button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" class="pe-icon"><path fill="currentcolor" fill-rule="evenodd" d="M7 5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-2v2a3 3 0 01-3 3H5a3 3 0 01-3-3v-9a3 3 0 013-3h2zm2 2h5a3 3 0 013 3v5h2a1 1 0 001-1V5a1 1 0 00-1-1h-9A1 1 0 009 5zM5 9a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1v-9a1 1 0 00-1-1z" clip-rule="evenodd"/></svg></button></div></div><div class="pe-code-details-content scrollable"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>worker_processes</span>  <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>events</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>worker_connections</span>  <span class=mi>1024</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>http</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>include</span>       <span class=s>mime.types</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>default_type</span>  <span class=s>application/octet-stream</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>sendfile</span>        <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>keepalive_timeout</span>  <span class=mi>65</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>listen</span>       <span class=mi>80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>server_name</span>  <span class=s>localhost</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>root</span>   <span class=s>/usr/share/phpldapadmin/htdocs</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>index</span>  <span class=s>index.html</span> <span class=s>index.htm</span> <span class=s>index.php</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=kn>error_page</span>   <span class=mi>500</span> <span class=mi>502</span> <span class=mi>503</span> <span class=mi>504</span>  <span class=s>/50x.html</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>location</span> <span class=p>=</span> <span class=s>/50x.html</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>root</span>   <span class=s>html</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kn>location</span> <span class=p>~</span> <span class=sr>\.php$</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>fastcgi_pass</span>   <span class=n>127.0.0.1</span><span class=p>:</span><span class=mi>9000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>fastcgi_index</span>  <span class=s>index.php</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>fastcgi_param</span>  <span class=s>SCRIPT_FILENAME</span>  <span class=nv>$document_root$fastcgi_script_name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>include</span>        <span class=s>fastcgi_params</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div></div><div class=pe-copyright><hr><blockquote><p>本文为原创内容，版权归作者所有。如需转载，请在文章中声明本文标题及链接。</p><p>文章标题：理解ldap - 什么是ldap</p><p>文章链接：<a href=https://www.oomkill.com/2019/08/ch1-understanding-ldap/ target=_blank>https://www.oomkill.com/2019/08/ch1-understanding-ldap/</a></p><p>许可协议：<a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></p></blockquote></div><div class=comments-separator></div><h3 class=relatedContentTitle>相关阅读</h3><ul class=relatedContent><li><a href=/2017/05/rsync/><span>同步工具rsync使用指南</span></a></li></ul><div class=comments-separator></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.oomkill.com/tags/ldap/>Ldap</a></li><li><a href=https://www.oomkill.com/tags/linux/>Linux</a></li></ul><nav class=paginav><a class=prev href=https://www.oomkill.com/2019/08/ch2-install/><span class=title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left" style="user-select:text"><line x1="19" y1="12" x2="5" y2="12" style="user-select:text"/><polyline points="12 19 5 12 12 5" style="user-select:text"/></polyline></svg>&nbsp;</span>
<span>理解ldap - OpenLDAP安装</span>
</a><a class=next href=https://www.oomkill.com/2019/07/03-2-rbd-management/><span class=title></span>
<span>Ceph RBD - 关于RBD的操作与管理&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select:text"><line x1="5" y1="12" x2="19" y2="12" style="user-select:text"/><polyline points="12 5 19 12 12 19" style="user-select:text"/></svg></span></a></nav></footer><div class=pe-comments-decoration><p class=pe-comments-title></p><p class=pe-comments-subtitle></p></div><div id=pe-comments></div><script src=/js/pe-go-comment.min.86a214102576ba5f9b7bdc29eed8d58dd56e34aef80b3c65c73ea9cc88443696.js integrity="sha256-hqIUECV2ul+be9wp7tjVjdVuNK74Czxlxz6pzIhENpY="></script><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const s={src:"https://giscus.app/client.js","data-repo":"cylonchau/cylonchau.github.io","data-repo-id":"R_kgDOIRlNSQ","data-category":"Announcements","data-category-id":"DIC_kwDOIRlNSc4CXy1U","data-mapping":"pathname","data-term":"posts/ch1 understanding ldap","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":getStoredTheme(),"data-lang":"zh-TW","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(s).forEach(([t,n])=>e.setAttribute(t,n)),document.querySelector("#pe-comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme);const n=document.querySelector("#theme-toggle-float");n&&n.addEventListener("click",setGiscusTheme)})</script></article></main><footer class=footer><span>&copy; 2024 <a href=https://www.oomkill.com/>Cylon's Collection</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> on
<a href=https://pages.github.com/ rel=noopener target=_blank>GitHub Pages</a> & Theme
        <a href=https://github.com/tofuwine/PaperMod-PE rel=noopener target=_blank>PaperMod-PE</a></span><div class=busuanzi-footer style="font-family:helvetica neue,Helvetica,Arial,sans-serif;text-align:center;padding:4px 0;color:#999"><span id=busuanzi_container_site_pv style=margin-right:8px;font-size:.85em>本站总访问量<span id=busuanzi_value_site_pv style=font-weight:500>0</span>次
</span><span id=busuanzi_container_site_uv style=font-size:.85em>本站访客数<span id=busuanzi_value_site_uv style=font-weight:500>0</span>人次</span></div></footer><div class=pe-right-sidebar><a href=javascript:void(0); id=theme-toggle-float class=pe-float-btn><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</a><a href=#top class=pe-float-btn id=top-link><span id=pe-read-progress></span></a></div><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>